/*!CK:2576718484!*//*1454393778,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["BADWy"]); }

__d("ChatSidebarSections",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MORE_ONLINE_FRIENDS:"more_online_friends",MORE_ONLINE_COWORKERS:"more_online_coworkers",OFFLINE_USERS:"offline_users",ORDERED_LIST:"ordered_list",ORDERED_COWORKERS:"ordered_coworkers",TYPEAHEAD:"typeahead",NOW_PINNED_LIST:"now_pinned_list"};},null);
__d('AsyncLoader',['AsyncRequest','BaseAsyncLoader'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l){this._endpoint=k;this._type=l;}Object.assign(j.prototype,i.prototype);j.prototype.send=function(k,l,m,n,o){new h(k).setData({ids:l}).setHandler(n).setErrorHandler(o).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};f.exports=j;},null);
__d("XGamesNavigationSliderAsyncController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/games\/async\/navigationslider\/",{id:{type:"String",required:true},referral_objects:{type:"StringVector",required:true},num_items_per_page:{type:"Int",required:true},width:{type:"Int",required:true},height:{type:"Int",required:true}});},null);
__d('CanvasNavigationSlider',['Event','XGamesNavigationSliderAsyncController','AsyncRequest','DataStore'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l='GamesNavigationSlider';m.init=function(n,o){'use strict';return new m(n,o);};function m(n,o){'use strict';this.$CanvasNavigationSlider1=o.autoscroll;this.$CanvasNavigationSlider2=n;this.$CanvasNavigationSlider3=o.referral_objects;this.$CanvasNavigationSlider4=n.getNode().id;this.$CanvasNavigationSlider5=o.height;this.$CanvasNavigationSlider6=o.width;this.$CanvasNavigationSlider7=o.num_items_per_page;this.$CanvasNavigationSlider8=false;k.set(l,this.$CanvasNavigationSlider4,this);if(n.getIndex()>0||this.$CanvasNavigationSlider1)this.$CanvasNavigationSlider9();var p=h.listen(n.getNextArrow(),'click',(function(){p.remove();this.$CanvasNavigationSlider9();}).bind(this).bind(this));}m.prototype.$CanvasNavigationSlider9=function(){'use strict';if(this.$CanvasNavigationSlider8)return;this.$CanvasNavigationSlider8=true;var n=i.getURIBuilder().setStringVector('referral_objects',this.$CanvasNavigationSlider3).setString('id',this.$CanvasNavigationSlider4).setInt('num_items_per_page',this.$CanvasNavigationSlider7).setInt('width',this.$CanvasNavigationSlider6).setInt('height',this.$CanvasNavigationSlider5).getURI();new j(n).send();};m.prototype.$CanvasNavigationSlider10=function(n){'use strict';n.forEach((function(o){this.$CanvasNavigationSlider2.push(o);}).bind(this));};m.update=function(n,o){'use strict';var p=k.get(l,n);p.$CanvasNavigationSlider10(o);};f.exports=m;},null);
__d('BuddyListNub',['Arbiter','AsyncRequest','AvailableList','BootloadedComponent.react','ChannelConnection','ChannelConstants','ChatOptions','ChatSidebarActions','ChatSidebarStore','ChatSidebarVisibility','ChatVisibility','CSS','Dock','DOM','Event','JSLogger','JSResource','KeyEventController','Keys','NubController','OrderedFriendsList','Parent','PresencePrivacy','PresenceStatus','PresenceUtil','React','ReactDOM','Run','SidebarType','Style','Toggler','csx','cx','emptyFunction','fbt','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa){if(c.__markCompiled)c.__markCompiled();var ra,sa,ta=40,ua=253,va=w.create('buddylist_nub');ra=babelHelpers.inherits(wa,aa);sa=ra&&ra.prototype;function wa(xa,ya,za,ab){'use strict';sa.constructor.call(this);sa.init.call(this,xa);this.root=xa;this.orderedList=ya;this.typeahead=za;this.button=u.find(xa,'a.fbNubButton');this.unreadCount=u.find(xa,"span._5ayx");this.label=u.find(xa,'span.label');this.body=u.scry(xa,'div.fbNubFlyoutBody')[0];this.container=ca.bySelector(xa,"._56ox");this.typeaheadContainer=u.find(xa,'.fbChatTypeaheadViewContainer');var bb=u.find(xa,'div.fbNubFlyoutTitlebar');la.createInstance(bb).setSticky(false);la.createInstance(xa).setSticky(true);if(ab)ia.onAfterLoad((function(){this.dropdown=ha.render(ga.createElement(k,{bootloadPlaceholder:ga.createElement('span',null),bootloadLoader:x('ChatSidebarDropdown.react'),onToggleSidebar:function(){},sidebarType:ja.BUDDYLIST}),ab);}).bind(this));ya.subscribeOnce('render',this.flyoutContentChanged.bind(this));ia.onAfterLoad((function(){var cb=u.find(bb,"div._4k48");if(cb)ha.render(ga.createElement(k,{bootloadPlaceholder:ga.createElement('span',null),bootloadLoader:x('ChatSidebarComposeLink.react'),className:"_3a-4"}),cb);var db=u.find(this.button,"div._1us9");if(db)ha.render(ga.createElement(k,{bootloadPlaceholder:ga.createElement('span',null),bootloadLoader:x('ChatSidebarComposeLink.react'),className:"_3a-4"}),db);var eb=u.find(this.button,"div._1usa");if(eb)ha.render(ga.createElement(k,{bootloadPlaceholder:ga.createElement('span',null),bootloadLoader:x('ChatSidebarDropdown.react'),onToggleSidebar:function(){},sidebarType:ja.BUDDYLIST_NUB}),eb);}).bind(this));ya.setScrollContainer(this.body);j.subscribe('buddylist/availability-changed',this._updateCount.bind(this));h.subscribe('chat/connect',this._handleConnect.bind(this));h.subscribe('chat/option-changed',(function(cb,db){if(db.name=='hide_groups'){this.onResize();}else if(db.name==='hide_buddylist')db.value?this.hide():this.show();}).bind(this));da.subscribe('privacy-user-presence-changed',this._handleVisibilityChange.bind(this));this.message=u.find(xa,"div._4mq1");this.warningMsgText=null;this.warningMsgEventListener=null;this.showWarningTimeout=null;l.subscribe(l.CONNECTED,this._handleChannelConnected.bind(this));l.subscribe(l.SHUTDOWN,this._handleChannelShutdown.bind(this));l.subscribe(l.RECONNECTING,this._handleChannelReconnecting.bind(this));l.subscribe([l.MUTE_WARNING,l.UNMUTE_WARNING],this._updateView.bind(this));this.subscribe('show',this.onShow.bind(this));this.subscribe('hide',this.onHide.bind(this));this.subscribe('resize',this.onResize.bind(this));v.listen(xa,'keydown',this._onKeyDown.bind(this));v.listen(this.button,'click',this.onButtonClick.bind(this));y.registerKey('q',(function(event){if(this._isOpen){za.getCore().getElement().focus();}else{this.onButtonClick();this.show();}event.prevent();}).bind(this));za.getCore().subscribe('escape',this.hide.bind(this));za.subscribe(['respond','reset'],(function(cb,db){if(this._isOpen){if(db&&db.value&&db.value===za.getCore().getValue()&&za.getView().isVisible()){t.setUseMaxHeight(this.root,false);this._hideBuddyList();}else this._showBuddyList();this.flyoutContentChanged();}}).bind(this));h.subscribe('sidebar/show',this.hide.bind(this));h.subscribe('minisidebar/show',this.hide.bind(this));h.subscribe('sidebar/hide',this._onSidebarHide.bind(this));this._orderedListCount=ba.getList().length;ka.set(this.body,'min-height','285px');za.getCore().subscribe('focus',function(){s.addClass(bb,"_3f5-");});za.getCore().subscribe('blur',(function(){s.removeClass(bb,"_3f5-");this._typeaheadActive=false;ka.set(this.body,'max-height','285px');}).bind(this));za.getCore().subscribe('sidebar/typeahead/active',(function(cb,db){if(db){this._typeaheadActive=true;ka.set(this.body,'max-height','none');}else{this._typeaheadActive=false;ka.set(this.body,'max-height','285px');}}).bind(this));ka.set(this.body,'max-height','285px');if(p.isEnabled()&&p.getVisibleType()===ja.BUDDYLIST&&!n.getSetting('hide_buddylist')&&!l.disconnected()&&!da.isUserOffline()&&this._orderedListCount>0)this.show();v.listen(bb,'click',(function(cb){if(s.hasClass(cb.target,"titlebarTextWrapper"))this._syncHideBuddylist(true);}).bind(this));this._handleVisibilityChange();va.log('buddylist_initialized');}wa.prototype._handleConnect=function(xa){'use strict';this._updateView(true);};wa.prototype._getShutdownReason=function(xa){'use strict';switch(xa){case m.HINT_AUTH:return pa._("\u0412\u0440\u0435\u043c\u044f \u0432\u0430\u0448\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438 \u0438\u0441\u0442\u0435\u043a\u043b\u043e. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u043d\u043e\u0432\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0445\u043e\u0434.");case m.HINT_CONN:return pa._("{Chat} Facebook \u0432 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d.",[pa.param('Chat',pa._("\u0427\u0430\u0442"))]);case m.HINT_MAINT:return pa._("{Chat} Facebook \u0432 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u043a\u0440\u044b\u0442 \u043d\u0430 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u043e\u0431\u0441\u043b\u0443\u0436\u0438\u0432\u0430\u043d\u0438\u0435.",[pa.param('Chat',pa._("\u0427\u0430\u0442"))]);default:return pa._("{Chat} Facebook \u0432 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d.",[pa.param('Chat',pa._("\u0427\u0430\u0442"))]);}};wa.prototype._getReconnectMsg=function(xa){'use strict';var ya;if(xa===null||false===navigator.onLine){ya=pa._("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0447\u0430\u0442\u0443. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0441\u0432\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0438\u043d\u0442\u0435\u0440\u043d\u0435\u0442\u0443.");}else if(xa>m.WARNING_COUNTDOWN_THRESHOLD_MSEC){var za=u.create('a',{href:'#',className:'fbChatReconnectLink'},pa._("\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c \u043f\u043e\u043f\u044b\u0442\u043a\u0443")),ab=u.create('div',null,za);ya=u.create('div',{},pa._("Unable to connect to chat."));u.appendContent(ya,ab);}else if(xa>1000){ya=pa._("Unable to connect to chat. Reconnecting in {seconds}...",[pa.param('seconds',Math.floor(xa/1000))]);}else ya=pa._("\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f \u043a \u0447\u0430\u0442\u0443. \u041f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435...");return ya;};wa.prototype._resetShowWarningTimeout=function(){'use strict';if(this.showWarningTimeout){clearTimeout(this.showWarningTimeout);this.showWarningTimeout=null;}};wa.prototype._handleChannelConnected=function(xa){'use strict';this._resetShowWarningTimeout();if(this.orderedList.isVisible())r.goOnline();this.warningMsgText=null;this._updateView();};wa.prototype._handleChannelShutdown=function(xa,ya){'use strict';this._resetShowWarningTimeout();this.warningMsgText=this._getShutdownReason(ya);this._updateView();};wa.prototype._handleChannelReconnecting=function(xa,ya){'use strict';this._resetShowWarningTimeout();this.warningMsgText=this._getReconnectMsg(ya);if(ya>1000){if(ya>m.WARNING_COUNTDOWN_THRESHOLD_MSEC){if(this.warningMsgEventListener){this.warningMsgEventListener.remove();this.warningMsgEventListener=null;}this.warningMsgEventListener=v.listen(this.message,'click',(function(event){if(s.hasClass(event.getTarget(),'fbChatReconnectLink')){this._tryReconnect();event.kill();}}).bind(this));}this.showWarningTimeout=qa(this._handleChannelReconnecting.bind(this,xa,ya-1000),1000);}this._updateView();};wa.prototype._tryReconnect=function(){'use strict';if(l.disconnected())l.reconnect();};wa.prototype._handleVisibilityChange=function(){'use strict';this._updateView();if(!r.isOnline())this.hide();};wa.prototype._updateView=function(xa){'use strict';var ya=this.container;if(ya){s.conditionClass(ya,'offline',!r.isOnline());s.conditionClass(ya,'error',l.disconnected());}if(l.disconnected())u.setContent(this.message,this.warningMsgText);var za,ab;if(!r.isOnline()){za=pa._("{Chat} (\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d)",[pa.param('Chat',pa._("\u0427\u0430\u0442"))]);}else if(l.disconnected()){za=pa._("{Chat} (\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d)",[pa.param('Chat',pa._("\u0427\u0430\u0442"))]);}else{var bb=ea.getOnlineCount();if(bb){var cb=u.create('span',{className:'count'},'('+bb+')');za=pa._({"*":"{Chat} {number-available}"},[pa.param('Chat',pa._("\u0427\u0430\u0442")),pa.param('number-available',cb,[0,bb])]);}else{za=pa._("\u0427\u0430\u0442");ab=true;}}this._setUnread();this._setLabel(za,ab);this.buttonContentChanged();};wa.prototype.onButtonClick=function(){'use strict';if(s.shown(this.typeahead.getElement())){var xa=this.subscribe('show',(function(){this.typeahead.getCore().getElement().focus();}).bind(this));setTimeout(this.unsubscribe.bind(this,xa),0);}if(!p.isInitialized())return true;var ya=p.isEnabled(),za=q.shouldShowSidebarIgnoreEnabled();if(!ya&&za){o.enable();}else o.show();return !za;};wa.prototype.onHide=function(){'use strict';this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null;}this._hideBuddyList();this.typeahead.getCore().reset();h.inform('buddylist/hide');};wa.prototype._onKeyDown=function(event){'use strict';var xa=v.getKeyCode(event);if(xa===z.ESC&&!s.hasClass(this.root,'menuOpened')){this.hide();return false;}else if(xa==z.RETURN)o.enable();};wa.prototype._onSidebarHide=function(event){'use strict';if(p.isEnabled()&&!n.getSetting('hide_buddylist')&&!l.disconnected()&&!da.isUserOffline()){this.show();}else{this.hide();this.button.focus();}};wa.prototype.onResize=function(){'use strict';var xa=!this._typeaheadActive?ua:t.getMaxFlyoutHeight(this.root)-60,ya=Math.max(250,xa),za=Math.floor(ya/ta);this.orderedList.setNumTopFriends(za);var ab=this.typeahead.getData(),bb=Math.max(za-2,1);if(ab.getMaxResults()!==bb)ab.setMaxResults(bb);};wa.prototype._showBuddyList=function(){'use strict';this._buddyListRenderSubscription=this.orderedList.subscribe('render',(function(){if(ka.get(this.body,'height')!='285px')ka.set(this.body,'height','285px');}).bind(this));s.hide(this.typeaheadContainer);this.orderedList.show();va.bump('buddylist_show');};wa.prototype._hideBuddyList=function(){'use strict';s.show(this.typeaheadContainer);this.orderedList.hide();va.bump('buddylist_hide');};wa.prototype.onShow=function(){'use strict';this._isOpen=true;if(l.disconnected()){this._tryReconnect();this._showBuddyList();}else r.goOnline(this._showBuddyList.bind(this));this._syncHideBuddylist(false);};wa.prototype._setLabel=function(xa,ya){'use strict';var za=this.label.textContent||this.label.innerText;if(za!==xa){var ab=this.label.cloneNode(true);u.setContent(ab,xa);u.replace(this.label,ab);this.label=ab;}this.throbber&&s.conditionShow(this.throbber,!!ya);};wa.prototype._setUnread=function(xa){'use strict';s.conditionShow(this.unreadCount,!!xa);};wa.prototype._updateCount=function(){'use strict';this._updateView();};wa.prototype._syncHideBuddylist=function(xa){'use strict';n.setSetting('hide_buddylist',xa,'buddylist');new i('/ajax/chat/settings.php').setHandler(oa).setErrorHandler(oa).setData({hide_buddylist:xa,window_id:fa.getSessionID()}).setAllowCrossPageTransition(true).send();};f.exports=wa;},null);
__d('ChatHovercard',['Arbiter','AsyncLoader','Bootloader','JSLogger','debounce'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=5,n=new i('/ajax/chat/hovercard/sidebar.php','hover'),o=k.create('chat_hovercard');h.subscribe('Hovercard/dirty',n.reset.bind(n));function p(t,u){n.get(t,function(v){setTimeout(function(){if(!v){o.error('fetch_failure',{id:t});return;}j.loadModules(["Hovercard"],function(w){var x=w.getDialog(v);if(!x){o.error('no_hovercard',{id:t,endpoint:v});return;}if(t==u.getActiveID())u.showHovercard(t,x);});},0);});}function q(t,u){var v=[];function w(z){if(z>=0&&z<t.length)v.push(t[z]);}var x=t.indexOf(u);if(x>-1){w(x);for(var y=1;y<m;y++){w(x+y);w(x-y);}}return v.filter(function(z){return z;});}function r(t,u){var v=u.getActiveID();if(v){var w=t.getShowingUsers(),x=q(w,v);n.get(x,function(){});}}function s(t){var u=t.getHoverController();u.registerDefault(p);u.subscribe('hover',l(r.bind(null,t,u),100));}f.exports=s;},null);
__d('ChatOrderedListHover',['ArbiterMixin','CSS','ErrorUtils','Event','LayerHideOnBlur','Parent','csx','cx','mixin','setTimeoutAcrossTransitions','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s,t;function u(x){i.addClass(x,'fetching');}function v(x){i.removeClass(x,'fetching');}s=babelHelpers.inherits(w,p(h));t=s&&s.prototype;function w(x){'use strict';t.constructor.call(this);this._orderedList=x;this._root=x.getRoot();k.listen(this._root,'mouseover',this._mouseOver.bind(this));k.listen(this._root,'mouseleave',this._mouseLeave.bind(this));x.subscribe('click',r(this._hide,this));}w.prototype._mouseOver=function(event){'use strict';if(this._paused)return;var x=event.getTarget(),y=m.bySelector(x,"._42fz")||m.bySelector(x,"._5a58");y&&this._setActiveItem(y);};w.prototype._mouseLeave=function(event){'use strict';this._setActiveItem(null);};w.prototype._clearTimeouts=function(){'use strict';this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};w.prototype._hide=function(){'use strict';if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};w.prototype._show=function(){'use strict';var x=this.getActiveID(),y=false;if(this._defaultHandler){y=true;j.applyWithGuard(this._defaultHandler,{},[x,this]);}if(y&&this._showingID!=this.getActiveID())u(this._activeItem);};w.prototype._setActiveItem=function(x){'use strict';if(x!=this._activeItem){this._clearTimeouts();this._activeItem&&v(this._activeItem);if(x){this._activeItem=x;var y=this._showingDialog?0:600;this._showTimeout=q((function(){return this._show();}).bind(this),y);this.inform('hover');}else{this._activeItem=null;this._hideTimeout=q((function(){return this._hide();}).bind(this),10);this.inform('leave');}}};w.prototype.registerDefault=function(x){'use strict';this._defaultHandler=x;};w.prototype.getActiveID=function(){'use strict';var x=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return x||null;};w.prototype.showHovercard=function(x,y){'use strict';if(x==this.getActiveID()&&x!=this._showingID){this._clearTimeouts();v(this._activeItem);this._hide();this._showingDialog=y;this._showingID=x;var z=y.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),aa=y.subscribe('mouseleave',(function(){z.unsubscribe();this._setActiveItem(null);}).bind(this)),ba=y.subscribe('hide',(function(){this.inform('hovercard_hide');z.unsubscribe();aa.unsubscribe();ba.unsubscribe();}).bind(this));y.enableBehavior(l).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};Object.assign(w.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});f.exports=w;},null);
__d("ChatSidebarConstants",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:32};Object.assign(h,{getImageSize:function(i){if(i===false)return h.IMAGE_SIZE;return h.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(){return h.IMAGE_SIZE+8;}});f.exports=h;},null);
__d('ChatSidebarItem.react',['AvailableListConstants','XUIBadge.react','ChatConfig','ChatSidebarConstants','Image.react','Link.react','ReactComponentWithPureRenderMixin','React','SplitImage.react','TextWithEmoticons.react','Timestamp.react','cx','ix','xuiglyph'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v=o.PropTypes,w=j.get('divebar_rounded_profile',false),x=9,y=o.createClass({displayName:'ChatSidebarItem',mixins:[n],propTypes:{image:v.string,images:v.array,isPlayingGame:v.bool,birthday:v.bool,context:v.string,href:v.string,imageSize:v.number,name:v.string,nameCanHaveEmoji:v.bool,onClick:v.func,status:v.number,statusTime:v.string,unreadCount:v.number,isMessengerOnlyContact:v.bool},render:function(){var z="_55ln"+(this.props.context?' '+"_55lo":'')+(this.props.unreadCount?' '+"_5bom":'')+(w?' '+"_qhr":''),aa="_55lr";return (o.createElement(m,{className:z,href:{url:this.props.href},onClick:this.props.onClick,rel:'ignore'},o.createElement('div',{className:"_55lp"},o.createElement('div',{className:"_56p9"},o.createElement(p,{size:this.props.imageSize||k.IMAGE_SIZE,srcs:this.props.image||this.props.images}),o.createElement('div',{className:"_568w"})),o.createElement('div',{className:"_5bon"},this.renderPlayingGame(),this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),o.createElement('div',{className:aa},this.renderName()),o.createElement('div',{className:"_55ls"},this.props.context))));},renderName:function(){if(this.props.nameCanHaveEmoji){return (o.createElement(q,{renderEmoticons:true,renderEmoji:true,text:this.props.name}));}else return this.props.name;},renderUnreadCount:function(){var z=this.props.unreadCount;if(!z)return null;return (o.createElement(i,{count:z,maxcount:x,type:'regular'}));},renderStatus:function(){var z=this.getStatusSrc();if(!z&&!this.props.statusTime)return null;var aa=z?o.createElement(l,{className:"_568_",src:z}):null,ba=true,ca=this.props.unreadCount||0;if(ca>0){aa=this.props.statusTime?null:aa;ba=false;}return (o.createElement('div',{className:"_568z"},ba?this.renderLastActiveTime():null,aa));},renderLastActiveTime:function(){return (o.createElement('div',{className:"_568-"},this.props.statusTime));},renderBirthday:function(){if(!this.props.birthday)return null;var z=t('/images/gifts/icons/cake_icon.png');return (o.createElement(l,{className:"_5dv3",src:z}));},renderPlayingGame:function(){if(this.props.statusTime||this.props.birthday||!this.props.isPlayingGame)return null;return (o.createElement('div',{className:"_46b2"},o.createElement(l,{className:"_46b3",src:u({name:'games',size:'small'})})));},getStatusSrc:function(){if(this.props.isMessengerOnlyContact)return t('/images/chat/sidebar/buddylist_nub/phone.png');switch(this.props.status){case h.ACTIVE:return t('/images/chat/sidebar/buddylist_nub/greenDot.png');case h.MOBILE:return t('/images/chat/sidebar/buddylist_nub/phone.png');}return null;}});f.exports=y;},null);
__d('ChatSidebarThread.react',['ChatSidebarItem.react','ChatOpenTab','MercuryParticipantListRenderer','WebMessengerPermalinkConstants','React','Tooltip.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=l.PropTypes,p=10,q=l.createClass({displayName:'ChatSidebarThread',propTypes:{image:o.string,imageSize:o.number,name:o.string,participants:o.array,numOtherParticipants:o.number,referrer:o.string,status:o.number,threadFBID:o.string,unreadCount:o.number},_renderParticipants:function(){var t=[],u=this.props.participants.length,v=this.props.numOtherParticipants,w=Math.min(p,u);if(v-w==1)w--;for(var x=0;x<w;x++){var y=this.props.participants[x];t.push(l.createElement('li',{key:y.id},y.name));}if(w<v)t.push(l.createElement('li',{key:'more-participants'},n._("and {num} more...",[n.param('num',v-w)])));return (l.createElement('ul',null,t));},render:function(){var t=this.props.name,u=r(this.props.threadFBID,this.props.participants,this.props.numOtherParticipants),v=t?u:undefined,w=k.getURIPathForThreadID(this.props.threadFBID),x=s(this.props.image,this.props.participants),y=t?t:u;return (l.createElement(m,{display:'block',position:'above',tooltip:this._renderParticipants()},l.createElement(h,{context:v,href:w,imageSize:this.props.imageSize,image:this.props.image,images:x,name:y,nameCanHaveEmoji:true,onClick:this._openTab,referrer:this.props.referrer,status:this.props.status,unreadCount:this.props.unreadCount})));},_openTab:function(t){t.preventDefault();i.openThread(this.props.threadFBID,this.props.referrer);}});function r(t,u,v){return new j().setIsNewThread(!t).setUseShortName(true).setTotalParticipantCount(v).renderParticipantList(u);}function s(t,u){if(t)return null;return u.map(function(v){return v.image_src;}).filter(function(v){return v;});}f.exports=q;},null);
__d('ChatSidebarGroupThreadsGroup.react',['ChatSidebarThread.react','ChatSidebarSections','ChatSidebarConstants','PresencePrivacy','PresenceStatus','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=m.PropTypes,p=m.createClass({displayName:'ChatSidebarGroupThreadsGroup',propTypes:{groups:o.array.isRequired,isDisconnected:o.bool},render:function(){return (m.createElement('ul',null,this.props.groups.map(this._renderGroup)));},_renderGroup:function(q){var r=q.mercury_thread.participants,s=this.props.isDisconnected||k.isUserOffline();return (m.createElement('li',{className:"_42fz"+(s?' '+"_570-":''),'data-id':q.uid,key:q.uid},m.createElement(h,{image:q.mercury_thread.image_src,imageSize:j.getImageSize(),name:q.mercury_thread.name,participants:q.participants_to_render,numOtherParticipants:r.length-1,referrer:i.ORDERED_LIST,status:l.getGroup(r),threadFBID:q.uid})));}});f.exports=p;},null);
__d('ChatSidebarHeader.react',['ReactComponentWithPureRenderMixin','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=i.createClass({displayName:'ReactChatSidebarHeader',mixins:[h],render:function(){return (i.createElement('div',babelHelpers._extends({},this.props,{className:k(this.props.className,"_55ob")}),i.createElement('div',{className:"_55oc"},this.props.children)));}});f.exports=l;},null);
__d('ChatSidebarUser.react',['ChatOpenTab','ChatSidebarItem.react','WebMessengerPermalinkConstants','ReactComponentWithPureRenderMixin','React'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=l.PropTypes,n=l.createClass({displayName:'ChatSidebarUser',mixins:[k],propTypes:{birthday:m.bool,image:m.string,imageSize:m.number,isPlayingGame:m.bool,name:m.string,sectionName:m.string.isRequired,slot:m.number,status:m.number,statusTime:m.string,unreadCount:m.number,userID:m.string.isRequired,isMessengerOnlyContact:m.bool},_openTab:function(event){h.openUserTab(this.props.userID,this.props.sectionName,{global_slot:this.props.slot});return event.preventDefault();},render:function(){var o=j.getURIPathForIDOrVanity(this.props.userID);return (l.createElement(i,{onClick:this._openTab,href:o,imageSize:this.props.imageSize,image:this.props.image,isPlayingGame:this.props.isPlayingGame,name:this.props.name,nameCanHaveEmoji:false,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,context:this.props.context,unreadCount:this.props.unreadCount,isMessengerOnlyContact:this.props.isMessengerOnlyContact}));}});f.exports=n;},null);
__d('ChatSidebarUserGroup.react',['AvailableList','AvailableListConstants','CanvasGKs','ChatSidebarSections','ChatSidebarUser.react','LastActiveTimes','PresencePrivacy','PresenceStatus','React','ShortProfiles','SubscriptionsHandler','WorkModeConfig','createCancelableFunction','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=p.PropTypes,w=Object.keys(k).map(function(y){return k[y];}),x=p.createClass({displayName:'ChatSidebarUserGroup',propTypes:{ids:v.array.isRequired,isDisconnected:v.bool,loadExtras:v.bool,sectionName:v.oneOf(w).isRequired},getInitialState:function(){return {userData:[]};},_onAvailabilityChanged:function(y,z){if(!z||this.props.ids.indexOf(z)!==-1)this.forceUpdate();},componentWillMount:function(){this._subscriptions=new r();this._updateProfiles=t((function(y,z){var aa=y.map(function(ba){return z[ba];});this.setState({userData:aa});}).bind(this));this._subscriptions.addSubscriptions(this._updateProfiles);this.componentWillReceiveProps(this.props);},componentDidMount:function(){this._subscriptions.addSubscriptions(h.subscribe(i.ON_AVAILABILITY_CHANGED,this._onAvailabilityChanged));},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(y){q.getMulti(y.ids,this._updateProfiles.bind(this,y.ids));this.setState({userData:y.ids.map(function(z){return q.getNow(z);}).filter(function(z){return z;})});},_renderProfile:function(y,z){var aa=s.is_work_user;if(y.id===0||!(y.is_friend||y.is_nonfriend_messenger_contact||aa))return null;var ba=o.get(y.id);if(ba!==i.ACTIVE)ba=null;var ca=null;if(j.pg_chatproxy_canvas_buddy_icon)ca=o.isPlayingCanvasGameUser(y.id);var da=ba!==i.ACTIVE?m.getShortDisplay(y.id):null,ea=this.props.isDisconnected||!n.allows(y.id);return (p.createElement('li',{className:"_42fz"+(ea?' '+"_570-":''),'data-id':y.id,key:y.id},p.createElement(l,{birthday:y.is_birthday,image:y.thumbSrc,imageSize:this.props.imageSize,isPlayingGame:ca,name:y.name,sectionName:this.props.sectionName,slot:z,status:ba,statusTime:da,userID:y.id,isMessengerOnlyContact:y.is_messenger_only})));},render:function(){return (p.createElement('ul',this.props,this.state.userData.map(this._renderProfile)));}});f.exports=x;},null);
__d('ChatSidebarOrderedList.react',['Animation','ChatConfig','Bootloader','ChatQuietLinks','ChatSidebarConstants','ChatSidebarGroupThreadsGroup.react','ChatSidebarHeader.react','ChatSidebarSections','ChatSidebarUserGroup.react','PresencePrivacy','ReactComponentWithPureRenderMixin','React','ReactDOM','Run','Scroll','SubscriptionsHandler','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y){if(c.__markCompiled)c.__markCompiled();var z=s.PropTypes,aa=s.createClass({displayName:'ChatSidebarOrderedList',propTypes:{topUsers:z.array.isRequired,availableUsers:z.array.isRequired,isSidebar:z.bool.isRequired,scrollContainer:z.object,groups:z.array.isRequired},getInitialState:function(){return {renderBelowFold:false,isDisconnected:false};},componentDidMount:function(){k.nukeLinks(t.findDOMNode(this));this._subscriptions=new w();u.onAfterLoad((function(){this.setState({renderBelowFold:true});this._bootloadChannelSubscription();}).bind(this));},componentWillUnmount:function(){this._subscriptions.release();},_scrollToSeparator:function(ba){if(!this.props.scrollContainer)return;var ca=this.props.scrollContainer.scrollHeight,da=this.props.scrollContainer.clientHeight,ea=v.getTop(this.props.scrollContainer),fa=Math.min(ba.offsetTop,ca-da);if(ea!==fa){var ga=Math.abs(fa-ea)/this.props.scrollContainer.clientHeight*500;new h(this.props.scrollContainer).to('scrollTop',fa).ease(h.ease.end).duration(ga).go();}},_renderOfflineSection:function(){var ba=l.getImageSize(this.props.isSidebar),ca=this.props.topUsers.filter(function(ea){return !q.allows(ea);});ca.splice(-2);var da=s.createElement('a',{ajaxify:'/ajax/chat/privacy/settings_dialog.php?ref=whitelist_separator',href:'#',rel:'dialog'},y._("\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"));return [s.createElement(n,{key:'usersSeparator1'},y._("\u0414\u0420\u0423\u0413\u0418\u0415 \u0414\u0420\u0423\u0417\u042c\u042f")),s.createElement(n,{className:"_5j9-",key:'usersSeparator2'},y._("\u042d\u0442\u0438 \u0434\u0440\u0443\u0437\u044c\u044f \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0432\u0438\u0434\u0435\u0442\u044c \u0432\u0430\u0441 \u0432 \u0447\u0430\u0442\u0435. {=link}",[y.param('=link',da)])),s.createElement(p,{ids:ca,isDisconnected:this.state.isDisconnected,imageSize:ba,key:o.OFFLINE_USERS,loadExtras:this.state.renderBelowFold,sectionName:o.OFFLINE_USERS})];},_renderOnlineSection:function(){if(this.props.availableUsers.length===0)return null;if(!this.state.renderBelowFold){var ba=l.getItemHeight();return (s.createElement('div',{key:o.MORE_ONLINE_FRIENDS,style:{height:ba*this.props.availableUsers.length}}));}var ca=l.getImageSize(this.props.isSidebar),da=y._("{MORE ONLINE FRIENDS} ({=count})",[y.param('MORE ONLINE FRIENDS',y._("\u0414\u0420\u0423\u0413\u0418\u0415 \u0414\u0420\u0423\u0417\u042c\u042f")),y.param('=count',this.props.availableUsers.length)]),ea=s.createElement(p,{ids:this.props.availableUsers,imageSize:ca,key:o.MORE_ONLINE_FRIENDS,loadExtras:this.state.renderBelowFold,sectionName:o.MORE_ONLINE_FRIENDS});return [s.createElement(n,{ref:'usersSeparator',key:'usersSeparator',onClick:(function(){return this._scrollToSeparator(t.findDOMNode(this.refs.usersSeparator));}).bind(this)},da),ea];},_renderGroupsSection:function(){if(this.props.groups.length===0)return null;var ba=this.state.isDisconnected||q.isUserOffline();return [s.createElement(n,{ref:'groupSeparator',key:'groupSeparator',className:ba?"_570-":'',onClick:(function(){return this._scrollToSeparator(t.findDOMNode(this.refs.groupSeparator));}).bind(this)},y._("\u0413\u0420\u0423\u041f\u041f\u041e\u0412\u0410\u042f \u041f\u0415\u0420\u0415\u041f\u0418\u0421\u041a\u0410")),s.createElement(m,{groups:this.props.groups,isDisconnected:this.state.isDisconnected,key:'group_threads_section',loadExtras:this.state.renderBelowFold})];},_renderFriendsSection:function(){var ba=l.getImageSize(this.props.isSidebar),ca=this.props.topUsers;if(q.getVisibility()==q.ONLINE)ca=this.props.topUsers.filter(function(da){return q.allows(da);});return [s.createElement(p,{key:o.ORDERED_LIST,ids:ca,imageSize:ba,loadExtras:this.state.renderBelowFold,sectionName:o.ORDERED_LIST})];},render:function(){var ba=q.getOnlinePolicy()==q.ONLINE_TO_WHITELIST&&q.getVisibility()?this._renderOfflineSection():this._renderOnlineSection(),ca=this._renderFriendsSection(),da=this._renderGroupsSection();return (s.createElement('div',null,ca,da,ba));},_bootloadChannelSubscription:function(){j.loadModules(["ChannelConnection"],(function(ba){this._subscriptions.addSubscriptions(ba.subscribe([ba.CONNECTED,ba.RECONNECTING,ba.SHUTDOWN,ba.MUTE_WARNING,ba.UNMUTE_WARNING],(function(){this.setState({isDisconnected:ba.disconnected()});}).bind(this)));}).bind(this));}});f.exports=aa;},null);
__d('ChatSortUsers',['ShortProfiles','TokenizeUtil'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={};function k(m){if(j[m])return j[m];var n=(h.getNowUnsafe(m)||{}).name;if(n)return j[m]=i.flatten(n);return '~';}var l={sortAlphabetical:function(m,n){var o=k(m),p=k(n);if(o!==p)return o<p?-1:1;return 0;}};f.exports=l;},null);
__d('PresenceOrderedList',['ChatSortUsers','immutable','InitialChatFriendsList','PresencePrivacy','PresenceStatus'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(){'use strict';this.$PresenceOrderedList1=this.$PresenceOrderedList2();}m.prototype.getSorted=function(n){'use strict';var o=[];this.$PresenceOrderedList1.forEach(function(p){var q=p[0],r=p[1];if(o.length>=n)return false;if(k.getFriendVisibility(q)==k.BLACKLISTED)return true;if(r==l.get(q))o.push(q);});return i.OrderedSet(o);};m.prototype.getAvailableSorted=function(n){'use strict';var o=i.Set(l.getOnlineIDs());if(n)o=o.subtract(n);return o.sort(h.sortAlphabetical);};m.prototype.$PresenceOrderedList2=function(){'use strict';var n=j.list||[];return n.map(function(o){var p=o.slice(0,-2),q=Number(o.slice(-1));return [p,q];});};f.exports=new m();},null);
__d('ChatOrderedList',['Arbiter','ArbiterMixin','AvailableList','AvailableListConstants','CSS','ChatConfig','ChatHovercard','ChatOptions','ChatOrderedListHover','ChatSidebarConstants','ChatSidebarInboxConfig','ChatSidebarOrderedList.react','ChatVisibility','DOM','DataStore','Event','InitialChatFriendsList','JSLogger','Parent','PresenceOrderedList','PresencePrivacy','PresenceStatus','React','ReactDOM','createObjectFrom','csx','debounceAcrossTransitions','mixin','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja){if(c.__markCompiled)c.__markCompiled();var ka,la,ma=null;ka=babelHelpers.inherits(na,ia(i));la=ka&&ka.prototype;function na(oa,pa){'use strict';la.constructor.call(this);this._isSidebar=oa;this._root=pa;this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._groups=[];this._hoverController=null;this._isHovering=false;this._orderedList=u.find(this._root,'.fbChatOrderedList');w.listen(this._orderedList,'mouseover',(function(){this._isHovering=true;}).bind(this));w.listen(this._orderedList,'mouseout',(function(){this._isHovering=false;this._render();}).bind(this));this._scrollableOrderedList=z.byClass(this._root,'scrollableOrderedList');this._scrollableArea=z.byClass(this._root,'scrollable');if(this._isSidebar)new n(this);h.subscribe(y.DUMP_EVENT,(function(qa,ra){ra.chat_lists=ra.chat_lists||{sorted_list:this.getSortedList(),available_list:aa.getAvailableSorted(),excluded_list:this._excludedIds};}).bind(this));ba.subscribe('privacy-user-presence-changed',ja(this._render,this));j.subscribe(k.ON_AVAILABILITY_CHANGED,ja(this._render,this));}na.prototype.getShowingUsers=function(){'use strict';return u.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};na.prototype.getUserForNode=function(oa){'use strict';return v.get(oa,'id')||v.get(oa,'serverthreadid');};na.prototype.getHoverController=function(){'use strict';if(!this._hoverController)this._hoverController=new p(this);return this._hoverController;};na.prototype.getItemHeight=function(){'use strict';return q.getItemHeight();};na.prototype.getRoot=function(){'use strict';return this._root;};na.prototype.getSortedList=function(){'use strict';return aa.getSorted(this._numTopFriends);};na.prototype.hide=function(){'use strict';if(!this._isVisible)return;this._isVisible=false;l.hide(this._scrollableOrderedList||this._root);this.inform('hide');};na.prototype.setNumTopFriends=function(oa,pa){'use strict';var qa=this._getGroups(),ra=oa-qa.length;if(ra>m.get('min_top_friends'))oa=ra;oa--;if(oa!==this._numTopFriends||qa.length!==this._groups.length){this._groups=qa;this._numTopFriends=oa;if(pa){this._renderOrderedList();}else this._render();}};na.prototype._renderOrderedList=function(){'use strict';if(!this._isVisible||this._isHovering)return;var oa=this.getSortedList(),pa=aa.getAvailableSorted(oa),qa=r.component;if(qa){ea.render(da.createElement(qa,{showCount:r.show_count,showPresence:r.show_presence,threadCount:this._numTopFriends}),this._orderedList);}else ea.render(da.createElement(s,{availableUsers:pa.toArray(),isSidebar:this._isSidebar,scrollContainer:this._scrollContainer,topUsers:oa.toArray(),groups:this._getGroups()}),this._orderedList);this.inform('render');};na.prototype._render=function(){'use strict';this._render=ha(this._renderOrderedList.bind(this),300);this._render();};na.prototype.show=function(){'use strict';if(this._isVisible)return;this._isVisible=true;l.show(this._scrollableOrderedList||this._root);this._render();this.inform('show');};na.prototype.isVisible=function(){'use strict';return this._isVisible;};na.prototype.setScrollContainer=function(oa){'use strict';if(u.contains(oa,this._root))this._scrollContainer=oa;};na.prototype._getGroups=function(){'use strict';if(!o.getSetting('hide_groups')){return x.groups||[];}else return [];};f.exports=na;},null);
__d('ChatSidebarTypeaheadDataSource',['MercuryConfig','MercuryTypeaheadDataSource','Run','ShortProfiles'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;l=babelHelpers.inherits(n,i);m=l&&l.prototype;function n(o){'use strict';o=o||{};o.kanaNormalization=true;if(h.ScrollableSidebarTypeaheadGK)o.maxResults=30;m.constructor.call(this,o);if(h.LinkedAgents&&h.LinkedAgents.length>0)j.onAfterLoad((function(){return this.bootstrap();}).bind(this));}n.prototype.init=function(){'use strict';m.init.call(this);this.updateBootstrapData();};n.prototype.bootstrap=function(){'use strict';m.bootstrap.call(this);};n.prototype.updateBootstrapData=function(){'use strict';if(this.isBootstrapped())return;m.updateBootstrapData.call(this);};n.prototype.fetchAll=function(){'use strict';k.fetchAll();};n.prototype.refreshData=function(){'use strict';this.fetchAll();};n.prototype.query=function(o,p,q,r){'use strict';this.logQuery({event:'query_dive_bar',query:o});return m.query.call(this,o,p,q,r);};n.prototype.respond=function(o,p,q){'use strict';var r=m.respond.call(this,o,p,q);this.logResponse({event:'query_response_dive_bar',response_query:o,response_uids:p});return r;};f.exports=n;},null);
__d('ChatTypeaheadCore',['Event','Keys','TypeaheadCore','emptyFunction','shield'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,j);n=m&&m.prototype;o.prototype.init=function(p,q,r){'use strict';n.init.call(this,p,q,r);this.informBeginActive=false;this.informEndActive=false;this.data.subscribe('respond',(function(){if(this.informBeginActive){this.informBeginActive=false;this.inform('sidebar/typeahead/active',true);}else if(this.informEndActive){this.informEndActive=false;this.inform('sidebar/typeahead/active',false);}}).bind(this));};o.prototype.keydown=function(event){'use strict';this.data.fetchAll();var p=h.getKeyCode(event);if(p===i.ESC){this.view.clearContent();setTimeout(l(this.reset,this),0);if(!this.getValue()){this.element.blur();this.inform('escape');}return event.kill();}return n.keydown.call(this,event);};o.prototype.checkValue=function(){'use strict';var p=this.getValue(),q=this.value;if(p==q)return;if(q&&!p){this.typeaheadActive=false;this.informEndActive=true;}else if(!q&&p){this.typeaheadActive=true;this.informBeginActive=true;this.inform('sidebar/typeahead/preActive');}n.checkValue.call(this);};function o(){'use strict';m.apply(this,arguments);}Object.assign(o.prototype,{handleTab:k});f.exports=o;},null);
__d('ChatTypeaheadRenderer',['AvailableListConstants','ChatSidebarConstants','ChatSidebarHeader.react','ChatSidebarSections','ChatSidebarThread.react','ChatSidebarUser.react','ChatTypeaheadConstants','DOM','LastActiveTimes','MercuryIDs','PresenceStatus','React','ReactDOM','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){if(c.__markCompiled)c.__markCompiled();var v={};function w(ba,ca){if(!(ba in v))v[ba]=o.create('li');t.render(ca,v[ba]);return v[ba];}function x(ba){return w(ba.text,s.createElement(j,null,ba.text));}function y(ba){var ca=ba.mercury_thread.participants.map(function(da){return q.getUserIDFromParticipantID(da);});return w(ba.uid,s.createElement(l,{image:ba.mercury_thread.image_src,imageSize:i.getImageSize(),name:ba.mercury_thread.name,participants:ba.participants_to_render,numOtherParticipants:ca.length-1,referrer:k.TYPEAHEAD,status:r.getGroup(ca),threadFBID:ba.uid}));}function z(ba){var ca=r.get(ba.uid),da=ca===h.MOBILE?p.getShortDisplay(ba.uid):null,ea=ba.subtext;return w(ba.uid,s.createElement(m,{image:ba.photo,imageSize:i.getImageSize(),name:ba.text,sectionName:k.TYPEAHEAD,status:ca,statusTime:da,userID:ba.uid,context:ea}));}function aa(ba,ca){if(ba.type===n.HEADER_TYPE)return x(ba);if(ba.type==n.THREAD_TYPE)return y(ba);return z(ba);}f.exports=aa;},null);
__d('ChatTypeaheadView',['BucketedTypeaheadView','ChatTypeaheadConstants','CurrentUser','DOM','MercuryConfig','React','ReactDOM','ScrollableArea','MercuryThreadSearchUtils','Style','WorkModeConfig','XUISpinner.react','arrayContains','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w,x;w=babelHelpers.inherits(y,h);x=w&&w.prototype;function y(z,aa){'use strict';if(l.ScrollableSidebarTypeaheadGK){var ba=o.renderDOM();k.appendContent(z,ba.root);var ca=o.fromNative(ba.root);x.constructor.call(this,ba.content,aa);this.$ChatTypeaheadView1=ba;this.$ChatTypeaheadView2=ca;}else x.constructor.call(this,z,aa);this.showingLoadingIndicator=false;this.typeObjects={};this.typeObjectsOrder=[];this.typeObjects[i.NON_FRIEND_TYPE]={uid:i.NON_FRIEND_TYPE,type:i.HEADER_TYPE,text:v._("\u0415\u0429\u0415")};this.typeObjects[i.COMMERCE_PAGE_TYPE]={disabled:true,uid:i.COMMERCE_PAGE_TYPE,type:i.HEADER_TYPE,text:v._("BUSINESSES")};this.typeObjects[i.MEETING_ROOM_PAGE_TYPE]={disabled:true,uid:i.MEETING_ROOM_PAGE_TYPE,type:i.HEADER_TYPE,text:v._("MEETING ROOMS")};this.typeObjects[i.PAGE_TYPE]={disabled:true,uid:i.PAGE_TYPE,type:i.HEADER_TYPE,text:v._("\u0414\u0440\u0443\u0433\u0438\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u044b")};this.typeObjects[i.THREAD_TYPE]={uid:i.THREAD_TYPE,type:i.HEADER_TYPE,text:v._("\u0413\u0420\u0423\u041f\u041f\u041e\u0412\u0410\u042f \u041f\u0415\u0420\u0415\u041f\u0418\u0421\u041a\u0410")};this.typeObjects[i.FB4C_TYPE]={uid:i.FB4C_TYPE,type:i.HEADER_TYPE,text:v._("\u041a\u041e\u041b\u041b\u0415\u0413\u0418")};this.typeObjects[i.FRIEND_TYPE]={disabled:true,uid:i.FRIEND_TYPE,type:i.HEADER_TYPE,text:v._("\u0414\u0420\u0423\u0417\u042c\u042f")};this.$ChatTypeaheadView3();}y.prototype.reset=function(){'use strict';if(this.value==='')this.clearContent();this.index=-1;this.items=[];this.results=[];this.value='';this.inform('reset');return this;};y.prototype.clearContent=function(){'use strict';this.hideLoadingIndicator();k.empty(this.content);};y.prototype.buildBuckets=function(z,aa){'use strict';var ba=aa.filter(function(ca){var da=ca.render_type||ca.type;if(da==='thread'){var ea='fbid:'+j.getID();if(!t(ca.mercury_thread.participants,ea))return false;var fa=ca.participants_to_render.some(function(ha){return p.queryMatchesName(z,ha.name);}),ga=p.queryMatchesName(z,ca.mercury_thread.name);if(!fa&&!ga)return false;}return true;}).reverse();this.$ChatTypeaheadView3(z);return x.buildBuckets.call(this,z,ba);};y.prototype.getDefaultIndex=function(z){'use strict';if(z.length===0)return -1;var aa=z.length-1;while(!this.isHighlightable(z[aa])&&aa>=0)aa--;return aa;};y.prototype.showLoadingIndicator=function(){'use strict';if(!this.showingLoadingIndicator){n.render(m.createElement('div',{className:'spinnerContainer'},m.createElement(s,{className:"_3-8i",background:'light',size:'small',paused:false})),this.content);this.showingLoadingIndicator=true;}};y.prototype.hideLoadingIndicator=function(){'use strict';if(this.showingLoadingIndicator){n.unmountComponentAtNode(this.content);this.showingLoadingIndicator=false;}};y.prototype.showNoResults=function(){'use strict';var z=v._("\u0414\u0440\u0443\u0433 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d.");if(r.is_work_user)z=v._("\u041a\u043e\u043b\u043b\u0435\u0433\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d.");this.hideLoadingIndicator();k.setContent(this.content,k.create('div',{className:"noResults _3-9a"},z));};y.prototype.hide=function(){'use strict';this.clearContent();return x.hide.call(this);};y.prototype.next=function(){'use strict';x.next.call(this);if(l.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView2.scrollIntoView(this.selected,false);};y.prototype.prev=function(){'use strict';x.prev.call(this);if(l.ScrollableSidebarTypeaheadGK)this.$ChatTypeaheadView2.scrollIntoView(this.selected,false);};y.prototype.setMaxHeight=function(z){'use strict';q.set(this.$ChatTypeaheadView1.wrap,'max-height',z+'px');};y.prototype.render=function(z,aa,ba){'use strict';if(l.ScrollableSidebarTypeaheadGK)var ca=this.value!==z||this.$ChatTypeaheadView2.isScrolledToBottom();if(!aa.length){if(z&&z.length>1)this.showLoadingIndicator();}else this.hideLoadingIndicator();x.render.call(this,z,aa,ba);if(l.ScrollableSidebarTypeaheadGK&&ca)this.$ChatTypeaheadView2.scrollToBottom(false);};y.prototype.$ChatTypeaheadView3=function(z){'use strict';if(j.isWorkUser()){this.typeObjectsOrder=[i.MEETING_ROOM_PAGE_TYPE,i.THREAD_TYPE,i.NON_FRIEND_TYPE,i.FB4C_TYPE,i.FRIEND_TYPE];}else if(l.WWWMessengerMoneyPennyGK&&z&&l.HoistAgentsKeywords&&l.HoistAgentsKeywords.indexOf(z.toLowerCase())!==-1){this.typeObjectsOrder=[i.NON_FRIEND_TYPE,i.FB4C_TYPE,i.THREAD_TYPE,i.FRIEND_TYPE,i.MEETING_ROOM_PAGE_TYPE,i.COMMERCE_PAGE_TYPE,i.PAGE_TYPE];}else this.typeObjectsOrder=[i.NON_FRIEND_TYPE,i.MEETING_ROOM_PAGE_TYPE,i.COMMERCE_PAGE_TYPE,i.PAGE_TYPE,i.FB4C_TYPE,i.THREAD_TYPE,i.FRIEND_TYPE];};f.exports=y;},null);
__d('EmployeeLinkMatcher',['CurrentUser'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=new RegExp('^[\\s.,:]'),j=new RegExp('(?:[\\s.,:]|^)([DTP]\\d{4,})(?:[\\s.,:?]|$)','im'),k=function(n){if(!h.isEmployee())return null;var o=j.exec(n);if(o==null)return null;return {lnk:o[1],idx:o.index+(i.exec(o[0])?1:0)};},l=function(n){var o=h.isEmployee()&&j.exec(n)!=null;return o;},m={match:k,isMatch:l};f.exports=m;},null);
__d('EmployeeLinkRanges',['EmployeeLinkMatcher'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i={PHABRICATOR_PREFIX:'https://phabricator.fb.com/',TASKS_PREFIX:'https://our.intern.facebook.com/intern/tasks/?t=',get:function(j){var k=arguments.length<=1||arguments[1]===undefined?0:arguments[1],l=j.substr(k),m=h.match(l);if(!m)return [];var n=m.lnk;k+=m.idx;var o='';switch(n[0].toLowerCase()){case 'd':case 'p':o=this.PHABRICATOR_PREFIX+n.toUpperCase();break;case 't':o=this.TASKS_PREFIX+n.substr(1);break;default:return [];}var p=n.length,q=[{offset:k,length:p,entity:{url:o}}];return q.concat(this.get(j,k+p));}};f.exports=i;},null);
__d('P2PTriggersUtils',['P2PGKValues'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=/\$((\d{1,3}(,\d{3})*)|\d+)(\.\d{1,2})?(?=\s|\.\s|\,\s|$|\.$|\,$|\?|\!|\")/,j={canSeeTriggers:function(k){if(!h.P2PEnabled)return false;return true;},getMatches:function(k){return k.match(i);}};f.exports=j;},null);
__d('getURLRanges',['URI','URLScraper'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();function j(k){var l=arguments.length<=1||arguments[1]===undefined?0:arguments[1],m=k.substr(l),n=i.match(m);if(!n)return [];var o=n;if(!/^[a-z][a-z0-9\-+.]+:\/\//i.test(n))o='http://'+n;if(!h.isValidURI(o))return [];l+=m.indexOf(n);var p=n.length,q=[{offset:l,length:n.length,entity:{url:o}}];return q.concat(j(k,l+p));}f.exports=j;},null);
__d('MercuryMessageBody.react',['BootloadedComponent.react','EmoticonsList','EmployeeLinkMatcher','JSResource','Link.react','P2PTriggersUtils','ReactComponentWithPureRenderMixin','React','SupportedEmoji','TextWithEntities.react','URI','URLMatcher','cancelAnimationFrame','cx','EmployeeLinkRanges','fbt','getURLRanges','isFacebookURI','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){if(c.__markCompiled)c.__markCompiled();var aa=o.PropTypes,ba=o.createClass({displayName:'MercuryMessageBody',mixins:[n],propTypes:{body:aa.string,ranges:aa.array,threadID:aa.string,customLike:aa.object},getInitialState:function(){return {richText:false};},_shouldRenderP2PTriggers:false,componentDidMount:function(){this._raf=z(this.setIsRichText);},targetBlankLinkInterpolator:function(ca,da){if(da.entity&&da.entity.url){var ea=new r(da.entity.url);if(y(ea)&&!ea.getFragment())da.entity.url=ea.addQueryData({__mref:'message_bubble'}).toString();da.entity.url=/.*[^#]/.exec(da.entity.url)[0];}return (o.createElement(l,{href:da.entity.url,shimhash:da.entity.shimhash,s:da.entity.s,target:'_blank'},ca));},setIsRichText:function(){delete this._raf;var ca=this.props,da=ca.body,ea=ca.ranges;da=da||'';this._shouldRenderP2PTriggers=!!(this.props.threadID&&m.canSeeTriggers(this.props.threadID)&&m.getMatches(da));if(ea&&ea.length||i.noncapturingRegexp.test(da)||p.findEmoji(da)||s.match(da)||j.isMatch(da)||this._shouldRenderP2PTriggers)this.setState({richText:true});},componentWillUnmount:function(){this._raf&&t(this._raf);},render:function(){var ca=this.props.body||'';if(ca.startsWith('?OTR'))return (o.createElement('span',{className:"_89h"},w._("[\u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435]")));ca=ca.replace(/\s+$/,'');if(ca.length===0)return null;if(!this.state.richText)return o.createElement('span',{className:this.props.className},ca);var da=this.props.ranges;if(da==undefined)da=x(ca);if(da==undefined){da=v.get(ca);}else{da=da.concat(v.get(ca));da=da.filter(function(ga){return ga!=undefined;});}var ea={className:this.props.className,interpolator:this.targetBlankLinkInterpolator,text:ca,ranges:da,renderEmoticons:true,renderEmoji:true},fa=o.createElement(q,ea);if(this._shouldRenderP2PTriggers){return (o.createElement(h,babelHelpers._extends({bootloadPlaceholder:fa,bootloadLoader:k('TextWithEntitiesAndP2P.react')},ea,{threadID:this.props.threadID})));}else return fa;}});f.exports=ba;},null);
__d('NotificationBeeperItemCloseButton.react',['React','XUIAbstractGlyphButton.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.createClass({displayName:'NotificationBeeperItemCloseButton',render:function(){return (h.createElement(i,babelHelpers._extends({},this.props,{className:"_3soc",title:k._("\u0417\u0430\u043a\u0440\u044b\u0442\u044c")})));}});f.exports=l;},null);
__d('SyncRequestAcceptedMessage.react',['React','fbt','cx'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'SyncRequestAcceptedMessage',propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (h.createElement('div',null,i._("{receiver} accepted your invite to play {app name}.",[i.param('receiver',h.createElement('span',{className:"_dg4"},this.props.receiverName)),i.param('app name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}else return (h.createElement('div',null,i._("You accepted an invite from {sender} to play {app name}.",[i.param('sender',h.createElement('span',{className:"_dg4"},this.props.senderName)),i.param('app name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}});f.exports=l;},null);
__d('SyncRequestCanceledMessage.react',['React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'SyncRequestCanceledMessage',propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (h.createElement('div',null,j._("You canceled an invite to {receiver} to play {app name}.",[j.param('receiver',h.createElement('span',{className:"_dg4"},this.props.receiverName)),j.param('app name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}else return (h.createElement('div',null,j._("{sender} canceled an invitation to play {app name}.",[j.param('sender',h.createElement('span',{className:"_dg4"},this.props.senderName)),j.param('app name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}});f.exports=l;},null);
__d('SyncRequestExpiredMessage.react',['React','fbt','cx'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'SyncRequestExpiredMessage',propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (h.createElement('div',null,i._("{receiver} missed your invite to play {app name}.",[i.param('receiver',h.createElement('span',{className:"_dg4"},this.props.receiverName)),i.param('app name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}else return (h.createElement('div',null,i._("You missed an invite from {sender} to play {app name}.",[i.param('sender',h.createElement('span',{className:"_dg4"},this.props.senderName)),i.param('app name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}});f.exports=l;},null);
__d('SyncRequestRejectedMessage.react',['AsyncRequest','Link.react','React','URI','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=j.PropTypes,o=j.createClass({displayName:'SyncRequestRejectedMessage',propTypes:{requestId:n.string.isRequired,app:n.object.isRequired,isSender:n.bool.isRequired,receiver:n.object.isRequired,sender:n.object.isRequired},render:function(){if(this.props.isSender){return (j.createElement('div',null,m._("{receiver} declined your invite to play {app_name}.",[m.param('receiver',j.createElement('span',{className:"_dg4"},this.props.receiver.name)),m.param('app_name',j.createElement('span',{className:"_dg5"},this.props.app.name))])));}else return (j.createElement('div',null,m._("You declined an invite from {sender} to play {app_name}.",[m.param('sender',j.createElement('span',{className:"_dg4"},this.props.sender.name)),m.param('app_name',j.createElement('span',{className:"_dg5"},this.props.app.name))]),j.createElement('div',{className:"_13n7"},j.createElement('div',null,j.createElement(i,{onClick:this._submitBlockApp},m._("Block {app}",[m.param('app',this.props.app.name)]))),j.createElement('div',null,j.createElement(i,{onClick:this._submitBlockUser},m._("Block requests from {sender}",[m.param('sender',this.props.sender.name)]))))));},_submitBlockApp:function(){var p=new k('/games/block_app/'),q=new h().setURI(p);q.setData({app_id:this.props.app.id,source:'sync_request'});q.send();},_submitBlockUser:function(){var p=new k('/games/block_user/'),q=new h().setURI(p);q.setData({app_id:this.props.app.id,blockee_uid:this.props.sender.id});q.send();}});f.exports=o;},null);
__d('SyncRequestTimer.react',['React','fbt'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.PropTypes;function k(m){if(m){m=Math.ceil(m);var n=m%60;if(n<10)n='0'+n;var o=Math.floor(m/60);return o+':'+n;}else return "0:00";}var l=h.createClass({displayName:'SyncRequestTimer',propTypes:{timeRemaining:j.number.isRequired,isSender:j.bool.isRequired,receiverName:j.string.isRequired},render:function(){if(this.props.isSender){return (h.createElement('div',null,i._("({time_remaining} remaining)",[i.param('time_remaining',k(this.props.timeRemaining))])));}else return (h.createElement('div',null,i._("You have {time_remaining} to accept.",[i.param('time_remaining',k(this.props.timeRemaining))])));}});f.exports=l;},null);
__d('SyncRequestTitle.react',['React','fbt','cx'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'SyncRequestTitle',propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (h.createElement('div',null,i._("Waiting for {receiver} to accept your invite to play {app_name}.",[i.param('receiver',h.createElement('span',{className:"_dg4"},this.props.receiverName)),i.param('app_name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}else return (h.createElement('div',null,i._("{sender} wants to play {app_name} with you, right now.",[i.param('sender',h.createElement('span',{className:"_dg4"},this.props.senderName)),i.param('app_name',h.createElement('span',{className:"_dg5"},this.props.appName))])));}});f.exports=l;},null);
__d("XSyncRequestSubmitController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/platform\/games\/sync_requests\/submit\/",{request_id:{type:"Int",required:true},sender:{type:"Int",required:true},action:{type:"Int",required:true}});},null);
__d('SyncRequest.react',['Arbiter','AsyncRequest','ChannelConstants','React','SyncRequestStatusEnum','SyncRequestTitle.react','SyncRequestAcceptedMessage.react','SyncRequestRejectedMessage.react','SyncRequestExpiredMessage.react','SyncRequestCanceledMessage.react','SyncRequestTimer.react','XUIButton.react','XSyncRequestSubmitController','cx','fbt','getObjectValues'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=k.PropTypes,y=k.createClass({displayName:'SyncRequest',propTypes:{app:x.object.isRequired,creationTime:x.number.isRequired,requestId:x.string.isRequired,receiver:x.object.isRequired,sender:x.object.isRequired,status:x.oneOf(w(l)).isRequired,timeout:x.number.isRequired,timeRemaining:x.number.isRequired,viewerId:x.number.isRequired,onStatusUpdate:x.func},componentWillMount:function(){if(this.props.status===l.PENDING){var z=h.subscribe(j.getArbiterType('sync_request_updated'),(function(ca,da){da=da.obj;if(da.id.toString()!==this.props.requestId)return;this.setState({status:da.status});}).bind(this));this.setState({statusEvent:z});}var aa=null;if(this.props.status===l.PENDING){var ba=function(){this.setState({time_remaining:this.state.time_remaining-1});if(this.state.time_remaining<=0){clearInterval(this.state.counter);var ca={counter:null,time_remaining:0};if(this.state.status===l.PENDING)ca.status=l.EXPIRED;this.setState(ca);}};aa=setInterval(ba.bind(this),1000);}this.setState({time_remaining:this.props.timeRemaining,counter:aa});},componentWillUnmount:function(){if(this.state.counter)clearInterval(this.state.counter);h.unsubscribe(this.state.statusEvent);},getInitialState:function(){return {buttonsDisabled:false,time:Date.now(),status:this.props.status,viewerIsSender:this.props.viewerId===this.props.sender.id};},componentDidUpdate:function(z,aa){if(this.props.status!=l.PENDING)this.state.status=this.props.status;if(this.props.onStatusUpdate)this.props.onStatusUpdate(this.state.status,aa.status);},render:function(){var z;switch(this.state.status){case l.PENDING:var aa;if(!this.state.viewerIsSender){aa=[k.createElement(s,{use:'confirm',onClick:this._handleAccept,disabled:this.state.buttonsDisabled,label:v._("Accept")}),k.createElement(s,{use:'default',onClick:this._handleReject,disabled:this.state.buttonsDisabled,label:v._("Decline")})];}else aa=k.createElement(s,{use:'default',onClick:this._handleCancel,disabled:this.state.buttonsDisabled,label:v._("Cancel")});z=k.createElement('div',null,k.createElement('div',{className:"_372m"},k.createElement(m,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name})),k.createElement('div',{className:"_372n"},k.createElement(r,{isSender:this.state.viewerIsSender,timeRemaining:this.state.time_remaining,receiverName:this.props.receiver.name})),k.createElement('div',{className:"_372o"},aa));break;case l.ACCEPTED:z=k.createElement('div',{className:"_372p mvs"},k.createElement(n,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case l.REJECTED:z=k.createElement('div',{className:"_372p mvs"},k.createElement(o,{requestId:this.props.requestId,app:this.props.app,isSender:this.state.viewerIsSender,receiver:this.props.receiver,sender:this.props.sender}));break;case l.EXPIRED:z=k.createElement('div',{className:"_372p mvs"},k.createElement(p,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case l.CANCELED:z=k.createElement('div',{className:"_372p mvs"},k.createElement(q,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;default:throw new Error('The request status `%s` is unknown.',this.state.status);}return (k.createElement('div',{className:"_372q"},z));},_handleAccept:function(){this._handleStatusUpdate(l.ACCEPTED);var z=window.open(this.props.app.uri);if(z)z.focus();},_handleReject:function(){this._handleStatusUpdate(l.REJECTED);},_handleCancel:function(){this._handleStatusUpdate(l.CANCELED);},_handleStatusUpdate:function(z){this.setState({status:z,buttonsDisabled:true});var aa=t.getURIBuilder().setInt('request_id',this.props.requestId).setInt('sender',this.props.sender.id).setInt('action',z).getURI();new i().setURI(aa).setHandler((function(ba){this.setState({status:z});}).bind(this)).setErrorHandler((function(ba){this.setState({buttonsDisabled:false});}).bind(this)).send();}});f.exports=y;},null);
__d("XQuickPromotionSimpleLoggingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/qp\/action\/log\/",{qp_id:{type:"Int",required:true},qp_action:{type:"Enum",enumType:1},qp_instance_log_data:{type:"StringToStringMap",defaultValue:{}},qp_event:{type:"String"}});},null);
__d('QPRenderer',['$','CSS','XQuickPromotionSimpleLoggingController','AsyncSignal'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(q,event,r){var s=j.getURIBuilder().setInt('qp_id',q).setString('qp_event',event).setStringToStringMap('qp_instance_log_data',r).getURI();new k(s,{}).send();},m=function(q,r,s){var t=j.getURIBuilder().setInt('qp_id',q).setEnum('qp_action',r).setStringToStringMap('qp_instance_log_data',s).getURI();new k(t,{}).send();},n=function(q,r,s,t,u,v){p(q,s,h(t),v,function(){if(u)i.hide(r);});},o=function(q,r,s){r.show();l(q,'view',{});r.subscribe('cancel',function(){l(q,'dialog_cancel',{});});for(var t=0;t<s.length;t++){var u=s[t],v=h(u.element_id);p(q,u.action,v,u.instance_log_data,function(){if(u.should_close)r.hide();});if(u.action=='primary')v.focus();}},p=function(q,r,s,t,u){s.addEventListener('click',function(){var v=j.getURIBuilder().setInt('qp_id',q).setEnum('qp_action',r).setStringToStringMap('qp_instance_log_data',t).getURI();new k(v,{}).send();u();});};g.setAction=n;g.setDialogActionsAndShow=o;g.logAction=m;g.logEvent=l;},null);
__d("XGamesGripperNoteUpdaterController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/async\/games\/gripper_note_viewed\/",{});},null);
__d('SidebarAppTickerResizer',['Animation','Arbiter','AsyncRequest','ChatSidebarActions','ChatSidebarStore','CSS','cx','debounce','DOMQuery','Event','SidebarType','SimpleDrag','TickerController','$','queryThenMutateDOM','XGamesGripperNoteUpdaterController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=1e-07,x=1,y=85,z=173,aa=300,ba=46,ca=90,da=82,ea=150;function fa(ga,ha,ia,ja,ka){'use strict';this.$SidebarAppTickerResizer1=u('pagelet_ticker');this.$SidebarAppTickerResizer2=u('pagelet_canvas_nav_content');this.$SidebarAppTickerResizer3=this.$SidebarAppTickerResizer1.parentNode;this.$SidebarAppTickerResizer4=ka;this.$SidebarAppTickerResizer2.style.height=ia;this.$SidebarAppTickerResizer5(ga,ha);if(ia===null)if(ja!==null){this.$SidebarAppTickerResizer6();this.$SidebarAppTickerResizer7(this.$SidebarAppTickerResizer8());}else i.subscribe('AppsDivebar/show-apps',this.$SidebarAppTickerResizer6.bind(this));if(!ka){this.$SidebarAppTickerResizer9();m.hide(ga);}i.subscribe('ChatSidebarDropdown/closeTicker',this.$SidebarAppTickerResizer9.bind(this));i.subscribe('ChatSidebarDropdown/openTicker',this.$SidebarAppTickerResizer10.bind(this));i.subscribe('sidebar/show',this.$SidebarAppTickerResizer11.bind(this));if(ja){var la=p.scry(document.body,'#pagelet_ticker')[0],ma=la&&la.parentNode,na,oa=function(){ja.hide();if(na)na.unsubscribe();},pa=function(){if(!m.shown(ma))return;var qa=c('XGamesGripperNoteUpdaterController').getURIBuilder().getURI();new j().setURI(qa).send();ja.show();if(na)na.unsubscribe();na=i.subscribe('sidebar/hide',oa);};if(ma&&m.shown(ma)){pa();}else na=i.subscribe('ticker/show',pa);}this.$SidebarAppTickerResizer12=o(this.$SidebarAppTickerResizer6.bind(this),200);q.listen(window,'resize',this.$SidebarAppTickerResizer12);i.inform('Ticker/resized');}fa.prototype.$SidebarAppTickerResizer11=function(){'use strict';t.show(this.$SidebarAppTickerResizer1);};fa.prototype.$SidebarAppTickerResizer6=function(ga){'use strict';v((function(){this.$SidebarAppTickerResizer13();}).bind(this),(function(){var ha=Math.round(parseFloat(this.$SidebarAppTickerResizer1.style.height));if(ha>Math.round(this.$SidebarAppTickerResizer14())||this.$SidebarAppTickerResizer15&&this.$SidebarAppTickerResizer15>x){var ia=this.$SidebarAppTickerResizer15/this.$SidebarAppTickerResizer16*100,ja=this.$SidebarAppTickerResizer17(0,this.$SidebarAppTickerResizer14()-ia);if(!(ga&&ga.type==='resize'))this.$SidebarAppTickerResizer18(ja);k.show();}}).bind(this));};fa.prototype.$SidebarAppTickerResizer14=function(){'use strict';if(!this.$SidebarAppTickerResizer4)return 0;if(l.getVisibleType()!==r.SIDEBAR)return ca;return Math.min(ca,(this.$SidebarAppTickerResizer16-this.$SidebarAppTickerResizer19-da)*100/this.$SidebarAppTickerResizer16);};fa.prototype.$SidebarAppTickerResizer5=function(ga,ha){'use strict';var ia=new s(ga);ia.subscribe('start',this.$SidebarAppTickerResizer20.bind(this));ia.subscribe(['update','end'],this.$SidebarAppTickerResizer21.bind(this));var ja=new s(ha);ja.subscribe('start',this.$SidebarAppTickerResizer20.bind(this));ja.subscribe('update',this.$SidebarAppTickerResizer22.bind(this));ja.subscribe('end',this.$SidebarAppTickerResizer23.bind(this));};fa.prototype.$SidebarAppTickerResizer20=function(ga,event){'use strict';this.$SidebarAppTickerResizer24=event.clientY;this.$SidebarAppTickerResizer13();this.$SidebarAppTickerResizer25();};fa.prototype.$SidebarAppTickerResizer13=function(){'use strict';this.$SidebarAppTickerResizer19=this.$SidebarAppTickerResizer2.offsetTop;this.$SidebarAppTickerResizer26=this.$SidebarAppTickerResizer1.offsetHeight;this.$SidebarAppTickerResizer16=this.$SidebarAppTickerResizer3.offsetHeight;this.$SidebarAppTickerResizer15=this.$SidebarAppTickerResizer2.offsetHeight;this.$SidebarAppTickerResizer27=this.$SidebarAppTickerResizer15;};fa.prototype.$SidebarAppTickerResizer25=function(){'use strict';m.addClass(this.$SidebarAppTickerResizer3,"_4vfq");};fa.prototype.$SidebarAppTickerResizer28=function(){'use strict';m.removeClass(this.$SidebarAppTickerResizer3,"_4vfq");};fa.prototype.$SidebarAppTickerResizer21=function(ga,event){'use strict';var ha=this.$SidebarAppTickerResizer15/this.$SidebarAppTickerResizer16*100,ia=this.$SidebarAppTickerResizer17(event.clientY-this.$SidebarAppTickerResizer24,this.$SidebarAppTickerResizer14()-ha);if(ga=='end'){this.$SidebarAppTickerResizer28();this.$SidebarAppTickerResizer18(ia);}k.show();};fa.prototype.$SidebarAppTickerResizer22=function(ga,event){'use strict';var ha=-this.$SidebarAppTickerResizer15,ia=this.$SidebarAppTickerResizer8()-this.$SidebarAppTickerResizer15,ja=this.$SidebarAppTickerResizer29(event.clientY-this.$SidebarAppTickerResizer24,ha,ia);this.$SidebarAppTickerResizer17(-ja,this.$SidebarAppTickerResizer14());this.$SidebarAppTickerResizer27=this.$SidebarAppTickerResizer15+ja;this.$SidebarAppTickerResizer27=Math.max(x,this.$SidebarAppTickerResizer27);this.$SidebarAppTickerResizer2.style.height=this.$SidebarAppTickerResizer27+'px';};fa.prototype.$SidebarAppTickerResizer23=function(ga,event){'use strict';var ha=this.$SidebarAppTickerResizer27,ia=this.$SidebarAppTickerResizer30(this.$SidebarAppTickerResizer27),ja=this.$SidebarAppTickerResizer17(this.$SidebarAppTickerResizer15-ia,this.$SidebarAppTickerResizer14());if(this.$SidebarAppTickerResizer15!=ia){this.$SidebarAppTickerResizer7(ia);this.$SidebarAppTickerResizer18(ja);}new h(this.$SidebarAppTickerResizer2).from('height',ha).to('height',ia).duration(aa).go();};fa.prototype.$SidebarAppTickerResizer17=function(ga,ha){'use strict';var ia=this.$SidebarAppTickerResizer26+ga,ja=ia/this.$SidebarAppTickerResizer16*100;ja=Math.max(w,Math.min(ha,ja));this.$SidebarAppTickerResizer1.style.height=ja+'%';if(ja!=w){m.removeClass(this.$SidebarAppTickerResizer1,'hidden_elem');this.$SidebarAppTickerResizer11();}return ja;};fa.prototype.$SidebarAppTickerResizer30=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer31(),ia=this.$SidebarAppTickerResizer8();return ga<ia-ba?ga<ha-ba?x:ha:ia;};fa.prototype.$SidebarAppTickerResizer31=function(){'use strict';return y;};fa.prototype.$SidebarAppTickerResizer8=function(){'use strict';return z;};fa.prototype.$SidebarAppTickerResizer32=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer8();return ga<0?x:ga>ha?ha:ga;};fa.prototype.$SidebarAppTickerResizer29=function(ga,ha,ia){'use strict';return ga<ha?ha:ga>ia?ia:ga;};fa.prototype.$SidebarAppTickerResizer18=function(ga){'use strict';new j('/ajax/feed/ticker/resize').setData({height:''+ga}).setMethod('POST').send();i.inform('Ticker/resized');};fa.prototype.$SidebarAppTickerResizer7=function(ga){'use strict';new j('/ajax/feed/apps/resize').setData({height:''+ga}).setMethod('POST').send();};fa.prototype.$SidebarAppTickerResizer33=function(ga){'use strict';var ha=this.$SidebarAppTickerResizer26,ia=this.$SidebarAppTickerResizer16*ga/100;new h(this.$SidebarAppTickerResizer1).from('height',ha).to('height',ia).duration(ea).ondone((function(){this.$SidebarAppTickerResizer1.style.height=ga+'%';this.$SidebarAppTickerResizer18(ga===0?'0.0':ga);k.show();}).bind(this)).go();};fa.prototype.$SidebarAppTickerResizer9=function(){'use strict';this.$SidebarAppTickerResizer13();this.$SidebarAppTickerResizer33(0);};fa.prototype.$SidebarAppTickerResizer10=function(){'use strict';this.$SidebarAppTickerResizer1.style.height='40px';t.show(this.$SidebarAppTickerResizer1,(function(){this.$SidebarAppTickerResizer13();var ga=(this.$SidebarAppTickerResizer16-this.$SidebarAppTickerResizer19-da-this.$SidebarAppTickerResizer15)*50/this.$SidebarAppTickerResizer16;this.$SidebarAppTickerResizer33(ga);}).bind(this));};f.exports=fa;},null);
__d('JewelQPLogging',['QPRenderer'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=false,j=null,k=false;function l(){if(k)return;if(i&&j){k=true;h.logEvent(j.promotion_id,'view',j.instance_log_data?j.instance_log_data:{});}}var m={onJewelOpened:function(){i=true;l();},updateQPLogData:function(n){j=n;l();}};f.exports=m;},null);
__d('RequestsJewel',['Animation','AccessibilityLogger','Arbiter','AsyncRequest','AsyncSignal','ChannelConstants','CSS','DOM','Event','LinkController','Parent','ScrollableArea','Vector','MarauderLogger','$','debounce','ge','shield','fbt','JewelQPLogging','requireWeak'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){if(c.__markCompiled)c.__markCompiled();var ca=null;ba('FriendBrowserCheckboxController',function(ha){return ca=ha;});var da=530,ea=30,fa=160;Object.assign(ga,{instance:null,getInstance:function(){return ga.instance;},replaceJewelTitle:function(ha,ia){o.setContent(v(ha),ia);},updateFromDOM:function(){if(ga.instance)ga.instance.fromDom();},setInitialHeight:function(){if(ga.instance)ga.instance.setHeight();},maybeLoadJewel:function(){if(ga.instance)ga.instance.maybeLoadJewel();}});function ga(ha,ia,ja){'use strict';var ka=ia;if(typeof ia!=='string'){ka=ia.inbox_folder;ja=ia.do_new_mark_read;}ga.instance=this;this.countNew=0;this.jewel=ha;this.jewelFlyoutCase=ha.getRoot();this.jewelFlyout=x('fbRequestsFlyout');this.newCountSpan=x('newRequestCount');this.folder=ka;this.doNewMarkRead=ja;this.openTimestamp=0;this.$RequestsJewel1={};this.$RequestsJewel2=0;this.shouldClearPredictionAssocOnClick=false;this.$RequestsJewel3=-1;var la=x('requestsMarkReadButton');if(la)p.listen(la,'click',y(this.$RequestsJewel4,this));this.jewel.subscribe('marked-seen',y(this.$RequestsJewel5,this));this.jewel.subscribe('closed',y(this.$RequestsJewel6,this));this.jewel.subscribe('updated',this.$RequestsJewel7.bind(this));this.jewel.subscribe('opened',this.$RequestsJewel8.bind(this));q.registerHandler(this.$RequestsJewel9.bind(this));j.subscribe(m.getArbiterType('jewel_requests_add'),this.$RequestsJewel10.bind(this));j.subscribe(m.getArbiterType('jewel_friending_notifs'),this.$RequestsJewel11.bind(this));j.subscribe(m.getArbiterType('jewel_requests_remove_old'),this.$RequestsJewel12.bind(this));j.subscribe(m.getArbiterType('friend_requests_seen'),this.$RequestsJewel13.bind(this));p.listen(this.jewelFlyout,'submit',(function(na){var oa=r.byClass(na.getTarget(),'objectListItem');if(oa){n.removeClass(oa,'jewelItemNew');n.addClass(oa,'jewelItemResponded');}}).bind(this));var ma=o.find(x('fbRequestsJewel'),'a[rel="toggle"]');p.listen(ma,'focus',(function(na){i.logFocusIn();}).bind(this));this.setupScroll();p.listen(window,'resize',w((function(){this.$RequestsJewel14();}).bind(this)));j.subscribe('pymk-x-out',this.$RequestsJewel15.bind(this));}ga.prototype.setupScroll=function(){'use strict';var ha=o.scry(this.jewelFlyout,'.uiScrollableAreaWrap')[0];if(ha){this.$RequestsJewel16=ha;this.$RequestsJewel17=0;this.$RequestsJewel18=p.listen(ha,'scroll',this.$RequestsJewel19.bind(this),p.Priority.$RequestsJewel20);this.$RequestsJewel15();}};ga.prototype.fromDom=function(){'use strict';o.scry(this.jewelFlyout,'.jewelItemList li.objectListItem').forEach((function(ha){var ia=ha.getAttribute('id');if(ia){var ja=x(ia+'_status'),ka=this.$RequestsJewel21(ia);if(ka.requester)this.$RequestsJewel1[ka.requester]=ia;++this.$RequestsJewel2;}}).bind(this));this.$RequestsJewel22();};ga.prototype.$RequestsJewel23=function(ha){'use strict';var ia=ha.match(/^(\d+)_(\d+)/);return ia?{requester:ia[1],type:ia[2]}:undefined;};ga.prototype.$RequestsJewel21=function(ha){'use strict';var ia=ha?this.$RequestsJewel23(ha):undefined,ja;if(ia&&ia.requester){ja=parseInt(ia.requester,10);if(isNaN(ja))ja=undefined;}var ka;if(ia&&ia.type){ka=parseInt(ia.type,10);if(isNaN(ka))ka=undefined;}return {requester:ja,type:ka};};ga.prototype.$RequestsJewel24=function(){'use strict';if(this.countNew>0)this.countNew-=1;};ga.prototype.$RequestsJewel9=function(ha,event){'use strict';var ia=r.byClass(ha,'jewelItemNew');if(ia&&r.byClass(ia,'fbRequestList')&&r.byClass(ia,'beeperEnabled')){var ja=this.$RequestsJewel23(ia.id);ja&&this.$RequestsJewel5(ja.requester,ja.type);this.$RequestsJewel24();j.inform('jewel/count-updated',{jewel:'requests',count:this.countNew});n.removeClass(ia,'jewelItemNew');}return true;};ga.prototype.$RequestsJewel25=function(){'use strict';return o.scry(this.jewelFlyout,'.uiScrollableArea')[0];};ga.prototype.$RequestsJewel19=function(){'use strict';var ha=o.scry(this.$RequestsJewel16,'.uiMorePager');if(!ha)return;var ia=ha.pop();if(ia){var ja=t.getElementPosition(ia,'viewport').y;if(ja>0)n.addClass(r.byClass(this.$RequestsJewel16,'uiScrollableArea'),'contentAfter');var ka=o.find(ia,'a');if(!ka)return;var la=t.getElementPosition(ka,'viewport').y;if(la==this.$RequestsJewel17)return;var ma=t.getElementPosition(this.$RequestsJewel16,'viewport').y+t.getElementDimensions(this.$RequestsJewel16).y;if(la-300<ma&&la>0){this.$RequestsJewel17=la;var na=ka.getAttribute('ajaxify');if(na){new k(na).setRelativeTo(ka).setStatusElement(r.byClass(ka,'stat_elem')).send();}else ca&&ca.getInstance('jewel').showMore();}}this.$RequestsJewel15();};ga.prototype.$RequestsJewel11=function(ha,ia){'use strict';if(!ia||this.jewel.isOpen())return;if(ia.obj.notif_type!=='friend_confirmed')return;if(x('fbRequestsJewelLoading')){new k().setURI('/ajax/requests/loader/').send();return;}var ja={};ja.reloadcontent=true;new k().setURI('/ajax/requests/loader/').setData(ja).send();};ga.prototype.$RequestsJewel10=function(ha,ia){'use strict';if(!ia)return;var ja=ia.obj.from,ka=ia.obj.suggester,la=this.$RequestsJewel21(this.$RequestsJewel1[ja]).type,ma=la===19&&!ka;if(!ma&&(la||this.jewel.isOpen()))return;if(x('fbRequestsJewelLoading')){new k().setURI('/ajax/requests/loader/').send();}else{var na={};na.reloadcontent=true;new k().setURI('/ajax/requests/loader/').setData(na).send();}};ga.prototype.$RequestsJewel12=function(ha,ia){'use strict';if(!ia||this.jewel.isOpen()||x('fbRequestsJewelLoading')!==null)return;var ja=this.$RequestsJewel1[ia.obj.from],ka=ja&&x(ja);if(ka){if(n.hasClass(ka,'jewelItemNew')){this.$RequestsJewel24();j.inform('jewel/count-updated',{jewel:'requests',count:this.countNew});}if(!n.hasClass(ka,'jewelItemResponded')){o.remove(ka);delete this.$RequestsJewel1[ia.obj.from];--this.$RequestsJewel2;this.$RequestsJewel22();}}};ga.prototype.$RequestsJewel4=function(){'use strict';this.jewel.markSeen();this.$RequestsJewel26();};ga.prototype.$RequestsJewel5=function(ha,ia){'use strict';var ja=o.scry(this.jewelFlyout,'li');new l('/ajax/gigaboxx/endpoint/UpdateLastSeenTime.php',{folder:this.folder,first_item:ja[0].id}).send();var ka=typeof ha!='undefined'&&typeof ia!='undefined'?{requester:ha,type:ia}:{};this.doNewMarkRead&&new l('/ajax/requests/mark_read/',ka).send();};ga.prototype.$RequestsJewel13=function(ha,ia){'use strict';j.inform('jewel/count-updated',{jewel:'requests',count:0});};ga.prototype.$RequestsJewel26=function(ha,ia){'use strict';o.scry(this.jewel.root,'li.jewelItemNew').forEach(function(ja){n.removeClass(ja,'jewelItemNew');});};ga.prototype.$RequestsJewel7=function(ha,ia){'use strict';this.countNew=ia.count;n.conditionClass(this.jewelFlyout,'beeperUnread',this.countNew>0);n.conditionClass(this.jewelFlyoutCase,'showRequests',this.countNew>0);if(this.newCountSpan){var ja=this.countNew==1?z._("{num} \u041d\u041e\u0412\u042b\u0419 \u0417\u0410\u041f\u0420\u041e\u0421",[z.param('num',this.countNew)]):z._({"*":"{num} \u041d\u041e\u0412\u042b\u0425 \u0417\u0410\u041f\u0420\u041e\u0421\u041e\u0412","268435456":"{num} \u041d\u041e\u0412\u042b\u0419 \u0417\u0410\u041f\u0420\u041e\u0421","536870912":"{num} \u041d\u041e\u0412\u042b\u0425 \u0417\u0410\u041f\u0420\u041e\u0421\u0410"},[z.param('num',this.countNew,[0])]);o.setContent(this.newCountSpan,ja);}};ga.prototype.$RequestsJewel22=function(){'use strict';o.scry(this.jewelFlyout,'li.empty').forEach((function(ha){n.conditionShow(ha,this.$RequestsJewel2<=0);}).bind(this));};ga.prototype.$RequestsJewel8=function(){'use strict';j.inform('requestsJewel/opened');var ha=x('fbRequestsJewelLoading'),ia=this.$RequestsJewel25();if(!ha&&!ia){this.unhandledRequest=true;}else if(ha){var ja=Date.now();if(this.openTimestamp+5000<ja){this.openTimestamp=ja;new k().setURI('/ajax/requests/loader/').setData({log_impressions:true}).send();}}else{var ka=Object.keys(this.$RequestsJewel1);if(ka.length>0)new k().setURI('/friends/requests/log_impressions').setData({ids:ka.join(','),ref:'jewel'}).send();}ia&&s.poke(ia);aa.onJewelOpened();};ga.prototype.$RequestsJewel6=function(){'use strict';j.inform('requestsJewel/closed');this.$RequestsJewel26();};ga.prototype.$RequestsJewel27=function(){'use strict';return Math.min(Math.max(t.getViewportDimensions().y-fa,ea),da);};ga.prototype.$RequestsJewel14=function(){'use strict';if(this.$RequestsJewel25())new h(this.$RequestsJewel25()).to('height',this.$RequestsJewel27()+'px').duration(100).go();};ga.prototype.$RequestsJewel15=function(){'use strict';var ha=o.scry(this.jewelFlyout,'li.friendBrowserListUnit'),ia=t.getElementPosition(this.$RequestsJewel16,'viewport').y+t.getElementDimensions(this.$RequestsJewel16).y,ja=ha.length-1;while(ja>this.$RequestsJewel3){var ka=t.getElementPosition(ha[ja],'viewport').y;if(ka>0&&ka+t.getElementDimensions(ha[ja]).y<=ia)break;ja-=1;}var la=ja;while(ja>this.$RequestsJewel3){var ma=o.find(ha[ja],'input.friendBrowserID'),na=parseInt(ma.value,10),oa={pymk_id:na,pymk_location:'pymk_jewel'};u.log('regular_pymk_imp',undefined,oa);ja-=1;}this.$RequestsJewel3=Math.max(this.$RequestsJewel3,la);};ga.prototype.setHeight=function(){'use strict';this.$RequestsJewel25().style.height=this.$RequestsJewel27()+'px';};ga.prototype.maybeLoadJewel=function(){'use strict';if(this.unhandledRequest){this.unhandledRequest=false;this.$RequestsJewel8();}};f.exports=ga;},null);
__d('ChatAnimatedGifs',['URI'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={shouldHideBody:function(j){if(!j.has_attachment)return false;for(var k=0;k<j.attachments.length;k++){var l=j.attachments[k];if(l.preview_url){var m=i.getRawUrlFromSafeUrl(l.preview_url);if(j.body==m)return true;}}return false;},getRawUrlFromSafeUrl:function(j){return new h(j).getQueryData().url;}};f.exports=i;},null);
__d('ChatPrivacyActionController',['ChatVisibility','JSLogger','PresencePrivacy'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=function(l,m){this._userID=l;this._logger=i.create('blackbird');this._getState=function(){if(h.isOnline())return j.allows(this._userID)?k.NORMAL:k.BLOCKED;return k.OFFLINE;};this._togglePrivacy=function(){var n=this._getState();switch(this._getState()){case k.OFFLINE:if(h.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});h.goOnline((function(){if(!j.allows(this._userID)){if(this._getState()!==k.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}).bind(this));break;case k.BLOCKED:j.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case k.NORMAL:j.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout((function(){var n=(function(){m&&m(this._getState());}).bind(this);n();this._subscribeToken=j.subscribe('privacy-changed',n);}).bind(this),0);};k.OFFLINE='offline';k.BLOCKED='blocked';k.NORMAL='normal';Object.assign(k.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&j.unsubscribe(this._subscribeToken);}});f.exports=k;},null);
__d('ChatDateBreak.react',['React','cx','formatDate','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes,m=h.createClass({displayName:'ChatDateBreak',propTypes:{date:l.instanceOf(Date).isRequired},shouldComponentUpdate:function(n){return this.props.date.getTime()!==n.date.getTime();},render:function(){var n=j(this.props.date,{today:'g:ia',withinWeek:'D g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});return (h.createElement('time',{className:k(this.props.className,"_5w-5")},h.createElement('span',{className:"_5w-6"},n)));}});f.exports=m;},null);
__d('ChatAttachmentProgressBar.react',['Animation','React','cx'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=i.PropTypes,l=34,m=i.createClass({displayName:'ChatAttachmentProgressBar',propTypes:{ephemeralTTLMode:k.number.isRequired,timestamp:k.number.isRequired,isMessageAuthor:k.bool},componentDidMount:function(){if(!this.refs.progressBar)return;var n=l,o=this.props.ephemeralTTLMode,p=n/o*(Date.now()-this.props.timestamp),q=this._getRemainingTime();if(q>0&&p<n){var r=this.props.isMessageAuthor?'left':'right';new h(this.refs.progressBar).from(r,p).to(r,n).duration(q).go();}},_getRemainingTime:function(){return this.props.ephemeralTTLMode-(Date.now()-this.props.timestamp);},render:function(){return (i.createElement('a',{className:"_4yo"},i.createElement('span',{className:"_1gxq"}),i.createElement('span',{className:"_1gxr",ref:'progressBar'},i.createElement('span',{className:"_4yu"}))));}});f.exports=m;},null);
__d('ChatProgressBar.react',['React','cx'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=h.PropTypes,k=2000,l=250,m=h.createClass({displayName:'ChatProgressBar',_timer:null,propTypes:{isMessageAuthor:j.bool,onDone:j.func,setExpiredAnimation:j.func,timestamp:j.number.isRequired,ttl:j.number.isRequired},getInitialState:function(){return {percentage:this._getRemainingPercentage()};},componentDidMount:function(){if(this._getRemainingTime()>0){this._animateProgressBar();}else this.props.setExpiredAnimation&&this.props.setExpiredAnimation();},componentWillUnmount:function(){this._timer&&clearTimeout(this._timer);},render:function(){return (h.createElement('div',{className:"_3pcc"+(this._getRemainingTime()<0?' '+"_3pcd":''),ref:'item',style:{width:this.state.percentage.toString()+'%'}}));},_getRemainingTime:function(){return this.props.ttl-(Date.now()-this.props.timestamp)-k;},_getRemainingPercentage:function(){return 100-(Date.now()-this.props.timestamp)/(this.props.ttl-k)*100;},_animateProgressBar:function(){this._timer=setInterval((function(){if(this.isMounted())this.setState({percentage:this._getRemainingPercentage()});if(this._getRemainingTime()<0){clearTimeout(this._timer);this.props.onDone&&this.props.onDone();}}).bind(this),l);}});f.exports=m;},null);
__d('EmojiOnlyMessage.react',['React','cx'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=h.PropTypes,k=h.createClass({displayName:'EmojiOnlyMessage',propTypes:{sourceURIs:j.arrayOf(j.shape({type:j.string.isRequired,title:j.string,url:j.string.isRequired})).isRequired},render:function(){var l=this.props.sourceURIs,m=0,n=l.map(function(o){m++;return h.createElement('span',{className:"_5qi2",key:m,style:{backgroundImage:'url('+o.url+')'},title:o.title});});return (h.createElement('div',{className:this.props.className,tabIndex:'0'},n));}});f.exports=k;},null);
__d('MessageBubbleMixin',['DOMDimensions','ReactDOM'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=2,k={getInitialState:function(){return {bubbleWidth:null};},componentDidMount:function(){this._restyleBubble(this.props);},componentDidUpdate:function(l){if(l.maxWidth!==this.props.maxWidth||l.body!==this.props.body||!l.attachments&&this.props.attachments)this._restyleBubble(l);},_restyleBubble:function(l){if(this.props.attachments){this.setState({bubbleWidth:null});return;}var m=i.findDOMNode(this.refs.bubble);if(l.maxWidth!==this.props.maxWidth||h.getElementDimensions(m).width>this.props.maxWidth){var n=this.props.maxWidth;this.setState({bubbleWidth:n},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function(){var l=i.findDOMNode(this.refs.bubble),m=h.getElementDimensions(l).width,n=i.findDOMNode(this.refs.content),o=n?h.getElementDimensions(n).width+h.measureElementBox(i.findDOMNode(this.refs.contentWrapper),'width',true,false,false):0,p=o+j;if(o>0&&p<this.props.maxWidth&&m-p-this.getBoxWidth()>0)this.setState({bubbleWidth:p});}};f.exports=k;},null);
__d('ChatBubble.react',['Animation','ChatProgressBar.react','DOMDimensions','EmojiLikeUtils','EmojiOnlyMessage.react','MercuryAttachment','MercuryMessageBody.react','MercuryTagHelper','MessageBubbleMixin','React','ReactDOM','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';if(c.__markCompiled)c.__markCompiled();var u=q.PropTypes,v=1000,w=q.createClass({displayName:'ChatBubble',_boxWidth:0,mixins:[p],propTypes:{attachments:u.node,body:u.string,customLike:u.object,isEmojiLike:u.bool,isMessageAuthor:u.bool,maxWidth:u.number.isRequired,threadID:u.string,timestamp:u.number,ttl:u.number},getInitialState:function(){return {emojis:undefined,ephemeralExpiring:false,ephemeralExpired:false};},componentDidMount:function(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var x=this.props.body||'',y=k.richContent(x);if(y)this.setState({emojis:y});}},render:function(){var x=this.props.body||'';return (q.createElement('div',babelHelpers._extends({},this.props,{className:t("_5w1r"+(this._isEpehmeralStylePreferred()?' '+"_4gx-":'')+(this.state.ephemeralExpiring?' '+"_1xti":'')+(this.state.ephemeralExpired?' '+"_1xtj":'')+(!this.state.emojis?' '+"_3_om":'')+(!!this.state.emojis?' '+"_31xx":''),this.props.className),ref:'bubble',style:{maxWidth:this.props.maxWidth,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:x.length>=15?'break-word':'inherit'}}),this._renderProgressBar(),q.createElement('div',{className:"_4gx_",ref:'inner'},this._renderContent(),this.props.attachments)));},_renderContent:function(){if(!this.props.body||this.props.isEmojiLike)return null;if(this.state.emojis){var x=k.getSourceURIs(this.state.emojis),y=q.createElement(l,{sourceURIs:x});}else y=q.createElement(n,{body:this.props.body,ranges:this.props.ranges,threadID:this.props.threadID,customLike:this.props.customLike});return (q.createElement('div',{className:"_d97"+(!!this.state.emojis?' '+"_31xy":''),ref:'contentWrapper'},q.createElement('span',{className:"_5yl5",ref:'content'},y)));},_isEpehmeralStylePreferred:function(){if(!this.props.ttl)return false;if(!this.props.attachments)return true;return this.props.attachments.props.attachments.every(function(x){return m.isEphemeralTextStyle(x);});},_onProgressBarAnimationDone:function(){if(this.isMounted()){this.setState({ephemeralExpiring:true});new h(this.refs.inner).to('opacity',0).duration(v).go();}},_setExpiredAnimation:function(){if(this.isMounted()){this.setState({ephemeralExpiring:true});this.setState({ephemeralExpired:true});}},_renderProgressBar:function(){if(!this.props.timestamp||!this.props.ttl||!this._isEpehmeralStylePreferred()||this.state.emojis&&this.state.emojis.length>0)return null;return (q.createElement(i,{ttl:this.props.ttl,timestamp:this.props.timestamp,isMessageAuthor:this.props.isMessageAuthor,onDone:this._onProgressBarAnimationDone,setExpiredAnimation:this._setExpiredAnimation}));},contentWraps:function(){var x=r.findDOMNode(this.refs.content),y=x.getClientRects(),z=j.getElementDimensions(x).height;return y&&y.length>1&&y[0].height<z;},getBoxWidth:function(){if(!this._boxWidth)this._boxWidth=j.measureElementBox(r.findDOMNode(this.refs.bubble),'width',true,true,false);return this._boxWidth;}});f.exports=w;},null);
__d('ChatMessage.react',['BootloadedComponent.react','ChatAnimatedGifs','ChatAttachmentProgressBar.react','ChatBubble.react','EmojiLikeUtils','MercuryTimestamp','CSS','CurrentUser','ImmutableObject','JSResource','MercuryAttachment','MercuryAttachmentType','MercuryErrorInfo','MercuryIDs','MercuryMessageError.react','MercuryMessageInfo','MercuryThreads','MercuryDisplayTimeFilterMessageRenderer','React','ReactDOM','XUISpinner.react','cx','fbt','isRTL','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){'use strict';if(c.__markCompiled)c.__markCompiled();var ga=z.PropTypes,ha=z.createClass({displayName:'ChatMessage',propTypes:{message:ga.instanceOf(p).isRequired,maxBubbleWidth:ga.number.isRequired,onAttachmentLoad:ga.func,onStickerClick:ga.func},componentDidMount:function(){n.conditionClass(aa.findDOMNode(this),"_2cnu",this.isOneLine());},isOneLine:function(){var ia=this.props.message;return (w.isInbound(ia)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps());},shouldComponentUpdate:function(ia,ja){return ia.message!==this.props.message;},render:function(){var ia=this.props.message,ja=r.get(ia).length>0,ka=w.isInbound(ia),la=u.isGroupChat(ia.thread_id),ma=ea(ia.body),na=t.hasErrorStatus(ia),oa="_5wd4"+(ka?' '+"_1nc7":'')+(!ka?' '+"_1nc6":'')+(ja?' '+"_2_-t":'')+(ka&&la?' '+"_5ysy":'')+(na?' '+"_1zcs":'')+(ma?' '+"direction_rtl":'')+(!ma?' '+"direction_ltr":'');return (z.createElement('div',{className:fa(this.props.className,oa)},this._renderInner(),this._renderUndertext()));},_renderInner:function(){var ia=this.props.message,ja={};if(w.isOutbound(ia)){ja['data-hover']='tooltip';ja['data-tooltip-position']='right';ja['aria-label']=da._("{time}",[da.param('time',m.getPreciseTimestamp(ia.timestamp))]);}if(ia.is_filtered_content)return (z.createElement('div',babelHelpers._extends({className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:'inner'},ja),y.renderFilteredContent(ia)));return (z.createElement('div',babelHelpers._extends({className:"_5wd9",ref:'inner'},ja),this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (z.createElement('div',{className:"_3ry4",ref:'undertext'},z.createElement(v,{className:"_5wda clearfix",message:this.props.message,ref:'status'}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?z.createElement(h,{bootloadPlaceholder:z.createElement('span',null),bootloadLoader:q('MercurySpoofWarning.react'),authorID:this.props.message.author,className:"_5wdb"}):null);},_getAttachmentPlaceholder:function(){return (z.createElement('div',{style:{padding:'20px',text_align:'center'}},z.createElement(ba,null)));},_renderProgressBar:function(){var ia=this.props.message;if(!ia.ephemeral_ttl_mode||!ia.timestamp)return null;return (z.createElement(j,{ephemeralTTLMode:ia.ephemeral_ttl_mode,timestamp:ia.timestamp,isMessageAuthor:!w.isInbound(ia)}));},_renderAttachments:function(ia){var ja=this.props.message,ka=x.getForFBID(o.getID()).getThreadMetaNow(ja.thread_id),la=ka?ka.custom_like_icon:null,ma=ia=='inside'?'attachmentsInside':'attachmentsOutside',na=r.get(ja).filter(function(pa){var qa=r.isBubblePreferred(pa);return qa&&ia==='inside'||!qa&&ia==='outside';}),oa=ja.attachments.length>0&&ja.attachments.every(function(pa){return r.isEphemeralAttachmentStyle(pa);});if(na.length>0)return (z.createElement(h,{bootloadPlaceholder:this._getAttachmentPlaceholder(),bootloadLoader:q('MercuryAttachments.react'),className:(ia==='outside'?"_3e7u":'')+(!!ja.body?' '+"_16ys":'')+(!!ja.ephemeral_ttl_mode?' '+"_3-rb":'')+(' '+"_n4o"),attachments:na,customLike:la,isChat:true,maxWidth:this.props.maxBubbleWidth,message:ja,renderProgressBar:oa?this._renderProgressBar:null,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:ma}));},_renderBubble:function(){var ia=this.props.message,ja=ia.body,ka=this._renderAttachments('inside'),la=w.isInbound(ia);if(i.shouldHideBody(ia))ja='';if(ja||ka)return (z.createElement('div',{className:"_5wde _n4o"},z.createElement(k,{attachments:ka,body:ja,className:"_5wdf",isMessageAuthor:!la,maxWidth:this.props.maxBubbleWidth,ranges:ia.ranges,ref:'bubble',isEmojiLike:l.isEmojiLike(ia),threadID:ia.thread_id,ttl:ia.ephemeral_ttl_mode,timestamp:ia.timestamp,customLike:ia.customLike})));}});f.exports=ha;},null);
__d('ChatMessageGroup.react',['ChatConfig','ChatDateBreak.react','ChatMessage.react','Image.react','immutable','ImmutableObject','MercuryIDs','MercuryParticipants','MercuryTimestamp','React','StoreAndPropBasedStateMixin','cx','fbt','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';if(c.__markCompiled)c.__markCompiled();var u=c('MercuryThreads').get(),v=q.PropTypes,w=new m({name:'',href:'#',image_src:''}),x=h.get('chattab_rounded_profile',false),y=q.createClass({displayName:'ChatMessageGroup',mixins:[r(o)],propTypes:{activeMessageID:v.string,author:v.string,hasDateBreak:v.bool,isCanonical:v.bool,isFromViewer:v.bool,isPageMessage:v.bool,maxBubbleWidth:v.number,messages:v.instanceOf(l.List).isRequired,onAttachmentLoad:v.func,onStickerClick:v.func,threadID:v.string},statics:{calculateState:function(aa){return {participants:z(aa)};}},shouldComponentUpdate:function(aa,ba){return (this.props.activeMessageID!==aa.activeMessageID||this.props.isFromViewer!==aa.isFromViewer||!l.is(this.props.messages,aa.messages)||!l.is(this.state.participants,ba.participants));},render:function(){return (q.createElement('div',{className:"_4tdt"},this._renderProfileColumn(),this._renderName(),q.createElement('div',{className:"_4tdv"},this._renderMessages())));},_renderProfileColumn:function(){if(this.props.isFromViewer)return null;var aa=this.state.participants.get(this.props.author)||w,ba=t._("{name} {time}",[t.param('name',aa.name),t.param('time',p.getPreciseTimestamp(this.props.messages.last().timestamp))]),ca=aa.image_src?q.createElement(k,{src:aa.image_src}):null;return (q.createElement('div',{className:"_31o4"+(x?' '+"_3njy":'')},q.createElement('a',{'aria-label':ba,className:"_4tdw",'data-hover':'tooltip','data-tooltip-position':'left',href:aa.href,ref:'link'},ca)));},_renderName:function(){if(this.props.isCanonical||this.props.isFromViewer)return null;var aa=this.state.participants.get(this.props.messages.first().author);if(!aa)return null;var ba=u.getThreadMetaNow(this.props.threadID),ca=aa.short_name;if(ba&&ba.custom_nickname){var da=n.getUserIDFromParticipantID(aa.id);if(ba.custom_nickname[da])ca=ba.custom_nickname[da];}return (q.createElement('div',{className:"_4tdx"},ca));},_renderMessages:function(){var aa=this.props.messages.size,ba=[];this.props.messages.forEach((function(ca,da,ea){var fa=ca.message_id===this.props.activeMessageID;if(fa&&!(da===0&&this.props.hasDateBreak))ba.push(q.createElement(i,{date:new Date(ca.timestamp),key:'db:'+ca.message_id}));ba.push(q.createElement(j,{isFromViewer:this.props.isFromViewer,key:ca.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:ca,nextTimestamp:this._getNextTimestamp(ea,aa,da),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick}));}).bind(this));return ba;},_getNextTimestamp:function(aa,ba,ca){return ca<ba-1?aa.get(ca+1).timestamp:this.props.nextTimestamp;}});function z(aa){return l.Map().withMutations(function(ba){aa.readReceipts.forEach(function(ca,da){ba.set(da,o.getOrFetch(da));});ba.set(aa.author,o.getOrFetch(aa.author));});}f.exports=y;},null);
__d('MercuryLogMessage.react',['DOM','Event','ImmutableObject','MercuryLogMessageRenderer','MercuryLogMessageType','React','ReactDOM','cx','fbt','emptyFunction','formatDate','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';if(c.__markCompiled)c.__markCompiled();var t=m.PropTypes,u=m.createClass({displayName:'MercuryLogMessage',propTypes:{loadMoreMessages:t.func,maxWidth:t.number,message:t.instanceOf(j).isRequired,onImageLoad:t.func},getDefaultProps:function(){return {onImageLoad:q};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},_renderErrorMessage:function(){return (m.createElement('a',{onClick:this._loadMoreMessages},p._("\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f.")));},_loadMoreMessages:function(){var v=this.props.loadMoreMessages&&this.props.loadMoreMessages();if(v){this.setState({messageText:this._renderErrorMessage()});}else{var w=p._("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043d\u0430\u0439\u0442\u0438 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f.");this.setState({messageText:w});}},componentWillReceiveProps:function(v){if(v.message.log_message_type===l.SERVER_ERROR){this._loadMoreMessages();return;}k.renderText(v.message,(function(w){this.setState({messageText:w});}).bind(this));},shouldComponentUpdate:function(v,w){return (this.state.messageText!=w.messageText||v.maxWidth!==this.props.maxWidth);},componentDidUpdate:function(){var v=n.findDOMNode(this.refs.attachment);if(!v)return;k.renderAttachmentLegacy(v,this.props.message);h.scry(v,'img').forEach((function(w){var x=i.listen(w,'load',(function(){this.props.onImageLoad(w);x.remove();}).bind(this));}).bind(this));},render:function(){return (m.createElement('div',babelHelpers._extends({},this.props,{className:s(this.props.className,"_5ye6"),style:babelHelpers._extends({},this.props.style,this._getStyle()),title:r(new Date(this.props.message.timestamp),'g:ia')}),m.createElement('div',{className:"_5ye7"},k.renderIcon(this.props.message),this.state.messageText),m.createElement('div',{className:"_5ye8",ref:'attachment'})));},_getStyle:function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null;}});f.exports=u;},null);
__d('MessengerDomIDs',['uniqueID'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i={COMPOSER_INPUT_DESCRIPTION:h(),CONVERSATION:h(),MAIN_LABEL:h(),MUTE_DIALOG_TITLE:h(),THREAD_INFO_PANEL:h(),THREAD_TITLE:h()};f.exports=i;},null);
__d('MessageList.react',['immutable','ImmutableObject','MercuryActionType','MercuryIDs','MercuryMessageGroup','MercuryShareAttachmentRenderLocations','MessengerDomIDs','ReactComponentWithPureRenderMixin','React','ReactDOM','FBRTCExperiment','MercuryLogMessageType','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){'use strict';if(c.__markCompiled)c.__markCompiled();var u=p.PropTypes,v=1000*60*60,w=p.createClass({displayName:'MessageList',mixins:[o],propTypes:{DateBreak:u.func.isRequired,deliveryTimestamp:u.number.isRequired,isCanonical:u.bool,isPageMessage:u.bool,location:u.string.isRequired,LogMessage:u.func.isRequired,loadMoreMessages:u.func,MessageGroup:u.func.isRequired,messages:u.instanceOf(h.List).isRequired,onAttachmentLoad:u.func,onStickerClick:u.func,readReceipts:u.instanceOf(h.OrderedMap).isRequired,viewer:u.string.isRequired,thread:u.object,threadID:u.string},getInitialState:function(){return {activeMessageID:null,messageGroups:l.calculateMessageGroups(this.props.messages,this.props.location)};},componentWillReceiveProps:function(ca){if(ca.messages!==this.props.messages)this.setState({messageGroups:l.calculateMessageGroups(ca.messages,ca.location)});},render:function(){var ca=this.props,da=ca.DateBreak,ea=ca.location,fa=ca.MessageGroup,ga=[],ha=this.state.activeMessageID,ia=this.state.messageGroups,ja=ia.length,ka=this.props.readReceipts,la=ka.last()||0,ma=k.getParticipantIDFromUserID(this.props.viewer);for(var na=0;na<ja;na++){var oa=na>0?ia[na-1]:null,pa=oa&&oa.length>0?oa[oa.length-1]:null,qa=ia[na],ra=qa[0],sa=qa[qa.length-1],ta=false;if(!pa||ra.timestamp-pa.timestamp>v){ta=true;ga.push(p.createElement(da,{date:new Date(ra.timestamp),key:'db:'+ra.message_id,ref:'db:'+ra.message_id}));}if(ra.action_type==j.LOG_MESSAGE){if((ea===m.CHAT||ea===m.MESSENGER)&&(ra.log_message_type===s.VIDEO_CALL||ra.log_message_type===s.PHONE_CALL)){var ua=r.gen('rtc_www_xmas'),va=ua.getParam('show_xmas','0');if(va==='1'){var wa=this._createRTCMessageGroup(ra,ma,ia,ja,na,ka,la,sa);ga.push(wa);}else{var xa=this._createLogMessageGroup(ra);ga.push(xa);}}else{var ya=this._createLogMessageGroup(ra);ga.push(ya);}continue;}qa=h.List(qa);var za=y(ia,ja,na),ab=!aa(ka,qa,za),bb=z(la,sa),cb=ba(this.props.deliveryTimestamp,sa);ga.push(p.createElement(fa,{activeMessageID:x(ha,qa),author:qa.first().author,deliveryTimestamp:cb,hasDateBreak:ta,isCanonical:this.props.isCanonical,isFromViewer:ma===ra.author,isPageMessage:this.props.isPageMessage,key:'mg:'+ra.message_id,lastReadTimestamp:bb,maxBubbleWidth:this.props.maxBubbleWidth,messages:qa,nextTimestamp:za,onAttachmentLoad:this.props.onAttachmentLoad,onMessageDeselect:this._handleMessageDeselect,onMessageSelect:this._handleMessageSelect,onStickerClick:this.props.onStickerClick,readReceipts:ab?ka:h.OrderedMap(),ref:'mg:'+ra.message_id,thread:this.props.thread,threadID:this.props.threadID}));}return (p.createElement('div',{id:ea===m.MESSENGER?n.CONVERSATION:null},ga));},getMessageElement:function(ca,da){if(da){var ea=this.refs['db:'+ca];if(ea)return q.findDOMNode(ea);}var fa=this.state.messageGroups.find(function(ia){return ia.some(function(ja){return ja.message_id===ca;});});if(!fa)return null;var ga=fa[0].message_id,ha=this.refs['mg:'+ga];if(!ha)return null;if(da&&ga===ca)return q.findDOMNode(ha);return ha.getMessageElement(ca);},_handleMessageDeselect:function(ca){this.setState(function(da){return {activeMessageID:da.activeMessageID===ca?null:da.activeMessageID};});},_handleMessageSelect:function(ca){this.setState({activeMessageID:ca});},_createRTCMessageGroup:function(ca,da,ea,fa,ga,ha,ia,ja){var ka=this.props.MessageGroup,la={attach_type:'share',share:{style_list:['rtc_call_log','fallback'],log_message_body:ca.log_message_body,log_message_data:ca.log_message_data,log_message_type:ca.log_message_type,timestamp:ca.timestamp}},ma=i.setProperty(ca,'attachments',[la]);ma=i.setProperty(ma,'body','');var na=h.List([ma]),oa=y(ea,fa,ga),pa=!aa(ha,na,oa),qa=z(ia,ja),ra=ba(this.props.deliveryTimestamp,ja);return (p.createElement(ka,{author:na.first().author,deliveryTimestamp:ra,isFromViewer:da===ca.author,key:ca.message_id,lastReadTimestamp:qa,maxBubbleWidth:this.props.maxBubbleWidth,messages:na,nextTimestamp:oa,onAttachmentLoad:this.props.onAttachmentLoad,onMessageDeselect:this._handleMessageDeselect,onMessageSelect:this._handleMessageSelect,onStickerClick:this.props.onStickerClick,readReceipts:pa?ha:h.OrderedMap(),thread:this.props.thread,threadID:this.props.threadID}));},_createLogMessageGroup:function(ca){var da=this.props.LogMessage;return (p.createElement(da,{className:this.props.location===m.CHAT?"_5w0o":null,key:ca.message_id,loadMoreMessages:this.props.loadMoreMessages,message:ca,onImageLoad:this.props.onAttachmentLoad,viewer:this.props.viewer}));}});function x(ca,da){return da.find(function(ea){return ea.message_id===ca;})?ca:null;}function y(ca,da,ea){return ea<da-1?ca[ea+1][0].timestamp:Infinity;}function z(ca,da){return da.timestamp>ca?ca:Infinity;}function aa(ca,da,ea){return (da.isEmpty()||ca.last()<da.first().timestamp||ca.first()>=ea);}function ba(ca,da){return da.timestamp>ca?ca:Infinity;}f.exports=w;},null);
__d('ChatConversation.react',['ChatDateBreak.react','ChatMessageGroup.react','ChatMessage.react','immutable','MercuryActionType','MercuryLogMessage.react','MessageList.react','React','MercuryShareAttachmentRenderLocations','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){'use strict';if(c.__markCompiled)c.__markCompiled();var r=o.PropTypes,s=o.createClass({displayName:'ChatConversation',propTypes:{contextBanner:r.object,isCanonical:r.bool.isRequired,loadMoreMessages:r.func,maxBubbleWidth:r.number.isRequired,messages:r.instanceOf(k.List).isRequired,onAttachmentLoad:r.func,onStickerClick:r.func,viewer:r.string.isRequired,threadID:r.string},componentWillReceiveProps:function(t){!(t.maxBubbleWidth===this.props.maxBubbleWidth)?q(0):undefined;},render:function(){return (o.createElement('div',null,this.props.contextBanner,o.createElement(n,{DateBreak:h,LogMessage:m,MessageGroup:i,deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:p.CHAT,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,readReceipts:k.OrderedMap(),viewer:this.props.viewer,threadID:this.props.threadID})));}});f.exports=s;},null);
__d('MercuryTypingAnimation.react',['React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=h.PropTypes,l=h.createClass({displayName:'MercuryTypingAnimation',propTypes:{color:k.oneOf(['light','dark'])},getDefaultProps:function(){return {color:'dark'};},render:function(){var m="_4a0v"+(this.props.color==='light'?' '+"_4a0w":'')+(this.props.color==='dark'?' '+"_4a0x":'');return (h.createElement('div',{className:j(this.props.className,m)},h.createElement('div',{className:"_4b0g"},h.createElement('div',{className:"_5pd7"}),h.createElement('div',{className:"_5pd7"}),h.createElement('div',{className:"_5pd7"}))));}});f.exports=l;},null);
__d('ChatTypingIndicator.react',['ChatConfig','Image.react','MercuryParticipants','MercuryTypingAnimation.react','ReactComponentWithPureRenderMixin','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=m.PropTypes,q=h.get('chattab_rounded_profile',false),r=m.createClass({displayName:'ChatTypingIndicator',mixins:[l],propTypes:{userID:p.string,showName:p.bool},render:function(){var t=undefined;if(this.props.userID)t=j.getNow(this.props.userID);if(!t)return null;return (m.createElement('div',{className:"_4tdt"},s(t),this._renderBubble()));},getBubble:function(){return this.refs.bubble;},_renderBubble:function(){var t=this.props.showName;return (m.createElement('div',{className:"_4tdv"},m.createElement('div',{className:"_5wd4"+(' '+"_1nc7")+(' '+"_2cnu")+(t?' '+"_5ysy":'')},m.createElement('div',{className:"_5wd9"+(' '+"_n4o")},m.createElement('div',{className:"_5w1r"+(' '+"_5wdf")+(' '+"_3_om")},m.createElement(k,{className:"_5x7x",ref:'bubble'}))))));}});function s(t){var u=o._("{name}",[o.param('name',t.name)]);return (m.createElement('div',{className:"_31o4"+(q?' '+"_3njy":'')},m.createElement('a',{'aria-label':u,className:"_4tdw",'data-hover':'tooltip','data-tooltip-position':'left',href:t.href||'#',ref:'link'},m.createElement(i,{src:t.image_src,ref:'image'}))));}f.exports=r;},null);
__d('ChatTypingIndicators.react',['ChatTypingIndicator.react','DOM','MercuryIDs','MercuryThreadInformer','MercuryTypingReceiver','MercuryParticipants','React','ReactDOM','SubscriptionsHandler','TooltipData','createObjectFrom','emptyFunction','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=n.PropTypes,v=n.createClass({displayName:'ChatTypingIndicators',propTypes:{indicatorClass:u.func,indicatorsWillShow:u.func,indicatorsDidShow:u.func,rootClassName:u.string,threadID:u.string.isRequired,viewer:u.string.isRequired},getDefaultProps:function(){return {indicatorClass:h,indicatorsWillShow:s,indicatorsDidShow:s};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){var w=k.getForFBID(this.props.viewer),x=l.getForFBID(this.props.viewer);this._subscriptions=new p();this._subscriptions.addSubscriptions(x.addRetroactiveListener('state-changed',this.typingStateChanged),w.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(w){if(w.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(w,x){if(x.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();m.getMulti(this.state.typingUserIDs,(function(w){if(this.isMounted())this.state.typingUserIDs.forEach((function(x){var y=w[x],z=this.refs[x]&&this.refs[x].getBubble();if(z&&y)q.set(o.findDOMNode(z),this.renderTooltip(y.short_name),'above','left');}).bind(this));}).bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var w=j.isGroupChat(this.props.threadID);return (n.createElement('div',{className:this.props.rootClassName},this.state.typingUserIDs.map((function(x){return (this._renderTypingIndicator(x,!!w));}).bind(this))));},_renderTypingIndicator:function(w,x){var y=this.props.indicatorClass;return (n.createElement(y,{key:w,ref:w,showName:x,userID:w}));},renderTooltip:function(w){var x=i.create('span');o.render(n.createElement('span',null,t._("{name} \u043f\u0435\u0447\u0430\u0442\u0430\u0435\u0442 \u0432\u0430\u043c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",[t.param('name',w)])),x);return x;},typingStateChanged:function(w){if(this.props.threadID in w)this.setState({typingUserIDs:w[this.props.threadID].slice().sort()});},messagesReceived:function(w,x){if(this.props.threadID in x){var y=x[this.props.threadID],z=r(y.map(function(aa){return aa.author;}));this.setState({typingUserIDs:this.state.typingUserIDs.filter(function(aa){return !z[aa];}).sort()});}}});f.exports=v;},null);
__d('MercuryMessageList',['immutable','LogHistory','Map','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=i.getInstance('mercury_message_list');function m(o){this.$MercuryMessageList1=h.List(o||[]);this.$MercuryMessageList2();}m.prototype.append=function(o){var p;this.$MercuryMessageList1=(p=this.$MercuryMessageList1).push.apply(p,o);this.$MercuryMessageList2();n('append',o);};m.prototype.prepend=function(o){var p;this.$MercuryMessageList1=(p=this.$MercuryMessageList1).unshift.apply(p,o);this.$MercuryMessageList2();n('prepend',o);};m.prototype.update=function(o){var p=o.filter((function(q){return this.contains(q);}).bind(this));if(p.length===0)return;this.$MercuryMessageList1=this.$MercuryMessageList1.withMutations((function(q){p.forEach((function(r){var s=this.$MercuryMessageList3.get(r.message_id);if(s!==undefined)q.set(s,r);}).bind(this));}).bind(this));n('update',p);};m.prototype.reorder=function(o){this.$MercuryMessageList1=h.List(o);this.$MercuryMessageList2();n('reorder',o);};m.prototype.at=function(o){return this.$MercuryMessageList1.get(o);};m.prototype.contains=function(o){return this.$MercuryMessageList3.has(o.message_id);};m.prototype.toArray=function(){return this.$MercuryMessageList1.toArray();};m.prototype.toMap=function(){return new j(h.Seq(this.$MercuryMessageList1).map(function(o){return [o.message_id,o];}));};m.prototype.$MercuryMessageList2=function(){this.$MercuryMessageList3=new j(h.Seq(this.$MercuryMessageList1).map(function(o,p){return [o.message_id,p];}));};function n(event,o){k(function(){l.debug(event,JSON.stringify({messageIDs:o.map(function(p){return p.message_id;})}));},0);}f.exports=m;},null);
__d('MercuryMessageStore',['MercuryAPIArgsSource','LogHistory','MercuryMessages','MercuryViewer','MercuryMessageList','SubscriptionsHandler','MercuryThreadInformer','MercuryThreadlistConstants','mixInEventEmitter','setImmediate','setTimeoutAcrossTransitions','MercuryThreads'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){'use strict';if(c.__markCompiled)c.__markCompiled();var s=c('MercuryThreads').get(),t=i.getInstance('mercury_message_store');function u(w,x,y){this.$MercuryMessageStore1=w;this.$MercuryMessageStore2=new l();this.$MercuryMessageStore3=y?j.getForFBID(y):j.get();this.$MercuryMessageStore4=1;this.$MercuryMessageStore5=null;this.$MercuryMessageStore6=0;this.$MercuryMessageStore7=x||o.RECENT_MESSAGES_LIMIT;this.$MercuryMessageStore8=y?n.getForFBID(y):n.get();this.$MercuryMessageStore9=new m();this.$MercuryMessageStore9.addSubscriptions(this.$MercuryMessageStore8.subscribe('messages-received',(function(z,aa){return this.$MercuryMessageStore10(aa);}).bind(this)),this.$MercuryMessageStore8.subscribe('messages-updated',(function(z,aa){return aa[this.$MercuryMessageStore1]&&this.$MercuryMessageStore11(aa[this.$MercuryMessageStore1]);}).bind(this)),this.$MercuryMessageStore8.subscribe('messages-reordered',(function(z,aa){return aa[this.$MercuryMessageStore1]&&this.$MercuryMessageStore12();}).bind(this)));t.debug('constructed',JSON.stringify({threadID:this.$MercuryMessageStore1}));this.$MercuryMessageStore13();}u.prototype.setNewThreadID=function(w){this.$MercuryMessageStore14=w;};u.prototype.destroy=function(){this.$MercuryMessageStore9&&this.$MercuryMessageStore9.release();t.debug('destroyed',JSON.stringify({threadID:this.$MercuryMessageStore1}));};u.prototype.subscribe=function(w){return this.addRetroactiveListener('updated',w);};u.prototype.fetchMoreMessages=function(){if(this.hasFetchedAll())return false;this.$MercuryMessageStore13();return true;};u.prototype.hasFetchedAll=function(){if(this.$MercuryMessageStore3.hasLoadedExactlyNMessages(this.$MercuryMessageStore1,this.$MercuryMessageStore6)&&this.$MercuryMessageStore3.hasLoadedAllMessages(this.$MercuryMessageStore1))return true;return s.isNewEmptyLocalThread(this.$MercuryMessageStore1);};u.prototype.$MercuryMessageStore13=function(){var w=this.$MercuryMessageStore6+this.$MercuryMessageStore7*this.$MercuryMessageStore4;t.debug('fetching',JSON.stringify({threadID:this.$MercuryMessageStore1,limit:w}));this.$MercuryMessageStore3.getThreadMessagesRange(this.$MercuryMessageStore1,0,w,this.$MercuryMessageStore15.bind(this),null,h.MERCURY);if(this.$MercuryMessageStore4<10)this.$MercuryMessageStore4+=1;if(this.$MercuryMessageStore3.hasLoadedNMessages(this.$MercuryMessageStore1,w))q((function(){this.$MercuryMessageStore12();}).bind(this));};u.prototype.$MercuryMessageStore15=function(w){if(w&&w.length){this.$MercuryMessageStore5=w[0].timestamp;this.$MercuryMessageStore6=w.length;t.debug('fetched',JSON.stringify({threadID:this.$MercuryMessageStore1,earliestMessageTimestamp:this.$MercuryMessageStore5,count:this.$MercuryMessageStore6}));}else if(w&&!w.length&&!this.$MercuryMessageStore6)this.$MercuryMessageStore16(u.THREAD_IS_EMPTY);};u.prototype.$MercuryMessageStore10=function(w){var x=[],y=w[this.$MercuryMessageStore1];if(y&&y.length)x=x.concat(y);if(this.$MercuryMessageStore14){var z=w[this.$MercuryMessageStore14];if(z&&z.length){x=x.concat(z);this.$MercuryMessageStore14=null;}}if(x.length){this.$MercuryMessageStore2.append(x);this.$MercuryMessageStore6+=x.length;var aa=x.every(function(ba){return ba.author!=k.getID();});this.$MercuryMessageStore16(u.MESSAGES_RECEIVED,{allFromOthers:aa});}};u.prototype.$MercuryMessageStore11=function(w){this.$MercuryMessageStore2.update(this.$MercuryMessageStore3.getMessagesFromIDs(Object.keys(w)));this.$MercuryMessageStore17();this.$MercuryMessageStore16(u.MESSAGES_CHANGED);};u.prototype.$MercuryMessageStore12=function(){if(!this.$MercuryMessageStore5)return;this.$MercuryMessageStore2.reorder(this.$MercuryMessageStore3.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore1,this.$MercuryMessageStore5));this.$MercuryMessageStore17();this.$MercuryMessageStore16(u.MESSAGES_REORDERED);};u.prototype.$MercuryMessageStore16=function(w,x){var y=this.$MercuryMessageStore2.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',babelHelpers._extends({messages:y,eventType:w},x));v(this.$MercuryMessageStore1,w,y);};u.prototype.$MercuryMessageStore17=function(){var w=this.$MercuryMessageStore2.at(0);if(w)this.$MercuryMessageStore5=w.timestamp;};function v(w,x,y){r(function(){t.debug('update:'+x,JSON.stringify({threadID:w,messageIDs:y.map(function(z){return z.message_id;})}));},0);}Object.assign(u,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered',THREAD_IS_EMPTY:'thread-is-empty'});p(u,{updated:true});f.exports=u;},null);
__d('ChatTabMessagesView',['Animation','Arbiter','BanzaiLogger','CSS','ChatConversation.react','ChatPerfInstrumentation','ChatTabViewEvents','ChatTypingIndicators.react','ChatWelcomeMessage','CurrentUser','DOM','Event','immutable','MercuryLastMessageIndicator.react','LiveTimer','MercuryIDs','MercuryViewer','MercuryMessageStore','MessengerContextBannerBootloader','MessengerHotLikePreviewEvents','React','ReactDOM','ReactComponentRenderer','MercuryShareAttachmentRenderLocations','Scroll','ServerTime','StickerActions','StickerState','StickerStoreController','Style','SubscriptionsHandler','UserAgent_DEPRECATED','arrayContains','getElementPosition','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa){'use strict';if(c.__markCompiled)c.__markCompiled();var qa=64,ra=null,sa=20;function ta(va){if(ra===null){var wa=va.childNodes[0];ka.set(va,'overflow','scroll');ra=wa.clientWidth-qa;ka.set(va,'overflow','');}return ra;}function ua(va,wa,xa,ya,za,ab,bb,cb,db){this.loadingIcon=za;this.threadID=va;this.sheetController=wa;this.scrollContainer=xa;this.conversationElem=ya;this.contextBannerEligible=db;this.contextBannerElem=null;this.tabView=cb;v.restart(ga.get()/1000);this._loadingMoreMessages=false;this._initialLoadFinished=false;function eb(){n.inform('interaction-with-tab',va);}this._subscriptions=new la();this._subscriptions.addSubscriptions(i.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),s.listen(this.scrollContainer,'mousedown',eb));if(ma.firefox()){var fb='WheelEvent' in window?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(fb,eb,false);}else this._subscriptions.addSubscriptions(s.listen(this.scrollContainer,'mousewheel',eb));this._subscriptions.addSubscriptions(s.listen(this.scrollContainer,'scroll',pa(this.scrolling,50,this)));var gb;ca.render(ba.createElement(o,{threadID:this.threadID,indicatorsWillShow:(function(){return (gb=this.isScrolledToBottom());}).bind(this),indicatorsDidShow:(function(){return (gb&&this.scrollToBottom(true));}).bind(this),viewer:q.getID()}),bb);var hb;this.lastMessageIndicatorNode=ab;this.lastMessageIndicator=new da(u,this.lastMessageIndicatorNode);this.lastMessageIndicator.setProps({threadID:this.threadID,hideTyping:true,indicatorWillShow:(function(){return hb=this.isScrolledToBottom();}).bind(this),indicatorDidShow:(function(){return hb&&this.scrollToBottom(true);}).bind(this)});this.initializeConversation();}Object.assign(ua.prototype,{initializeConversation:function(){this._store=new y(this.threadID);this._conversation=new da(l,this.conversationElem);this._conversation.setProps({isCanonical:w.isCanonical(this.threadID),loadMoreMessages:this._loadMoreMessages.bind(this),maxBubbleWidth:ta(this.scrollContainer),messages:t.List(),onAttachmentLoad:(function(va){var wa=this.scrollContainer,xa=fa.getTop(wa)+wa.clientHeight;if(xa+va+sa>=wa.scrollHeight)this.scrollToBottom();}).bind(this),onStickerClick:this._onStickerClick.bind(this),viewer:q.getID(),threadID:this.threadID});this._subscriptions.addSubscriptions(this._store.subscribe(this._updateMessageFromStore.bind(this)),aa.addListener(aa.START,(function(va,wa){if(this.threadID!==wa)return;this._likePreview=va;this._conversation.setProps({messages:this._getNormalizedMessages()},this.scrollToBottom.bind(this));this.scrollToBottom();clearInterval(this._scrollToBottomInterval);this._scrollToBottomInterval=setInterval(this.scrollToBottom.bind(this),50);}).bind(this)),aa.addListener(aa.STOP,(function(va){if(this.threadID!==va)return;this._likePreview=null;}).bind(this)),aa.addListener(aa.FINISH_ANIMATION,(function(va){clearInterval(this._scrollToBottomInterval);}).bind(this)),aa.addListener(aa.REMOVE,(function(va){if(this.threadID!==va)return;clearInterval(this._scrollToBottomInterval);this._likePreview=null;this._conversation.setProps({messages:this._getNormalizedMessages()});}).bind(this)));},_updateMessageFromStore:function(va){if(va.eventType==y.MESSAGES_RECEIVED&&va.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(va.eventType==y.MESSAGES_REORDERED){this._loadingMoreMessages=false;k.hide(this.loadingIcon);}var wa=this.isScrolledToBottom(),xa=this._getLoadingHeight(),ya=this.scrollContainer.scrollHeight,za=fa.getTop(this.scrollContainer);this._messages=va.messages;var ab=p.getWelcomeMessage(this.threadID);if(ab)this._messages.push(ab);this._conversation.setProps({messages:this._getNormalizedMessages()},(function(){if(wa||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(va.eventType==y.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-ya-xa+za);if(!this._initialLoadFinished){this._initialLoadFinished=true;m.logCHAT_CONVERSATION_TTI();}if(this._store.hasFetchedAll()&&this.contextBannerEligible)this.renderContextBanner(this.threadID);}).bind(this));this.lastMessageIndicator.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(va.eventType==y.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(this._messages)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();if(va.eventType==y.MESSAGES_CHANGED)this._checkToAnimateSticker();},setShouldScrollToBottom:function(va){this._shouldScrollToBottom=va;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){k.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&fa.getTop(this.scrollContainer);},getThreadID:function(){return this.threadID;},destroy:function(){r.scry(this.conversationElem,'.stickerContainer').forEach(function(va){return ca.unmountComponentAtNode(va);});this.unmountContextBanner();ca.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();ca.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(va){if(!ia.shouldShowStickerReplyNUX()||!va.length)return false;var wa=va[va.length-1];if(wa.author===x.getID())return false;if(wa.has_attachment)return wa.attachments.some(function(xa){return xa.attach_type==='sticker';});return false;},isScrolledToBottom:function(va){var wa=this.scrollContainer;va=va||sa;return fa.getTop(wa)+wa.clientHeight>=wa.scrollHeight-va;},isScrolledNearTop:function(){return fa.getTop(this.scrollContainer)<this.scrollContainer.clientHeight;},scrollToBottom:function(va){this.scrollToPosition(this.scrollContainer.scrollHeight,va);},scrollToPosition:function(va,wa){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(wa===true){this._scrollTopAnimation=new h(this.scrollContainer).to('scrollTop',va).ease(h.ease.end).duration(400).go();}else fa.setTop(this.scrollContainer,va);},_loadMoreMessages:function(){return this._store.fetchMoreMessages();},_onStickerClick:function(va,wa){if(!va)return;j.log('StickersLoggerConfig',{event:'click_sticker',packid:va,stickerid:wa});var xa=this.tabView;ia.onTrayDataReady(function(){if(na(ia.getPackIDsInTray(),va)){var ya=ia.getPack(va);if(ya&&ya.isPromoted)ha.addPack(va);xa.setStickersFlyoutPackID(va);}else ja.showStore(va);});},_checkToAnimateSticker:function(){var va=oa(this.scrollContainer);i.inform('chatScrolled/'+this.threadID,{scrollTop:fa.getTop(this.scrollContainer),top:va.y,viewHeight:va.height});},setNewThreadID:function(va){this._store.setNewThreadID(va);},_getNormalizedMessages:function(){if(this._likePreview){this._messages.push(this._likePreview);}else this._messages=this._messages.filter(function(va){return !va.is_like_preview;});return t.List(this._messages);},renderContextBanner:function(va,wa){z.getBootloadedComponent(va,ea.CHAT,(function(xa){ka.set(this.conversationElem,'padding-top','80px');this._conversation.setProps({contextBanner:xa});}).bind(this),wa,(function(xa){ka.set(this.conversationElem,'padding-top',xa+'px');}).bind(this));},unmountContextBanner:function(){if(this._conversation)this._conversation.setProps({contextBanner:null});}});f.exports=ua;},null);
__d('ChatNubLogger',['BanzaiLogger','ScriptPath','pageID'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k='TimeSpentChatNubLoggerConfig',l={INPUT_ACTIVE:'active',INPUT_INACTIVE:'inactive'},m={ENTER:'enter',LEAVE:'leave'},n=l.INPUT_INACTIVE,o=0,p=false;function q(){if(n==l.INPUT_ACTIVE&&!p){n=l.INPUT_INACTIVE;r(m.LEAVE);o=0;}else if(n==l.INPUT_INACTIVE&&p){n=l.INPUT_ACTIVE;o=Date.now();r(m.ENTER);}}function r(event){var t=h.create({retry:true}),u=Date.now();t.log(k,{event:event,client_event_time_ms:u,active_time_ms:event==m.LEAVE?u-o:0,page_id:j,script_path:i.getScriptPath(),page_data:i.getPageInfo()?i.getPageInfo().extraData:{}});}var s={processEvent:function(t){switch(t){case 'focus':p=true;break;case 'blur':p=false;break;default:break;}q();}};f.exports=s;},null);
__d('ChatPhotoUploader.react',['Promise','Bootloader','Image.react','InlineBlock.react','Link.react','MercuryConfig','React','ReactDOM','SubscriptionsHandler','cx','emptyFunction','fbt','ix','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();var v=n.PropTypes,w=n.createClass({displayName:'ChatPhotoUploader',propTypes:{actionURI:v.string,allowCrossPage:v.bool,customUI:v.bool,disabled:v.bool,imageClassName:v.string,imagesOnly:v.bool,linkClassName:v.string,onSubmit:v.func,onAllUploadsComplete:v.func,onLastUploadFail:v.func,onLastUploadCancel:v.func,onMount:v.func,onUploadError:v.func},getDefaultProps:function(){return {actionURI:m.upload_url,allowCrossPage:true,costomUI:false,disabled:false,imageClassName:"_509w",imagesOnly:true,linkClassName:'',onSubmit:r,onAllUploadsComplete:r,onLastUploadFail:r,onLastUploadCancel:r};},shouldComponentUpdate:function(x,y){return x.actionURI!=this.props.actionURI||x.disabled!==this.props.disabled;},componentDidMount:function(){if(this.props.onMount)this.props.onMount(this);},componentDidUpdate:function(x,y){if(this._uploader)this._uploader.setAllowCrossPage(this.props.allowCrossPage);},componentWillUnmount:function(){if(!this.isUploading()||!this.props.allowCrossPage)this._cleanup();},render:function(){var x=this.props.imagesOnly?s._("\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e"):s._("\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b\u044b"),y=u("_4q61"+(!this.props.customUI?' '+"_5f0v":'')+(!this.props.customUI?' '+"_509v":''),this.props.linkClassName);return (n.createElement('form',{action:this.props.actionURI,className:"_vzk",title:x,method:'post',onClick:(function(z){z.stopPropagation();if(this.props.disabled)z.preventDefault();}).bind(this),ref:'form'},n.createElement('input',{type:'hidden',name:'attach_id',ref:'attachID'}),n.createElement('input',{type:'hidden',name:'images_only',value:this.props.imagesOnly}),n.createElement(k,{onClick:this._bootloadChatAutoSendPhotoUploader,className:u(this.props.className,"_m _4q60 _3rzn")},n.createElement('input',{disabled:this.props.disabled,type:'file',className:"_n _2__f",name:'attachment[]',multiple:'true',accept:this.props.imagesOnly?'image/*':'*',ref:'input',title:x}),n.createElement(l,{className:y,tabIndex:-1},n.createElement('i',{className:this.props.imageClassName,alt:s._("\u041a\u0430\u043c\u0435\u0440\u0430")})))));},_handleSubmit:function(x,y){this.props.onSubmit(x,y);},_handleAllUploadsCompleted:function(x,y){this.props.onAllUploadsComplete(x,y);if(!this.isMounted())this._cleanup();},_handleLastUploadFailed:function(x,y){this.props.onLastUploadFail(x,y);if(!this.isMounted())this._cleanup();},_handleLastUploadCanceled:function(x,y){this.props.onLastUploadCancel(x,y);if(!this.isMounted())this._cleanup();},_handleUploadError:function(x,y){this.props.onUploadError(y);if(!this.isMounted())this._cleanup();},isUploading:function(){return (this._uploader&&this._uploader.isUploading()||this._uploaderPromiseIsResolving);},_bootloadChatAutoSendPhotoUploader:function(){if(!this._uploaderPromise){this._uploaderPromiseIsResolving=true;this._uploaderPromise=new h((function(x){i.loadModules(["ChatAutoSendPhotoUploader"],(function(y){this._uploaderPromiseIsResolving=false;this._uploader=new y(o.findDOMNode(this.refs.form),o.findDOMNode(this.refs.input),o.findDOMNode(this.refs.attachID));this._uploader.setAllowCrossPage(this.props.allowCrossPage);this._subscriptions=new p();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled),this._uploader.subscribe('file-upload-error',this._handleUploadError));x(this._uploader);}).bind(this));}).bind(this));}return this._uploaderPromise;},uploadFiles:function(x){this._bootloadChatAutoSendPhotoUploader().then(function(y){y.uploadFiles(x);});},uploadURL:function(x){this._bootloadChatAutoSendPhotoUploader().then(function(y){y.uploadURL(x);});},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();}});f.exports=w;},null);
__d('ChatTabSheetListener',['ChatPrivacyActionController','MercuryIDs','MercuryParticipants','MercuryThreadInformer','MercuryThreads','MercuryViewer'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();function n(o,p){this.$ChatTabSheetListener1=p;this.$ChatTabSheetListener2=o;this.$ChatTabSheetListener3=i.getUserIDFromThreadID(this.$ChatTabSheetListener2);k.get().subscribe('threads-updated',(function(){return this.$ChatTabSheetListener4();}).bind(this));if(this.$ChatTabSheetListener3)this.$ChatTabSheetListener5=new h(this.$ChatTabSheetListener3,(function(q){return this.$ChatTabSheetListener6(q);}).bind(this));}n.prototype.destroy=function(){this.$ChatTabSheetListener5&&this.$ChatTabSheetListener5.destroy();};n.prototype.$ChatTabSheetListener4=function(){var o=l.get();o.getThreadMeta(this.$ChatTabSheetListener2,(function(p){var q=m.getID(),r=p.participants.filter(function(s){return s!==q;});r.length<1&&!o.isNewEmptyLocalThread(this.$ChatTabSheetListener2)?this.$ChatTabSheetListener1.openNoRecipientsSheet():this.$ChatTabSheetListener1.closeNoRecipientsSheet();}).bind(this));};n.prototype.$ChatTabSheetListener6=function(o){switch(o){case h.OFFLINE:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.openOfflineSheet();break;case h.NORMAL:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.closeOfflineSheet();break;case h.BLOCKED:this.$ChatTabSheetListener1.closeOfflineSheet();j.get(i.getParticipantIDFromUserID(this.$ChatTabSheetListener3),(function(p){p.is_friend?this.$ChatTabSheetListener1.openUserBlockedSheet():this.$ChatTabSheetListener1.closeUserBlockedSheet();}).bind(this));break;}};f.exports=n;},null);
__d('ChatTabSheetController',['Bootloader','ChatTabSheetListener','Deferred','MercuryIDs'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=function(m,n,o,p){this._threadID=m;this._rootElement=n;this._tabElement=o;this._view=p;this._deferred=new j();this._isLoading=false;this._listener=new i(this._threadID,this);};Object.assign(l.prototype,{openAddFriendsSheet:function(){this._load((function(){this._addFriendsTabSheet.open();}).bind(this));},openMessageBlockedTabSheet:function(){this._load((function(){this._threadIsMessageBlockedSheet.open();}).bind(this));},getAddFriendsParticipants:function(){return this._addFriendsTabSheet?this._addFriendsTabSheet.getParticipants():[];},openNameConversationSheet:function(m){this._load((function(){this._nameConversationTabSheet.open(m);}).bind(this));},openReadOnlySheet:function(){this._load((function(){this._readOnlyTabSheet.open();}).bind(this));},openNewMessagesSheet:function(){this._load((function(){this._newMessagesTabSheet.open();}).bind(this));},openUploadWarningTabSheet:function(){this._load((function(){this._uploadWarningTabSheet.open();}).bind(this));},openThreadIsMutedTabSheet:function(){this._load((function(){this._threadIsMutedTabSheet.open();}).bind(this));},openEmployeeAwaySheet:function(){this._load((function(){this._employeeAwaySheet.open();}).bind(this));},openOfflineSheet:function(){this._load((function(){this._offlineTabSheet.open();}).bind(this));},openUserBlockedSheet:function(){this._load((function(){this._userBlockedTabSheet.open();}).bind(this));},openNoRecipientsSheet:function(){this._load((function(){this._noRecipientsTabSheet&&this._noRecipientsTabSheet.open();}).bind(this));},openSecretModeSheet:function(){this._load((function(){this._secretModeSheet.open();}).bind(this));},closeAddFriendsSheet:function(){this._lazy((function(){this._addFriendsTabSheet.close();}).bind(this));},closeAutomaticNameConversationSheet:function(){this._lazy((function(){if(this._nameConversationTabSheet&&this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();}).bind(this));},closeMessageBlockedTabSheet:function(){this._lazy((function(){this._threadIsMessageBlockedSheet.close();}).bind(this));},closeThreadIsMutedTabSheet:function(){this._lazy((function(){this._threadIsMutedTabSheet.close();}).bind(this));},closeNewMessagesSheet:function(){this._lazy((function(){this._newMessagesTabSheet.close();}).bind(this));},closeUploadWarningTabSheet:function(){this._lazy((function(){this._uploadWarningTabSheet.close();}).bind(this));},closeOfflineSheet:function(){this._lazy((function(){this._offlineTabSheet.close();}).bind(this));},closeUserBlockedSheet:function(){this._lazy((function(){this._userBlockedTabSheet.close();}).bind(this));},closeSecretModeSheet:function(){this._lazy((function(){this._secretModeSheet.close();}).bind(this));},onClickMessagesBlockedSheet:function(m){this._lazy((function(){this._unblockMessagesSub=this._threadIsMessageBlockedSheet.subscribe('clicked',m);}).bind(this));},closeNoRecipientsSheet:function(){this._lazy((function(){this._noRecipientsTabSheet&&this._noRecipientsTabSheet.close();}).bind(this));},onClickNewMessagesSheet:function(m){this._lazy((function(){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',m);}).bind(this));},onClickThreadIsMutedSheet:function(m){this._lazy((function(){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',m);}).bind(this));},onClickSecretModeSheet:function(m){this._lazy((function(){this._secretModeClickSub=this._secretModeSheet.subscribe('clicked',m);}).bind(this));},onResize:function(m){this._lazy((function(){this._sheetView.subscribe('resize',m);}).bind(this));},onTokensChanged:function(m){this._lazy((function(){this._addFriendsTabSheet.subscribe('chat/tokens-changed',m);}).bind(this));},onEscape:function(m){this._lazy((function(){this._addFriendsTabSheet.subscribe('esc-pressed',m);}).bind(this));},destroy:function(){this._listener&&this._listener.destroy();this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();},_load:function(m){this._bootload();this._deferred.then(m);},_lazy:function(m){this._deferred.then(m);},_bootload:function(){if(this._isLoading)return;this._isLoading=true;h.loadModules(["ChatAddFriendsTabSheet","ChatEmployeeAwaySheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMessageBlockedSheet","ChatThreadIsMutedTabSheet","ChatThreadSecretModeSheet","ChatUploadWarningTabSheet","ChatUserBlockedTabSheet","MercurySheetView"],(function(m,n,o,p,q,r,s,t,u,v,w,x,y){this._sheetView=new y(this._threadID,this._rootElement,this._tabElement);var z=this._threadID,aa=this._rootElement,ba=this._sheetView,ca=this._view;this._addFriendsTabSheet=new m(z,aa,ba,ca);this._employeeAwaySheet=new n(z,aa,ba);this._nameConversationTabSheet=new o(z,aa,ba);this._newMessagesTabSheet=new p(z,aa,ba);this._offlineTabSheet=new r(z,aa,ba);this._readOnlyTabSheet=new s(z,aa,ba);this._threadIsMessageBlockedSheet=new t(z,aa,ba);this._threadIsMutedTabSheet=new u(z,aa,ba);this._secretModeSheet=new v(z,aa,ba);this._uploadWarningTabSheet=new w(z,aa,ba);this._userBlockedTabSheet=new x(z,aa,ba);if(!k.getUserIDFromThreadID(this._threadID))this._noRecipientsTabSheet=new q(z,aa,ba);this._deferred.resolve();}).bind(this));}});f.exports=l;},null);
__d('ChatTitleLink.react',['Link.react','MercuryThreadTitle.react','React','TrackingNodes','UserAgent','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=j.PropTypes,o=j.createClass({displayName:'ChatTitleLink',propTypes:{href:n.string,isNewThread:n.bool,thread:n.object,viewer:n.string},getDefaultProps:function(){return {href:null};},getTitle:function(){return this.refs.threadTitle.getTitle();},render:function(){if(!this.props.thread)return null;return (j.createElement(h,{'aria-level':'3',className:"titlebarText"+(l.isBrowser('Chrome')&&!l.isPlatform('Windows')?' '+"fixemoji":'')+(this.props.href===null?' '+"noLink":''),'data-ft':k.getTrackingInfo(k.types.TITLE),'data-hover':'tooltip',href:this.props.href},j.createElement(i,{ref:'threadTitle',isNewThread:this.props.isNewThread,thread:this.props.thread,useAndSeparator:true,useShortName:!this.props.thread.is_canonical,viewer:this.props.viewer})));}});f.exports=o;},null);
__d('EmoticonUtils',['EmoticonsList','Parent'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='emoticon_',k=h.symbols,l={getEmoteFromTarget:function(m){var n=i.byClass(m,'emoticon');if(!n)return null;var o=null;n.className.split(' ').forEach(function(p){if(p.startsWith(j))o=p.substring(j.length);});return k[o]||null;},insertEmoticon:function(m,n,o){var p=n.substring(0,o.start),q=n.substring(o.end);if(o.start>0&&!p.endsWith(' '))m=' '+m;if(!q.startsWith(' '))m+=' ';var r=p+m+q;o.start+=m.length;o.end=o.start;return {result:r,start:o.start,end:o.end};}};f.exports=l;},null);
__d("XPagesMercuryIndicatorController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pages\/messaging\/mercury\/indicator\/",{});},null);
__d('PagesMercuryChatTabIndicatorHandler',['Animation','AsyncRequest','AvailableListConstants','DOM','FBID','MercuryIDs','XPagesMercuryIndicatorController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();o.tryCreateHandler=function(p,q,r){'use strict';if(!q)return null;var s=m.getUserIDFromThreadID(p);if(!s||l.isUser(s))return null;return new o(s,q,r);};function o(p,q,r){'use strict';this.$PagesMercuryChatTabIndicatorHandler1=false;this.$PagesMercuryChatTabIndicatorHandler2=q;this.$PagesMercuryChatTabIndicatorHandler3=false;this.$PagesMercuryChatTabIndicatorHandler4=false;this.$PagesMercuryChatTabIndicatorHandler5=r;this.$PagesMercuryChatTabIndicatorHandler6=false;this.$PagesMercuryChatTabIndicatorHandler7=p;}o.prototype.__getEnableTimeSwitch=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler1;};o.prototype.__getIndicator=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler2;};o.prototype.__getIsShown=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler4;};o.prototype.__getPageOnlineStatus=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler5;};o.prototype.__getShouldPreventFutureShown=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler6;};o.prototype.__getTargetID=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler7;};o.prototype.__getIsChecking=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler3;};o.prototype.__getResponsivenessDescription=function(){'use strict';return this.$PagesMercuryChatTabIndicatorHandler8;};o.prototype.checkResponsiveness=function(){'use strict';if(this.$PagesMercuryChatTabIndicatorHandler3)return;var p=n.getURIBuilder().getURI();this.$PagesMercuryChatTabIndicatorHandler3=true;new i().setURI(p).setMethod('POST').setData({page_id:this.$PagesMercuryChatTabIndicatorHandler7}).setHandler((function(q){this.$PagesMercuryChatTabIndicatorHandler3=false;var r=q.payload;if(r.responsiveness)this.$PagesMercuryChatTabIndicatorHandler9(r.responsiveness,r.enableTimeSwitch);}).bind(this)).send();};o.prototype.hideIndicator=function(){'use strict';this.$PagesMercuryChatTabIndicatorHandler10(false);};o.prototype.hideIndicatorAndPreventFutureShow=function(){'use strict';this.$PagesMercuryChatTabIndicatorHandler10(true);};o.prototype.$PagesMercuryChatTabIndicatorHandler10=function(p){'use strict';this.$PagesMercuryChatTabIndicatorHandler6=this.$PagesMercuryChatTabIndicatorHandler6||p;if(this.$PagesMercuryChatTabIndicatorHandler2&&this.$PagesMercuryChatTabIndicatorHandler4){this.$PagesMercuryChatTabIndicatorHandler4=false;new h(this.$PagesMercuryChatTabIndicatorHandler2).to('height',0).duration(100).hide().go();}};o.prototype.showIndicator=function(){'use strict';if(!this.$PagesMercuryChatTabIndicatorHandler2||this.$PagesMercuryChatTabIndicatorHandler4||this.$PagesMercuryChatTabIndicatorHandler5!==j.OFFLINE||!this.$PagesMercuryChatTabIndicatorHandler8||this.$PagesMercuryChatTabIndicatorHandler6)return;k.setContent(this.$PagesMercuryChatTabIndicatorHandler2,this.$PagesMercuryChatTabIndicatorHandler8);this.$PagesMercuryChatTabIndicatorHandler4=true;new h(this.$PagesMercuryChatTabIndicatorHandler2).show().to('height',16).duration(100).go();};o.prototype.notifyPageOnlineStatusChanged=function(p){'use strict';if(this.$PagesMercuryChatTabIndicatorHandler5===p)return;this.$PagesMercuryChatTabIndicatorHandler5=p;if(!this.$PagesMercuryChatTabIndicatorHandler1)return;switch(p){case j.ACTIVE:this.hideIndicator();break;default:this.showIndicator();break;}};o.prototype.$PagesMercuryChatTabIndicatorHandler9=function(p,q){'use strict';this.$PagesMercuryChatTabIndicatorHandler8=p;this.$PagesMercuryChatTabIndicatorHandler1=q;this.showIndicator();};f.exports=o;},null);
__d('SelectionPosition',['Event','InputSelection','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(l){'use strict';this.$SelectionPosition1=l;this.$SelectionPosition2={start:0,end:0};this.$SelectionPosition3=new j();this.$SelectionPosition4=false;this.updatePos();this.enable();}k.prototype.getPos=function(){'use strict';return babelHelpers._extends({},this.$SelectionPosition2);};k.prototype.setPos=function(l,m){'use strict';this.$SelectionPosition2={start:l,end:m};this.restore();};k.prototype.updatePos=function(){'use strict';this.$SelectionPosition2=i.get(this.$SelectionPosition1);};k.prototype.restore=function(){'use strict';i.set(this.$SelectionPosition1,this.$SelectionPosition2.start,this.$SelectionPosition2.end);};k.prototype.enable=function(){'use strict';if(!this.$SelectionPosition4){this.$SelectionPosition3.addSubscriptions(h.listen(this.$SelectionPosition1,'keyup',this.updatePos.bind(this)),h.listen(this.$SelectionPosition1,'click',this.updatePos.bind(this)));this.$SelectionPosition4=true;}};k.prototype.disable=function(){'use strict';if(this.$SelectionPosition4){this.$SelectionPosition3.release();this.$SelectionPosition4=false;}};f.exports=k;},null);
__d("XStickerReplyNUXController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/tooltip\/",{});},null);
__d('ChatTabView',['Promise','AsyncRequest','AsyncSignal','AvailableListConstants','BanzaiODS','BootloadedComponent.react','Bootloader','ChatBehavior','ChatConfig','ChatNubLogger','ChatOpenTab','ChatPhotoUploader.react','ChatTabActions','ChatTabMessagesView','ChatTabSheetController','ChatTabViewEvents','ChatTabViewInstances','ChatTitleLink.react','ChatVisibility','CSS','CurrentLocale','CurrentUser','Dock','DOM','DOMEvent','DOMQuery','DragDropTarget','EmojiLikeUtils','EmoticonsList','EmoticonUtils','Event','FBID','FBRTCCallabilityStore','Input','JSResource','Keys','Locale','LogHistory','MercuryConfig','MercuryIDs','MercuryParticipants','MercuryShareAttachmentRenderLocations','MercurySourceType','MercuryThreadInfo','MercuryThreadTitle.react','MercuryTypingAnimation.react','MercuryViewer','MessagingTag','NubController','P2PGKValues','P2PSendMoneyContainerBootloader.react','PagesMercuryChatTabIndicatorHandler','Parent','PhotosUploadWaterfall','PresenceStatus','React','ReactComponentRenderer','ReactDOM','Run','Scroll','SelectionPosition','ShortProfiles','SimpleXUIDialog','SiteData','StickerActions','StickerConstants','StickerState','Style','SubscriptionsHandler','SyntheticMouseEvent','ChatTabTemplates','TextAreaControl','TooltipData','TypingDetectorController','UserAgent_DEPRECATED','WaterfallIDGenerator','WebMessengerDeleteThreadDialog','WebMessengerThreadPermalinks','WorkFileUploadsGating','WorkModeConfig','XStickerReplyNUXController','createCancelableFunction','csx','cx','emptyFunction','fbt','getActiveElement','isEmpty','requireWeak','setIntervalAcrossTransitions','ChatReactInput','MercuryBlockedParticipants','MercuryTypingReceiver','MercuryMessageObject','MercuryMessages','MercuryServerRequests','MercuryThreadActions','MercuryThreadIDMap','MercuryThreadInformer','MercuryThreads','MercuryMessageActions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc){'use strict';if(c.__markCompiled)c.__markCompiled();var tc=c('ChatReactInput').module,uc=c('MercuryBlockedParticipants').get(),vc=c('MercuryTypingReceiver').get(),wc=c('MercuryMessageObject').get(),xc=c('MercuryMessages').get(),yc=c('MercuryServerRequests').get(),zc=c('MercuryThreadActions').get(),ad=c('MercuryThreadIDMap').get(),bd=c('MercuryThreadInformer').get(),cd=c('MercuryThreads').get(),dd=c('MercuryMessageActions').get(),ed=/^\s*$/,fd=x,gd,hd='right',id=960,jd=10,kd=p.get('chat_react_composer'),ld=p.get('chat_react_header'),md=p.get('chat_react_input'),nd=sa.getInstance('chat_tab_view');rc('AvailableList',function(je){je.subscribe(k.ON_AVAILABILITY_CHANGED,fe);});function od(je,ke){var le=ea.create('div');ke=ke&&ke.filter(function(oe){return oe!=bb.getID();});if(qc(ke))return bc.remove(je);var me=ke.length,ne=me-jd;if(ne>1)ke=ke.slice(0,jd);va.getMulti(ke,function(oe){for(var pe in oe){var qe=oe[pe],re=zb[':fb:mercury:chat:multichat-tooltip-item'].build();ea.setContent(re.getNode('name'),qe.name);var se=ua.getUserIDFromParticipantID(pe),te=se&&jb.get(se)==k.ACTIVE;aa.conditionShow(re.getNode('icon'),te);aa.conditionClass(re.getNode('name'),'tooltipItemWithIcon',te);ea.appendContent(le,re.getRoot());}if(ne>1){var ue=oc._("\u0438 \u0435\u0449\u0435 {number of hidden chat participants}.",[oc.param('number of hidden chat participants',ne)]);ea.appendContent(le,ea.create('div',{},ue));}bc.set(je,le,'above');});}var pd={},qd=null,rd=false;function sd(je,ke,le){if(le){pd[je]=ke;if(!qd)qd=sc(td,600);}else{aa.removeClass(ke,'highlightTitle');delete pd[je];}}function td(){for(var je in pd){var ke=pd[je];if(ke.parentNode){aa.conditionClass(ke,'highlightTitle',rd);}else delete pd[je];}rd=!rd;if(!Object.keys(pd).length){clearInterval(qd);qd=null;}}function ud(je){var ke=ua.tokenize(je);switch(ke.type){case 'user':return zb[':fb:mercury:chat:user-tab'].build();}return zb[':fb:mercury:chat:multichat-tab'].build();}function vd(je){var ke=je._getInputValue(),le=je._filesUploader,me=le?le.getAttachments():[];if(ae(je))xd(je,ke,me,function(ne){ne=ie(ne,le);dd.send(ne,function(oe){var pe=cd.getThreadMetaNow(oe);if(pe&&pe.folder===cb.PENDING)zc.movePendingToInbox(oe);});le&&le.removeAttachments();if(je._sharePreview)je._sharePreview.setProps({share:null,uri:null});if(!md){je._getNode('input').value='';}else if(kd){je._composer.onSend();}else je._chatInput.component.resetState();je._typingDetector&&je._typingDetector.resetState();if(je._messagesView){je._messagesView.scrollToBottom();je._messagesView.setShouldScrollToBottom(true);}});}function wd(je,ke){if(ke===0)return;ce(je,ib.POST_PUBLISHED,{count:ke});je._waterfallID=ec.generate();}function xd(je,ke,le,me){cd.getThreadMeta(je._threadID,function(ne){if(ne&&ne.is_canonical&&!ya.canReply(ne)){je._showMessageBlockedDialog(ne);return;}var oe=xa.CHAT_WEB,pe=wc.constructUserGeneratedMessageObject(ke,oe,je._threadID);if(le.length>0){pe.has_attachment=true;pe.raw_attachments=le;}if(je._sharePreview){var qe=je._sharePreview.component.getShareData();if(qe){pe.has_attachment=true;pe.shareable_attachment=qe;}}if(cd.isNewEmptyLocalThread(je._threadID)){var re=je._sheetController.getAddFriendsParticipants();je._sheetController.closeAddFriendsSheet();if(re===null||re.length===0)return;re=re.filter(function(ue){return ue!=bb.getID();});if(re.length===0){pe.thread_id=ua.getThreadIDFromUserID(ca.getID());}else if(re.length===1){pe.thread_id=ua.getThreadIDFromParticipantID(re[0]);}else zc.addParticipants(je._threadID,re);}if(cd.isEmptyLocalThread(je._threadID)){pe.offline_threading_id=ua.tokenize(je._threadID).value;var se=cd.getThreadMetaNow(ne.thread_id);pe.specific_to_list=Array.from(se.participants);}if(typeof pe!='undefined')pe.signatureID=je._signatureID;pe.ui_push_phase=sb.push_phase;me(pe);if(je._threadID!==pe.thread_id&&!je.isUploading()){var te=je._getInputValue();t.closeTab(je._threadID);r.openThread(pe.thread_id,'ChatTabView',null,ke?nc:function(ue){return ue.appendTextToInput(te);});}});}function yd(je){je._blocked=true;je._sheetController.openUploadWarningTabSheet();}function zd(je){return je.isUploading();}function ae(je){var ke=je._getInputValue();if(!ed.test(ke))return true;var le=je._filesUploader;if(le&&(le.getAttachments().length>0||le.getImageFiles().length>0||le.getAnimatedImageFiles().length>0||le.getVideoFiles().length>0||le.getAudioFiles().length>0||le.getFiles().length>0))return true;if(je._sharePreview&&je._sharePreview.component.getShareData())return true;return false;}function be(je){je._nubController.flyoutContentChanged();var ke=je._getNode('attachmentShelf');ob.setTop(ke,ke.scrollHeight);}function ce(je,ke,le){ib.sendSignal(babelHelpers._extends({qn:je._waterfallID,step:ke,uploader:ib.APP_CHAT},le||{}));}function de(je,ke,le,me,ne){if(ke)yc.ensureThreadIsFetched(ke);this._threadID=je;this._signatureID=le;this._eventListeners=[];this._onlineStatus=k.OFFLINE;this._tabTemplate=ud(je);this._tabElem=this._tabTemplate.getRoot();if(ne&&ne.getTabElem()){this.insertBefore(ne);}else this.appendTo(me);this._stickersFlyoutShown=false;this._messagesView=null;this._titlebar=this._getNode('nubFlyoutTitlebar');if(!kd){this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._contentSearchNode=this._getNode('contentSearchContainer');this._fileUploaderNode=this._getNode('fileUploaderContainer');}this._pagesMessageIndicator=this._getNode('pagesMessageIndicator');this._waterfallID=ec.generate();this._subscriptionsHandler=new xb();this._initializeSheetController();var oe=[nc,this._initializeHeader.bind(this),this._initializeUIListeners.bind(this),this._initializeAutoSendPhotoUploader.bind(this),this._initializeAutoSendFileUploader.bind(this),this._initializeTitleHREF.bind(this),this._initializeP2P.bind(this),this._initializeInput.bind(this),this._initializeStickers.bind(this),this._initializeContentSearch.bind(this),(function(){cd.getThreadMeta(this._threadID,(function(ue){this._updateMutingSettings(ue);this._updateMessageBlockSettings(ue);this._updateMessageManageSettings(ue);this._updateSecretModeSettings(ue);this._updateCustomLike(ue);}).bind(this));}).bind(this),(function(){this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);}).bind(this),this._initializeUnloadListeners.bind(this),this._initializeDragDropTarget.bind(this),this._initializePageMessagingIndicator.bind(this),this._initializeP2PChatThreadBannerContainer.bind(this),this._initializeP2PRainMoneyContainer.bind(this)];for(var pe=oe,qe=Array.isArray(pe),re=0,pe=qe?pe:pe[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var se;if(qe){if(re>=pe.length)break;se=pe[re++];}else{re=pe.next();if(re.done)break;se=re.value;}var te=se;te();}fd.set(je,this);this._logOpenTab();}function ee(je){if(je._photoUploader&&je._photoUploader.isUploading())ce(je,ib.CANCEL_DURING_UPLOAD);}function fe(){for(var je=fd.values(),ke=Array.isArray(je),le=0,je=ke?je:je[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var me;if(ke){if(le>=je.length)break;me=je[le++];}else{le=je.next();if(le.done)break;me=le.value;}var ne=me;ne.updateAvailableStatus();ne.updateMultichatTooltip();}}function ge(){for(var je=fd.values(),ke=Array.isArray(je),le=0,je=ke?je:je[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var me;if(ke){if(le>=je.length)break;me=je[le++];}else{le=je.next();if(le.done)break;me=le.value;}var ne=me;ne.updateCallLink();}}na.addListener(ge);o.subscribe(o.ON_CHANGED,function(){for(var je=fd.keys(),ke=Array.isArray(je),le=0,je=ke?je:je[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var me;if(ke){if(le>=je.length)break;me=je[le++];}else{le=je.next();if(le.done)break;me=le.value;}var ne=me;cd.getThreadMeta(ne,function(oe){fd.get(ne)._updateUnreadCount(oe);});}});vc.addRetroactiveListener('state-changed',function(je){for(var ke in je){var le=je[ke]&&je[ke].length,me=fd.get(ke);me&&me.showTypingIndicator(le);}});bd.subscribe('threads-updated',function(je,ke){for(var le=fd.keys(),me=Array.isArray(le),ne=0,le=me?le:le[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var oe;if(me){if(ne>=le.length)break;oe=le[ne++];}else{ne=le.next();if(ne.done)break;oe=ne.value;}var pe=oe,qe=fd.get(pe);ke[pe]&&qe.updateTab();if(qe._newThreadIDFromPhotoUpload&&!qe.isUploading()&&ke[qe._newThreadIDFromPhotoUpload]){t.closeTab(qe._threadID);r.openThread(qe._newThreadIDFromPhotoUpload,'ChatTabView');qe._newThreadIDFromPhotoUpload=null;}}});bd.subscribe('threads-deleted',function(je,ke){for(var le=fd.keys(),me=Array.isArray(le),ne=0,le=me?le:le[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var oe;if(me){if(ne>=le.length)break;oe=le[ne++];}else{ne=le.next();if(ne.done)break;oe=ne.value;}var pe=oe;ke[pe]&&t.closeTab(pe,'thread_deleted');}});Object.assign(de.prototype,{getThreadID:function(){return this._threadID;},getTabElem:function(){return this._tabElem;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(je){setTimeout((function(){this._sheetController.openNameConversationSheet(je);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return aa.shown(this._tabElem);},isUploading:function(){var je=kd?this._composer&&this._composer.isUploading():!!(this._fileUploader&&this._fileUploader.isUploading()||this._photoUploader&&this._photoUploader.isUploading());return !!(je||this._filesUploader&&this._filesUploader.isUploading()||this._sharePreview&&this._sharePreview.component.isLoading());},setVisibleState:function(je,ke){var le=aa.shown(this._tabElem),me=aa.hasClass(this._tabElem,'opened');aa.conditionShow(this._tabElem,je);aa.conditionClass(this._tabElem,'opened',ke);if(!(le&&me)&&je&&ke){if(!this._messagesView)this._updateChatTabMessagesView(this._threadID);this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();this.setP2PChatThreadBannerContainerVisibility();}},_updateChatTabMessagesView:function(je){if(this._messagesView&&this._messagesView.getThreadID()===je)return;var ke=ua.tokenize(je);this._messagesView&&this._messagesView.destroy();this._messagesView=new u(je,this._sheetController,this._getNode('scrollingArea'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this,ta.ShowContextBanner&&ke.type==='user');},focus:function(){if(aa.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var je=pc();return hb.byClass(je,"_50mz")===this._tabElem;},hasEmptyInput:function(){return ed.test(this._getInputValue());},getInputElem:function(){if(kd)return this._composer&&mb.findDOMNode(this._composer.getInput());if(md){if(!this._chatInput||!this._chatInput.component.isMounted())return null;return mb.findDOMNode(this._chatInput.component);}else return this._getNode('input');},setStickersFlyoutPackID:function(je){if(!this._stickerButton.isMounted())return;tb.selectPack(je);this._toggleStickersFlyoutShown(true);},loadShareFromParams:function(je,ke){this._getSharePreview().done(function(le){le.setProps({share:{params:ke,type:je},uri:null});});},_linkDropped:function(je){this._getSharePreview().done(function(ke){ke.setProps({share:null,uri:je});});},_filesDropped:function(je){this._loadReactMenu().done(function(ke){var le=ke.component.getFileUploaderPromise();if(le)le.done(function(me){setTimeout(function(){me.addDroppedFiles(je);},0);});});},_toggleStickersFlyoutShown:function(je){this._stickerButton.showFlyout();this._stickersFlyoutShown=je;},showStickerReplyNUX:function(){if(gd)return;new i(jc.getURIBuilder().getURI()).setRelativeTo(this._getNode('stickerButtonContainer')).setData({thread_id:this._threadID}).setHandler(function(je){vb.clearShowStickerReplyNUX();}).send();},insertBefore:function(je){ea.insertBefore(je.getTabElem(),this._tabElem);},appendTo:function(je){ea.appendContent(je,this._tabElem);},nextTabIs:function(je){var ke=je&&je.getTabElem();return this._tabElem.nextSibling==ke;},getScrollTop:function(){return ob.getTop(ea.find(this._tabElem,'.fbNubFlyoutBody.scrollable'));},setScrollTop:function(je){ob.setTop(ea.find(this._tabElem,'.fbNubFlyoutBody.scrollable'),je);},destroy:function(){this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();mb.unmountComponentAtNode(this._getNode('animationContainer'));mb.unmountComponentAtNode(this._getNode('menuContainer'));if(ld){if(this._addToThreadButton){this._addToThreadButton.unmount();this._addToThreadButton=null;}if(this._archiveWarning){this._archiveWarning.unmount();this._archiveWarning=null;}if(this._videoCallButton){this._videoCallButton.unmount();this._videoCallButton=null;}if(this._closeButton){this._closeButton.unmount();this._closeButton=null;}if(this._title){this._title.unmount();this._title=null;}}if(this._sharePreview){this._sharePreview.unmount();this._sharePreview=null;}this._subscriptionsHandler&&this._subscriptionsHandler.release();mb.unmountComponentAtNode(this._getNode('name'));if(!ld)mb.unmountComponentAtNode(this._getNode('titlebarText'));if(kd){mb.unmountComponentAtNode(this._getNode('footer'));}else{try{mb.unmountComponentAtNode(this._getNode('photoUploaderContainer'));mb.unmountComponentAtNode(this._getNode('fileUploaderContainer'));}catch(je){l.bumpEntityKey('chat.web','chattab.unmount_failed');}mb.unmountComponentAtNode(this._getNode('stickerButtonContainer'));if(md){mb.unmountComponentAtNode(this._getNode('inputContainer'));}else oa.reset(this._getNode('input'));if(this._getNode('hotLikeContainer'))mb.unmountComponentAtNode(this._getNode('hotLikeContainer'));if(this._p2pButtonContainer){if(this._p2pButton)this._p2pButton.unmount();this._p2pButtonContainer=null;this._p2pButton=null;}if(this._p2pChatThreadBannerContainerEl){mb.unmountComponentAtNode(this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainerEl=null;}if(this._p2pRainMoneyContainerEl){mb.unmountComponentAtNode(this._p2pRainMoneyContainerEl);this._p2pRainMoneyContainerEl=null;}}ea.remove(this._tabElem);fd['delete'](this._threadID);da.unregisterNubController(this._nubController);},updateAvailableStatus:function(){cd.getThreadMeta(this._threadID,(function(je){var ke=k.OFFLINE,le=this._getCanonicalUserID(),me=null;if(le){ke=jb.get(le);me=qb.getNow(le);}else{var ne=je.participants.map(function(pe){return ua.getUserIDFromParticipantID(pe);});ke=jb.getGroup(ne);}if(!z.isOnline())ke=k.OFFLINE;this.updateCallLink();aa.conditionClass(this._tabElem,"_5238",ke===k.ACTIVE&&(me===undefined||me===null||!me.is_messenger_only));var oe=this._getNode('presenceIndicator');this._onlineStatus=ke;this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.notifyPageOnlineStatusChanged(ke);switch(ke){case k.ACTIVE:oe.setAttribute('alt',oc._("\u0412 \u0441\u0435\u0442\u0438"));break;default:oe.removeAttribute('alt');break;}}).bind(this));},updateTab:function(){cd.getThreadMeta(this._threadID,(function(je){var ke=[this._getNode('name')];if(!ld){ke.push(this._getNode('titlebarText'));}else if(this._title)this._title.setProps({thread:je},(function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.component.getTitle());}).bind(this));for(var le=ke,me=Array.isArray(le),ne=0,le=me?le:le[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var oe;if(me){if(ne>=le.length)break;oe=le[ne++];}else{ne=le.next();if(ne.done)break;oe=ne.value;}var pe=oe;mb.render(kb.createElement(za,{isNewThread:cd.isNewEmptyLocalThread(this._threadID),thread:je,useAndSeparator:true,useShortName:!je.is_canonical,viewer:ca.getID()}),pe);}this._updateControls(je);this._updateMessageBlockSettings(je);this._updateMessageManageSettings(je);this._updateSecretModeSettings(je);this._updateMutingSettings(je);this._updateUnreadCount(je);this.updateMultichatTooltip();this._updateArchiveWarning(je);this._updateConfidentialStatus(je);this._updateEmployeeAwayWarning(je);this._updateOfficeStatus(je);this._updateNewThread(je);this._updateNameConversationSheet(je);this._updateReadOnlySheet(je);this._updateSwitchToWork(je);this._updateCustomLike(je);}).bind(this));},_updateNameConversationSheet:function(je){if(ya.canReply(je)&&!je.name&&!je.is_canonical&&!je.name_conversation_sheet_dismissed&&!je.has_email_participant&&!je.read_only&&!cd.isEmptyLocalThread(je.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(je){var ke=ya.showComposer(je),le=ya.canReply(je),me=cd.isEmptyLocalThread(je.thread_id);if(!le&&!ke&&!me)this._sheetController.openReadOnlySheet();},_updateMessageManageSettings:function(je){var ke=ua.getParticipantIDFromFromThreadID(je.thread_id),le=va.getNow(ke);this._updateMenuPropsSafe({isBusinessEnabled:le&&le.is_business_enabled});},updateSignatureID:function(je){this._signatureID=je;},_updateMessageBlockSettings:function(je){this._updateMenuPropsSafe({hasMessageBlocked:uc.isMessageBlocked(je),isEmptyConversation:je&&je.message_count==0});},_updateCustomLike:function(je){if(kd||!this._getNode('hotLikeContainer'))return;var ke="_6h1 _6gb";mb.render(kb.createElement(m,{bootloadPlaceholder:kb.createElement('a',{className:ke}),bootloadLoader:pa('MessengerHotLikeButton.react'),className:ke,customLike:je.custom_like_icon,sendSticker:this._stickerSelected.bind(this),sendCustomLike:this._customLikeSelected.bind(this),threadID:this._threadID}),this._getNode('hotLikeContainer'));aa.addClass(this._inputContainerNode,"_n4k");},_updateSecretModeSettings:function(je){var ke=!!(je&&je.ephemeral_ttl_mode);this._updateMenuPropsSafe({hasSecretModeOn:ke});aa.conditionClass(this._tabElem,"_5iq8",ke);var le=ke?oc._("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u0441\u0447\u0435\u0437\u0430\u044e\u0449\u0435\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435..."):oc._("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...");if(kd){this._composer&&this._composer.setPlaceholder(le);}else if(md){this._chatInput.setProps({placeholder:le});}else this.getInputElem().placeholder=le;},_updateMutingSettings:function(je){var ke=ya.isMuted(je);ke&&this._loadReactMenu();this._updateMenuPropsSafe({isMuted:ke});},_updateMenuPropsSafe:function(je){if(this._menuPromise)this._menuPromise.done(function(ke){ke&&ke.component&&ke.component.isMounted()&&ke.setProps(je);});},_updateArchiveWarning:function(je){if(ca.isEmployee())va.getMulti(je.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateConfidentialStatus:function(je){if(je.other_user_fbid)va.getMulti(je.participants,(function(ke){var le=this._getNode('titlebarConfidentialStatus');if(le){var me=je.other_user_fbid&&ke[ua.getParticipantIDFromUserID(je.other_user_fbid)].is_anonymous_crisis_support;aa.conditionShow(le,me);}}).bind(this));},_updateEmployeeAwayWarning:function(je){if(!ca.isEmployee())return;nb.onAfterLoad((function(){n.loadModules(["ChatEmployeeAwayWarning"],(function(ke){ke.updateEmployeeAwayWarning(je,(function(){this._sheetController.openEmployeeAwaySheet();}).bind(this),nc);}).bind(this));}).bind(this));},_updateOfficeStatus:function(je){var ke=this._getNode('officeStatus');if(!ke||ua.isGroupChat(je.thread_id))return;nb.onAfterLoad(function(){n.loadModules(["ChatTabOfficeStatus"],function(le){var me=ua.getParticipantIDFromUserID(je.other_user_fbid);va.get(me,function(ne){le.update(ke,ne);});});});},_updateSwitchToWork:function(je){if(ca.isEmployee()&&ca.hasWorkUser()&&ua.isGroupChat(je.thread_id)){va.getMulti(je.participants,(function(ke){var le=this._isEmployeesOnly(ke);this._updateMenuPropsSafe({hasSwitchToWork:le});}).bind(this));}else this._updateMenuPropsSafe({hasSwitchToWork:false});},_updateControls:function(je,ke,le){var me=false;if(je&&je.thread_id){var ne=ua.tokenize(je.thread_id);if(ne.type==='user'){var oe=ne.value;me=!ma.isUser(oe);}}var pe=ya.showComposer(je)&&(!qc(je.participants)||!!ke)&&!this._pendingActions,qe=this._getNode('footer');aa.conditionShow(qe,pe);aa.conditionShow(this._getNode('menuContainer'),pe);var re={isEmptyChat:cd.isNewEmptyLocalThread(je.thread_id),show:pe};if(me)re.showAddFriend=null;this._updateMenuPropsSafe(re);var se=pe&&!me;if(ld){this._addToThreadButton&&this._addToThreadButton.setProps({shown:se});}else aa.conditionShow(this._getNode('addToThreadLink'),se);if(le&&le.length===1&&ta.ShowContextBanner&&ta.ShowContextBannerNullState){this._messagesView&&this._messagesView.renderContextBanner(null,le[0].info&&le[0].info.uid);}else this._messagesView&&this._messagesView.unmountContextBanner();this._resizeInputContainer();},_isP2PEnabled:function(){return eb.P2PEnabled;},_getP2PProps:function(){return {button:kb.createElement('i',{className:"hidden_elem"}),className:"_6ga _6gb",flyoutAlignment:hd,onTrigger:this._p2pTriggered.bind(this),referrer:wa.CHAT,threadID:this._threadID};},_renderP2PButton:function(){var je=this._getCanonicalUserID();if(this._isP2PEnabled()&&je!==ca.getID()){this._p2pButtonContainer=this._getNode('orionTriggerContainer');this._p2pButton=new lb(fb,this._p2pButtonContainer);this._p2pButton.setProps(this._getP2PProps());aa.addClass(this._inputContainerNode,"_11d6");}else aa.addClass(this._getNode('orionTriggerContainer'),"hidden_elem");},_resizeInputContainer:function(){if(kd)return;if(!md)ac.getInstance(this._getNode('input')).update();},_updateNewThread:function(je){if(cd.isNewEmptyLocalThread(je.thread_id))this.showAddFriend();},_isEmployeesOnly:function(je){for(var ke in je)if(!je[ke].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function(je){var ke=this._isEmployeesOnly(je),le=ld?this._getNode('archiveContainer'):this._getNode('titanArchiveWarning');if(le){if(this._titlebarTooltipAnchor)aa.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',ke);aa.conditionShow(le,ke);if(ld)this._archiveWarning&&this._archiveWarning.setProps({shown:ke});}},updateMultichatTooltip:function(){cd.getThreadMeta(this._threadID,(function(je){if(!je.is_canonical){var ke;if(ld){ke=mb.findDOMNode(this._title.component);}else ke=this._titlebarTooltipAnchor;od(ke,je.participants);}}).bind(this));},_getNode:function(je){return this._tabTemplate.getNode(je);},_getCanonicalUserID:function(){return ua.getUserIDFromThreadID(this._threadID);},_listen:function(je,event,ke,le){var me=this._getNode(je);if(me){this._eventListeners.push(la.listen(me,event,ke.bind(this)));}else if(!le)throw new Error('Could not find node "'+je+'"');},_closePreClicked:function(je){this._closeMouseDown=true;},_closeClicked:function(je){ee(this);t.closeTab(this._threadID);if(je instanceof yb){je.stopPropagation();return;}je.kill();},_closeEnter:function(je){if(je.keyCode===qa.RETURN)this._closeClicked(je);},_nubClicked:function(je){je.kill();return w.inform('nub-activated',this._threadID);},_dockKeyDown:function(event){if(event.keyCode===qa.RETURN||event.keyCode===qa.SPACE){w.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===qa.ESC){this._handleEscape();if(md)event=new fa(event);event.kill();}else if(event.keyCode===qa.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var je=w.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(md)event=new fa(event);!je&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._toggleStickersFlyoutShown(false);return;}ee(this);if(this.hasEmptyInput()){w.inform('esc-pressed',this._threadID);}else{var je=oc._("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0437\u0430\u043a\u0440\u044b\u0442\u044c \u043e\u043a\u043d\u043e \u044d\u0442\u043e\u0433\u043e \u0447\u0430\u0442\u0430?"),ke=oc._("\u0412\u044b \u043d\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043b\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435.");rb.showConfirm(je,ke,(function(le){if(le){w.inform('esc-pressed',this._threadID);}else this.focus();}).bind(this),{autofocusConfirm:true});}},_titleClicked:function(event){var je=event.getTarget();if(!hb.byClass(je,'titlebarText')&&!hb.byClass(je,'uiSelector')&&!hb.byClass(je,'addToThread')&&!hb.byClass(je,'optionMenu')&&!hb.byClass(je,'videoicon')&&!hb.byClass(je,'phoneicon')&&!hb.bySelector(je,"._1fu3")&&!hb.bySelector(je,"._1fu4")&&!hb.byClass(je,'close')){event.kill();t.lowerTab(this._threadID);this.focus();}},_groupCallEnter:function(je){if(je.keyCode===qa.RETURN)this._groupCallClicked(je);},_groupCallClicked:function(je){if(je.target)je.target.blur();if(this._videoCallLinkEnabled){var ke;if(je.target&&(aa.hasClass(je.target,'phoneicon')||aa.hasClass(je.target,"_1fu4"))){ke='chat_tab_voice_icon';}else ke='chat_tab_icon';cd.getThreadMeta(this._threadID,function(le){var me=le.participants.map(function(oe){return ua.getUserIDFromParticipantID(oe);}),ne=me.filter(function(oe){return oe!==ca.getID();});w.inform('group-call-clicked',{threadID:'GROUP:'+le.thread_fbid.toString(),usersToCall:ne,clickSource:ke,audioOnly:ke==='chat_tab_voice_icon'});});}if(ld){je.stopPropagation();}else return false;},_callEnter:function(je){if(je.keyCode===qa.RETURN)this._callClicked(je);},_callClicked:function(je){if(je.target)je.target.blur();var ke=this._getCanonicalUserID();if(this._videoCallLinkEnabled){var le;if(je.target&&(aa.hasClass(je.target,'phoneicon')||aa.hasClass(je.target,"_1fu4"))){le='chat_tab_voice_icon';}else le='chat_tab_icon';w.inform('video-call-clicked',{threadID:this._threadID,userID:ke,clickSource:le,audioOnly:le==='chat_tab_voice_icon'});}if(ld){je.stopPropagation();}else return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_getUserParticipants:function(je){var ke=[];je.forEach(function(le){var me=ua.getUserIDFromParticipantID(le);me&&ke.push(me);});return ke;},_enableDesktopNotif:function(){Notification.requestPermission();},_inputPasted:function(event){if(dc.chrome()){var je=event.clipboardData||event.originalEvent.clipboardData;if(!je||!je.items||je.items.length<1)return;var ke=je.items[0].type;if(ke!=='image/png')return;if(je.items[0].getAsFile){var le=je.items[0].getAsFile();this._photoUploader&&this._photoUploader.uploadFiles([le]);}}},_focusInput:function(){q.processEvent('focus');if(kd){this._composer&&this._composer.getInput().focus();}else if(md){this._chatInput&&this._chatInput.component.isMounted()&&this._chatInput.component.focus();}else this._getNode('input').focus();},_focusTab:function(){aa.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._closeMouseDown=false;this._setCloseTooltip(true);w.inform('focus-tab',this._threadID);},_blurTab:function(){q.processEvent('blur');aa.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(je){if(ld&&this._closeButton){this._closeButton.setProps({active:je});return;}var ke=this._getNode('titlebarCloseButton'),le=je?oc._("\u041d\u0430\u0436\u043c\u0438\u0442\u0435 Esc \u0434\u043b\u044f \u0432\u044b\u0445\u043e\u0434\u0430"):oc._("\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0432\u043a\u043b\u0430\u0434\u043a\u0443");bc.set(ke,le,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===qa.RETURN&&!event.shiftKey){if(zd(this)){yd(this);event.kill&&event.kill();return;}vd(this);event.kill?event.kill():event.preventDefault();return;}if(event.keyCode===qa.DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();t.lowerTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_showMessageBlockedDialog:function(je){var ke=this._getCanonicalUserID();if(!ke)return;if(!md)this._getNode('input').blur();var le='fbid:'+ke;va.get(le,function(me){n.loadModules(["MessageBlockedDialog"],function(ne){ne.show(je.thread_id,je.can_reply,uc.isMessageBlocked(je),me.short_name);});});},_initializeInput:function(){if(kd){var je=new lb(m,this._getNode('footer'));je.setProps({bootloadPlaceholder:kb.createElement('div',null),bootloadLoader:pa('ChatTabComposerContainer.react'),initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onMount:(function(me){this._composer=me;}).bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:(function(){return this._toggleStickersFlyoutShown(true);}).bind(this),resizeFn:(function(){this._nubController.flyoutContentChanged();}).bind(this),placeholder:oc._("Type a message..."),photoUploaderProps:this._getPhotoUploaderProps(),fileUploaderProps:this._getFileUploaderProps(),stickerButtonProps:this._getStickerButtonProps(),p2pProps:this._getP2PProps(),onCustomLikeSelect:this._customLikeSelected.bind(this),onStickerSelect:this._stickerSelected.bind(this),threadID:this._threadID,viewer:ca.getID()});return;}if(!md){var ke=this._inputContainerNode.clientHeight;ac.getInstance(this._getNode('input')).subscribe('resize',(function(){var me=this._inputContainerNode.clientHeight;if(me!=ke)this._nubController.flyoutContentChanged();ke=me;}).bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(dc.firefox()&&ba.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else{var le=oc._("Type a message...");this._chatInput=new lb(tc,this._getNode('chatInputContainer'));this._chatInput.setProps({initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:(function(){return this._toggleStickersFlyoutShown(true);}).bind(this),resizeFn:(function(me){wb.set(this._getNode('inputContainer'),'height',me+'px');this._nubController.flyoutContentChanged();}).bind(this),uploadPhotoFn:(function(me){this._photoUploader&&this._photoUploader.uploadFiles([me]);}).bind(this),placeholder:le});}},_initializeSharePreview:function(je,ke){la.listen(je,'keyup',(function(){var le=ke?ke():je.value;if(!le.length)if(this._urlScraper){this._urlScraper.reset();delete this._urlScraperData;}}).bind(this));nb.onAfterLoad((function(){n.loadModules(["URLScraper"],(function(le){this._urlScraper=new le(je,ke);this._urlScraper.subscribe('match',(function(me,ne){this._urlScraperData=ne;this._getSharePreview().done((function(oe){var pe=this._urlScraperData;oe.setProps({share:null,uri:pe&&pe.url});}).bind(this));}).bind(this));}).bind(this));}).bind(this));},_getSharePreview:function(){if(!this._sharePreview&&!this._sharePreviewPromise){this._sharePreviewLoading=true;this._sharePreviewPromise=new h((function(je){n.loadModules(["MercurySharePreview.react"],(function(ke){this._sharePreview=new lb(ke,this._getNode('shareAttachmentShelf'));this._sharePreview.setProps({imageSize:{width:id,height:id},location:wa.CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:(function(){be(this);this._unblockSend();}).bind(this)});this._sharePreviewLoading=false;je(this._sharePreview);}).bind(this));}).bind(this));}return this._sharePreviewPromise;},_initializeThingsWithInputFn:function(je,ke){if(kd)this._getValueFromReactComposer=ke;this._initializeSharePreview(je,ke);cd.getThreadMeta(this._threadID,(function(le){if(le&&le.folder===cb.PENDING){var me=ea.create('div');ea.appendContent(this._getNode('chatConv'),me);this._pendingActions=me;mb.render(kb.createElement(m,{bootloadPlaceholder:kb.createElement('div',{style:{height:27}}),bootloadLoader:pa('ChatPendingActions.react'),onDeleteClick:(function(ne){zc.changeFolder(this._threadID,cb.OTHER);t.closeTab(this._threadID);}).bind(this),onReplyClick:(function(ne){zc.changeFolder(this._threadID,cb.INBOX);ea.remove(me);delete this._pendingActions;this._updateControls(le);}).bind(this)}),me);}ad.getServerIDFromClientID(this._threadID,(function(ne){this._typingDetector=new cc(this._getCanonicalUserID(),je,'mercury-chat',null,ne,ke);}).bind(this));}).bind(this));},_getInputValue:function(){if(this._getValueFromReactComposer)return this._getValueFromReactComposer();if(md){if(!this._chatInput||!this._chatInput.component.isMounted())return '';return this._chatInput.component.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},appendTextToInput:function(je){if(kd){this._composer&&this._composer.getInput().appendText(je);}else if(md){if(this._chatInput&&this._chatInput.component.isMounted())this._chatInput.component.appendText(je);}else this._getNode('input').value+=je;},_hasUnfinishedPost:function(){return ae(this)||this.isUploading();},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){zc.markRead(this._threadID);zc.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function(je){this.tryMarkAsRead();if(hb.byTag(je.getTarget(),'a')||ea.getSelection())return;this.focus();},_inputContainerClicked:function(je){this.tryMarkAsRead();this.focus();},_initializePageMessagingIndicator:function(){if(!this._pagesMessageIndicator)return;aa.hide(this._pagesMessageIndicator);this._pagesMessageIndicatorHandler=gb.tryCreateHandler(this._threadID,this._pagesMessageIndicator,this._onlineStatus);this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.checkResponsiveness();},showTypingIndicator:function(je){this._renderTypingIndicator();aa.conditionClass(this._tabElem,"_54m8",je);},_renderTypingIndicator:function(){var je=aa.hasClass(this._tabElem,'highlightTab')?'light':'dark';mb.render(kb.createElement(ab,{color:je}),this._getNode('animationContainer'));},_updateUnreadCount:function(je){var ke=je.unread_count;if(typeof ke!='undefined'){var le=!!ke&&(!o.showsTabUnreadUI||o.showsTabUnreadUI()),me=this._getNode('numMessages');aa.conditionShow(me,le);aa.conditionClass(this._tabElem,'highlightTab',le);this._renderTypingIndicator();sd(this._threadID,this._tabElem,le);ea.setContent(me,ke);}},updateCallLink:function(){var je=ua.isGroupChat(this._threadID);if(je&&p.get('rtc_conferencing_www')){this._videoCallLinkEnabled=true;if(!ld)aa.conditionClass(this._tabElem,"_26-s",this._videoCallLinkEnabled);}else{var ke=this._getCanonicalUserID();if(!ke||ke===ca.getID()||!ma.isUser(ke)){if(ld){if(this._videoCallButton)this._videoCallButton&&this._videoCallButton.setProps({shown:false});}else{var le=this._getNode('videoCallLink');if(le)aa.hide(le);var me=this._getNode('voiceCallLink');if(me)aa.hide(me);}this._videoCallLinkEnabled=false;return;}this._videoCallLinkEnabled=na.isCallable(ke);if(!ld){aa.conditionClass(this._tabElem,"_4hwz",this._videoCallLinkEnabled);va.get(ua.getParticipantIDFromUserID(ke),(function(ne){na.callButtonTooltip(ke,ne.short_name);this._setCallButtonTooltips(ke,ne.short_name);}).bind(this));}}},_setCallButtonTooltips:function(je,ke){var le=na.callButtonTooltip(je,ke),me=na.voiceCallButtonTooltip(je,ke);bc.set(this._getNode('videoCallLink'),le);var ne=this._getNode('voiceCallLink');if(ne)bc.set(ne,me);},_initializeSheetController:function(){this._sheetController=new v(this._threadID,this._getNode('sheet'),this._tabElem,this);this._sheetController.onClickMessagesBlockedSheet((function(){zc.unblockMessages(this._threadID);this.focus();}).bind(this));this._sheetController.onClickNewMessagesSheet((function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();}).bind(this));this._sheetController.onClickThreadIsMutedSheet((function(){zc.unmute(this._threadID);this.focus();}).bind(this));this._sheetController.onClickSecretModeSheet((function(){zc.turnOffSecretMode(this._threadID);this.focus();}).bind(this));this._sheetController.onTokensChanged((function(je,ke){this._handleSheetControllerTokensChanged(ke);}).bind(this));this._nubController=new db().init(this._tabElem);this._sheetController.onResize((function(){this._nubController.flyoutContentChanged();}).bind(this));this._nubController.subscribe('resize',(function(){this._resizeInputContainer();}).bind(this));},_handleSheetControllerTokensChanged:function(je){this._updateP2PParticipants(je.tokens);cd.getThreadMeta(this._threadID,(function(ke){this._updateControls(ke,je.token_count,je.tokens);}).bind(this));this._updateMercuryMessagesViewCanonical(je);},_updateMercuryMessagesViewCanonical:function(je){if(!ta.MessengerChatTabSnapCanonialGK||!cd.isEmptyLocalThread(this._threadID))return;var ke=this._threadID;if(je.token_count===1){var le=je.tokens[0].info&&je.tokens[0].info.uid;ke=ua.getThreadIDFromUserID(le);}if(ke===this._messagesView.getThreadID())return;this._updateChatTabMessagesView(ke);this._messagesView.scrollToBottom();},_updateP2PParticipants:function(je){var ke;if(je&&je.length===1&&je[0].info&&je[0].info.uid)ke=[ua.getParticipantIDFromUserID(je[0].info.uid)];if(this._p2pButton){this._p2pButton.setProps({participantIDs:ke});}else if(this._composer)this._composer.setParticipantIDs(ke);},_initializeHeader:function(){this._initializeTitle();this._initializeCloseButton();this._initializeReactMenu();this._initializeAddToThreadButton();this._initializeVideoCallButton();this._initializeArchiveWarning();},_loadReactMenu:function(){var je=ua.isGroupChat(this._threadID),ke=cd.isNewEmptyLocalThread(this._threadID),le=this._sheetController.openAddFriendsSheet.bind(this._sheetController);pa('ChatTabMenu.react').load().done((function(me){this._reactChatTabMenu=new lb(me,this._getNode('menuContainer'));this._reactChatTabMenu.setProps({sheetController:this._sheetController,onFileUploaderMounted:this.setFilesUploader.bind(this),nameConversationFunc:(function(){return this.showNameConversation();}).bind(this),isGroupChat:je,isEmptyChat:ke,showAddFriend:le,threadID:this._threadID,otherUserID:this._getCanonicalUserID(),attachmentsShelf:this._getNode('fileAttachmentShelf'),onUploadFinished:this._unblockSend.bind(this),onUpdateAttachmentsShelf:(function(){return be(this);}).bind(this),onSubmit:this._focusInput.bind(this)},(function(){this._menuPromiseResolve(this._reactChatTabMenu);}).bind(this));}).bind(this));return this._menuPromise;},_initializeReactMenu:function(){this._menuPromise=new h((function(je){this._menuPromiseResolve=je;}).bind(this));this._listen('menuButton','click',(function(je){je.preventDefault();this._loadReactMenu().done(function(ke){ke.component.open();});}).bind(this));},_initializeArchiveWarning:function(){var je=this;if(ld){var ke=(function(){var le=je._getNode('archiveContainer');if(!le)return {v:undefined};nb.onAfterLoad((function(){n.loadModules(["ChatArchiveWarning.react"],(function(me){this._archiveWarning=new lb(me,le);this._archiveWarning.setProps({isFBAtWork:ic.is_work_user,shown:true});}).bind(this));}).bind(je));})();if(typeof ke==='object')return ke.v;}},_initializeAddToThreadButton:function(){if(ld){nb.onAfterLoad((function(){n.loadModules(["ChatAddToThreadButton.react"],(function(je){this._addToThreadButton=new lb(je,this._getNode('addToThreadContainer'));this._addToThreadButton.setProps({isFBAtWork:ic.is_work_user,onClick:this._addFriendLinkClicked.bind(this),shown:true});}).bind(this));}).bind(this));}else this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);},_initializeVideoCallButton:function(){nb.onAfterLoad((function(){n.loadModules(["ChatVideoCallButton.react"],(function(je){var ke=ua.isGroupChat(this._threadID);if(ke&&p.get('rtc_conferencing_www')){if(ld){this._videoCallButton=new lb(je,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({shown:true,isAudio:false,isGroupChat:true,userID:null,onClick:this._groupCallClicked.bind(this),onKeyUp:this._groupCallEnter.bind(this)});this._voiceCallButton=new lb(je,this._getNode('voiceCallButtonContainer'));this._voiceCallButton.setProps({shown:true,isAudio:true,isGroupChat:true,userID:null,onClick:this._groupCallClicked.bind(this),onKeyUp:this._groupCallEnter.bind(this)});}else{this._listen('videoCallLink','click',this._groupCallClicked,true);this._listen('videoCallLink','keyup',this._groupCallEnter,true);if(this._getNode('voiceCallLink')){this._listen('voiceCallLink','click',this._groupCallClicked,true);this._listen('voiceCallLink','keyup',this._groupCallEnter,true);}}}else{if(!ua.getUserIDFromThreadID(this._threadID))return;if(ld){var le=this._getCanonicalUserID();this._videoCallButton=new lb(je,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({shown:true,isAudio:false,userID:le,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});var me=this._getNode('voiceCallButtonContainer');if(me){this._voiceCallButton=new lb(je,me);this._voiceCallButton.setProps({shown:true,isAudio:true,userID:le,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)});}}else{this._listen('videoCallLink','click',this._callClicked,true);this._listen('videoCallLink','keyup',this._callEnter,true);if(this._getNode('voiceCallLink')){this._listen('voiceCallLink','click',this._callClicked,true);this._listen('voiceCallLink','keyup',this._callEnter,true);}}}}).bind(this));}).bind(this));},_initializeCloseButton:function(){this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);if(ld)nb.onAfterLoad((function(){n.loadModules(["ChatCloseButton.react"],(function(je){this._closeButton=new lb(je,this._getNode('titlebarCloseButtonContainer'));this._closeButton.setProps({active:this.isFocused(),className:"_3olu _3olv",onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)});}).bind(this));}).bind(this));},_initializeTitle:function(){if(ld){var je=cd.getThreadMetaNow(this._threadID);this._title=new lb(y,this._getNode('titleContainer'));this._title.setProps({isNewThread:cd.isNewEmptyLocalThread(this._threadID),thread:je,viewer:ca.getID()});}},_initializeTitleHREF:function(){gc.getThreadURI(this._threadID,(function(ke){return this._setTitleHref(ke);}).bind(this));if(!ua.getUserIDFromThreadID(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var je=this._getCanonicalUserID();if(this._getCanonicalUserID())va.get(ua.getParticipantIDFromUserID(je),(function(ke){if(ke.href)this._setTitleHref(ke.href);}).bind(this));},_initializeUIListeners:function(){if(this._pagesMessageIndicator)this._listen('scrollingArea','scroll',(function(event){var je=event.target;if(je.scrollHeight-je.offsetHeight!==je.scrollTop)this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.hideIndicatorAndPreventFutureShow();}).bind(this));this._listen('closeButton','click',this._closeClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);if(this._getNode('inputContainer'))this._listen('inputContainer','click',this._inputContainerClicked);this._listen('sheet','keydown',(function(event){if(!event.getModifiers().any&&event.keyCode===qa.TAB){this._focusInput();event.kill();}if(event.keyCode===qa.ESC)this._handleEscape();}).bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);},setFilesUploader:function(je){this._filesUploader=je;},_getPhotoUploaderProps:function(){return {className:"_6gd",customUI:true,imageClassName:"hidden_elem",linkClassName:"_6gb _6ge",onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)};},_initializeAutoSendPhotoUploader:function(){if(kd)return;this._photoUploader=mb.render(kb.createElement(s,this._getPhotoUploaderProps()),this._getNode('photoUploaderContainer'));},_getStickerButtonProps:function(){return {className:"_6gb _6gf",flyoutAlignment:hd,onFlyoutShown:this._onStickerFlyoutShown.bind(this),onFlyoutHidden:this._onStickerFlyoutHidden.bind(this),onLoad:(function(je){this._stickerButton=je;}).bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),threadID:this._threadID};},_initializeStickers:function(){if(kd)return;var je=this._getStickerButtonProps();mb.render(kb.createElement(m,babelHelpers._extends({bootloadPlaceholder:kb.createElement('a',{className:je.className}),bootloadLoader:pa('ChatStickerButton.react')},je)),this._getNode('stickerButtonContainer'));},_getFileUploaderProps:function(){var je=this._getPhotoUploaderProps();je.linkClassName="_6gb _6gg";je.imagesOnly=false;return je;},_initializeAutoSendFileUploader:function(){if(kd)return;if(!this._fileUploaderNode)return;this._fileUploader=mb.render(kb.createElement(s,this._getFileUploaderProps()),this._fileUploaderNode);},_initializeContentSearch:function(){if(kd)return;if(this._contentSearchNode){var je="_6gb _6gs";mb.render(kb.createElement(m,{bootloadPlaceholder:kb.createElement('a',{className:je}),bootloadLoader:pa('ChatContentSearchButton.react'),className:je,getQuery:(function(){return this._getInputValue();}).bind(this),onLoad:(function(ke){this._contentSearchButton=ke;}).bind(this),onSelect:(function(ke,le){var me=this.getInputElem();me&&me.select&&me.select();if(ke.platformFBID.toString()===ta.MessengerAppID){this._stickerSelected(ke.resultID.toString());}else{this._photoUploader&&this._photoUploader.uploadURL({attribution_app_id:ke.platformFBID,errorDialogParams:{body:oc._("\u041f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u0444\u0430\u0439\u043b\u0430 GIF \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430. \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u0444\u0430\u0439\u043b \u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437."),title:oc._("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b GIF.")},external_image_url:ke.source.url,preview_url:ke.media.preview?ke.media.preview.url:ke.media.thumbnail.url,source:ke.source});this._messagesView&&this._messagesView.scrollToBottom();}}).bind(this)}),this._contentSearchNode);aa.addClass(this._inputContainerNode,"_35li");l.bumpEntityKey('chat.web','content_search_button.mounting_attempted');}},_initializeDragDropTarget:function(){if(hc.canUploadFiles){var je=ga.scry(this._tabElem,"._1ia");if(je&&je.length>0){this._dropTarget=new ha(je[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}}},_initializeP2PChatThreadBannerContainer:function(){var je=ga.scry(this._tabElem,"._2hc2");if(je&&je.length>0){this._p2pChatThreadBannerContainerEl=je[0];nb.onAfterLoad((function(){n.loadModules(["P2PChatThreadBannerContainer.react"],(function(ke){this._p2pChatThreadBannerContainer=new lb(ke,this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable(),otherUserID:ua.getUserIDFromThreadID(this._threadID),threadID:this._threadID});}).bind(this));}).bind(this));}},_initializeP2PRainMoneyContainer:function(){if(!this._isP2PEnabled||!eb.P2PRainMoneyWWW)return false;var je=ga.scry(this._tabElem,"._3bpu");if(je&&je.length>0){this._p2pRainMoneyContainerEl=je[0];nb.onAfterLoad((function(){n.loadModules(["P2PRainMoneyContainer.react"],(function(ke){this._p2pRainMoneyContainer=new lb(ke,this._p2pRainMoneyContainerEl);this._p2pRainMoneyContainer.setProps({threadID:this._threadID,width:this._tabElem.clientWidth});}).bind(this));}).bind(this));}},setP2PChatThreadBannerContainerVisibility:function(){if(this._p2pChatThreadBannerContainer)this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable()});},isChatViewable:function(){return (this._tabElem&&aa.hasClass(this._tabElem,'opened')&&!aa.hasClass(this._tabElem,'hidden_elem'));},_initializeP2P:function(){if(kd)return;this._renderP2PButton();},_initializeUnloadListeners:function(){this._checkUnsentMessages=kc((function(){if(this._hasUnfinishedPost())return oc._("\u0412\u044b \u0435\u0449\u0435 \u043d\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u043b\u0438 \u0441\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435. \u0425\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u0439\u0442\u0438, \u043d\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0432 \u0435\u0433\u043e?");if(xc.getNumberLocalMessages(this._threadID))return oc._("\u0412\u0430\u0448\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u0432\u0441\u0435 \u0435\u0449\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f. \u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u043a\u0438\u043d\u0443\u0442\u044c \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443?");return null;}).bind(this));nb.onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=kc(ee.bind(null,this));nb.onUnload(this._logUnsentPhotos);},_handlePUSubmit:function(je,ke){ce(this,ib.UPLOAD_START,ke);xd(this,'',[],(function(le){if(this._threadID!==le.thread_id){this._newThreadIDFromPhotoUpload=le.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(le.thread_id);}le.content_attachment=null;dd.addAttachmentPlaceholder(le,ke.upload_id,ke);}).bind(this));he('submit',ke);this._focusInput();},_handlePULastUploadFailed:function(je,ke){ce(this,ib.CLIENT_ERROR,ke);he('failed',ke);dd.cancelAttachmentPlaceholder(ke.upload_id,ke);var le=oc._("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u0430\u0441\u044c"),me=oc._("\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437. \u0423\u0431\u0435\u0434\u0438\u0442\u0435\u0441\u044c, \u0447\u0442\u043e \u0432\u044b \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0435 \u043f\u0440\u0438\u0433\u043e\u0434\u043d\u0443\u044e \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044e.");if(ke.errorDialogParams){le=ke.errorDialogParams.title||le;me=ke.errorDialogParams.body||me;}rb.show(le,me);},_handlePULastUploadCanceled:function(je,ke){ce(this,ib.CANCEL_DURING_UPLOAD,ke);he('canceled',ke);dd.cancelAttachmentPlaceholder(ke.upload_id,ke);},_handlePUAllUploadsCompleted:function(je,ke){ce(this,ib.ALL_UPLOADS_DONE,ke);he('completed',ke);dd.confirmAttachmentPlaceholder(ke.upload_id,ke);var le=ke.image_ids.length||ke.attachments.length;wd(this,le);},_stickerSelected:function(je){xd(this,'',[],(function(ke){ke.has_attachment=true;ke.sticker_id=je;dd.send(ke);this.focus();}).bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_customLikeSelected:function(je,ke){xd(this,je.emoji,[],(function(le){le.has_attachment=false;dd.send(ia.setEmojiSize(le,ke));this.focus();}).bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(je){var ke=ja.symbols[je];if(!ke)return;if(kd){this._composer&&this._composer.getInput().insertEmoticon(ke);return;}if(md&&!p.get('chat_basic_input')){this._chatInput.component.insertEmoticon(ke);return;}this._selectionPosition=this._selectionPosition||new pb(this._getNode('input'));var le=ac.getInstance(this._getNode('input')),me=le.getValue(),ne=ka.insertEmoticon(ke,me,this._selectionPosition.getPos());le.setValue(ne.result);this._selectionPosition.setPos(ne.start,ne.end);},_p2pTriggered:function(){xd(this,'',[],(function(je){this.focus();}).bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_onStickerFlyoutShown:function(je){this.focus();je();this._stickersFlyoutShown=true;},_searchStickers:function(je,ke){this._stickersFlyout&&this._stickersFlyout.setProps({packID:ub.SEARCH_PACK_ID,trigger:je},ke);},_onStickerFlyoutHidden:function(){this._stickersFlyoutShown=false;if(!kd)this.focus();},_setTitleHref:function(je){if(ld){this._title&&this._title.setProps({href:je});}else{var ke=this._getNode('titlebarText');ke.setAttribute('href',je);ke.removeAttribute('rel');aa.removeClass(ke,'noLink');}},_unblockSend:function(){if(!this._blocked||zd(this))return;this._blocked=false;vd(this);this._sheetController.closeUploadWarningTabSheet();},_logOpenTab:function(){new j('/ajax/chat/opentab_tracking.php',{threadID:this._threadID,userID:this._getCanonicalUserID(),signatureID:this._signatureID}).send();}});function he(je,ke){nd.debug('photo_uploader:'+je,'{}');}function ie(je,ke){if(!ke)return je;var le=ke.getImageFiles();if(le.length>0){je.image_ids=le;je.has_attachment=true;}var me=ke.getAnimatedImageFiles();if(me.length>0){je.gif_ids=me;je.has_attachment=true;}var ne=ke.getVideoFiles();if(ne.length>0){je.video_ids=ne;je.has_attachment=true;}var oe=ke.getAudioFiles();if(oe.length>0){je.audio_ids=oe;je.has_attachment=true;}var pe=ke.getFiles();if(pe.length>0){je.file_ids=pe;je.has_attachment=true;}return je;}f.exports=de;},null);
__d('ChatTabTypeaheadDataSource',['MercuryConfig','MercuryTypeaheadConstants','MercuryTypeaheadDataSource'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k,l;k=babelHelpers.inherits(m,j);l=k&&k.prototype;function m(n){'use strict';n=n||{};n.maxResults=i.COMPOSER_CHATTAB_MAX;l.constructor.call(this,n);this.$ChatTabTypeaheadDataSource1=true;}m.prototype.buildData=function(n){'use strict';var o=[],p=[],q=[],r=[],s=[],t=[];n.forEach(function(v){var w=l.getEntry.call(this,v);switch(w.render_type){case i.FRIEND_TYPE:o.push(v);break;case i.THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource1)p.push(v);break;case i.NON_FRIEND_TYPE:q.push(v);break;case i.FB4C_TYPE:r.push(v);break;case i.PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource1)if(h.LinkedAgents&&h.LinkedAgents.indexOf(v.toString())>-1){t.push(v);}else s.push(v);break;default:this.logQuery({event:'chat_tab_render_type_error'});break;}},this);var u=t.concat(o,r,p,s,q);return l.buildData.call(this,u);};m.prototype.query=function(n,o,p,q){'use strict';this.logQuery({event:'query_chat_tab',query:n});return l.query.call(this,n,o,p,q);};m.prototype.respond=function(n,o,p){'use strict';var q=l.respond.call(this,n,o,p);this.logResponse({event:'query_response_chat_tab',response_query:n,response_uids:o});return q;};m.prototype.setShowThreads=function(n){'use strict';this.$ChatTabTypeaheadDataSource1=n;};f.exports=m;},null);
__d('NotificationJewelReminderLoader',['JSResource'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports={init:function(i){h('NotificationJewelReminder').load().done(function(j){new j(i);});}};},null);
__d('SyncRequestNotificationBeeperItemContents.react',['Animation','Image.react','ImageBlock.react','NotificationBeeperItemCloseButton.react','NotificationUserActions','React','ReactDOM','SyncRequest.react','SyncRequestStatusEnum','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=m.createClass({displayName:'SyncRequestNotificationBeeperItemContents',_markAsRead:function(){l.markNotificationsAsRead([this.props.beep.notificationID]);this.props.onHide();},_onClose:function(){this._markAsRead();this.props.onHide();},_doFlash:function(){new h(n.findDOMNode(this.refs.inner)).from('opacity','0').to('opacity','1').duration(200).go();},componentDidMount:function(){if(this.props.beep.rendererData.status!=p.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},componentDidUpdate:function(s){if(this.props.beep.rendererData.status!=p.PENDING&&s.beep.rendererData.status==p.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},onRequestStatusUpdate:function(s,t){if(s!=p.PENDING&&t==p.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},render:function(){var s=this.props.beep,t=s.rendererData;return (m.createElement('div',{ref:'inner'},m.createElement(k,{onClick:this._onClose}),m.createElement(j,{className:"_3soj"},m.createElement(i,{src:s.actors[0].profile_picture.uri,className:"_3sok"}),m.createElement('div',{className:"_3sol"},m.createElement(o,{app:t.app,creationTime:t.creation_time,requestId:t.id.toString(),receiver:t.receiver,sender:t.sender,status:t.status,timeout:t.timeout,timeRemaining:t.time_remaining,viewerId:t.receiver.id,onStatusUpdate:this.onRequestStatusUpdate})))));}});f.exports=r;},null);
__d('LiveMessageReceiver',['Arbiter','ChannelConstants','emptyFunction','shield'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m){this.eventName=m;this.subs=null;this.handler=j;this.shutdownHandler=null;this.registered=false;this.appId=1;}Object.assign(l,{getAppMessageType:function(m,n){return 'live_message/'+m+':'+n;},route:function(m){var n=function(o){var p=l.getAppMessageType(m.app_id,m.event_name);h.inform(p,o,h.BEHAVIOR_PERSISTENT);};n(m.response);}});Object.assign(l.prototype,{setAppId:function(m){this.appId=m;return this;},setHandler:function(m){this.handler=m;this._dirty();return this;},setRestartHandler:j,setShutdownHandler:function(m){this.shutdownHandler=k(m);this._dirty();return this;},_dirty:function(){if(this.registered){this.unregister();this.register();}},register:function(){var m=(function(o,p){return this.handler(p);}).bind(this),n=l.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=h.subscribe(n,m);if(this.shutdownHandler)this.subs.shut=h.subscribe(i.ON_SHUTDOWN,this.shutdownHandler);this.registered=true;return this;},unregister:function(){if(!this.subs)return this;for(var m in this.subs)if(this.subs[m])this.subs[m].unsubscribe();this.subs=null;this.registered=false;return this;}});f.exports=l;},null);
__d('initLiveMessageReceiver',['Arbiter','ChannelConstants','LiveMessageReceiver'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();h.subscribe(i.getArbiterType('app_msg'),function(k,l){j.route(l.obj);});},null);
__d('Carousel',['Animation','CSS','Ease','Locale','Slideshow','Style','cx','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q,r=k.isRTL()?'right':'left',s=j.sineInOut;p=babelHelpers.inherits(t,l);q=p&&p.prototype;function t(u,v){'use strict';q.constructor.call(this,u,v);this.subscribe('items_updated',this._updateItemState.bind(this));}t.prototype._updateItemState=function(u,v){'use strict';this._setContainerPos(u);m.set(this._container,'width',this._items.length*this._config.width+'px');};t.prototype._updateArrowState=function(u){'use strict';if(!this._config.arrows)return;var v=this._config.wrap,w=this._items.length,x=Math.floor(w/this._config.photosperframe);i.conditionClass(this._arrowNext,"_2xo",x===1||!v&&u===x-1);i.conditionClass(this._arrowPrev,"_2xo",x===1||!v&&u===0);};t.prototype._animate=function(u,v){'use strict';var w=u===-1?this._items.length-1:u,x=0;if(this._config.peek_with_offset){x=-u*(this._config.width-this._config.peek*2);if(u>0)x=x+this._config.peek-u*(this._config.item_margin/2);if(u===this._items.length-1)x+=this._config.peek;}else x=-u*this._config.width;this._animating=true;this.inform('page_start',w);new h(this._container).to(r,x).duration(this._config.animationDuration).ease(s).ondone(v).go();};t.prototype._setContainerPos=function(u){'use strict';m.set(this._container,r,-u*this._config.width+'px');};t.prototype._animateTo=function(u){'use strict';if(this._animating)return;var v=this._items.length;if(0<=u&&u<v||!this._config.wrap){var w=(u+v)%v;this._updateArrowState(w);return this._animate(w,o(this._setCurrent,this,w));}var x=u%v,y=x?v-1:0,z=this._items[v-1];m.set(z,'position','absolute');m.set(z,r,-this._config.width+'px');if(y===0)this._setContainerPos(-1);this._animate(x,(function(){m.set(z,'position','static');m.set(z,r,'auto');this._setContainerPos(y);this._setCurrent(y);}).bind(this));};f.exports=t;},null);