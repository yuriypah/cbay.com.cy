/*!CK:3908092889!*//*1454539300,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["jCNqN"]); }

__d("TagExpansionButtonConfig",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={FRIENDS_OF_TAGGED:"friends_of_tagged",TAGGED_ONLY:"tagged_only"};},null);
__d('EntstreamStoryDeduper',['CSS','DOM','csx'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=function(o,p,q,r){var s=i.scry(o,p||"._5jmm").filter(q),t={};for(var u=0;u<s.length;u++){var v=s[u],w=v.getAttribute('data-dedupekey');if(t[w]){r(v);}else t[w]=1;}},l=function(o){return !!o.getAttribute('data-dedupekey');},m=function(o){return l(o)&&h.shown(o);},n={dedupe:function(o,p){k(o,p,l,function(q){return i.remove(q);});},dedupeHide:function(o,p){k(o,p,m,function(q){return h.hide(q);});}};f.exports=n;},null);
__d("XFeedSeeFirstStoryController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/feed\/control\/see_first\/story\/",{});},null);
__d('SeeFirstStoryLogger',['AsyncRequest','XFeedSeeFirstStoryController'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=function(){var k=i.getURIBuilder().getURI();new h(k).send();};f.exports={log:j};},null);
__d('LitestandColumnManager',['Arbiter','BlueBar','Event','NavigationMessage','Run','SubscriptionsHandler','clamp','ge','getScrollPosition'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=0,r=null;function s(){if(r)return;r=new m();r.addSubscriptions(h.subscribe(k.NAVIGATION_BEGIN,function(){v(0);t();}),h.subscribe('ufi/didUpdate',function(y,z){if(z.offsetY)x.adjustVerticalWindowPosition(p(window),z.offsetY);}),j.listen(window,'resize',function(){if(!i.hasFixedBlueBar()){v(0);t();}}),j.listen(window,'scroll',function(){if(!u())t();}));l.onLeave(function(){return r&&r.release();});}function t(){r.release();r=null;}function u(){if(q<=0)return false;v(n(p(window).y,0,q));return q>0;}function v(y){if(y===q)return;w('leftCol',y);w('rightCol',y);q=y;}function w(y,z){var aa=o(y);if(aa)aa.style.marginTop=z?z+'px':'';}var x={adjustVerticalWindowPosition:function(y,z){s();v(z);window.scrollTo(y.x,y.y+q);}};f.exports=x;},null);
__d('runAfterScrollingStops',['Arbiter','Event','Run','debounceAcrossTransitions','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(x,y,z){if(y&&p[y])return;if(!o){h.subscribe('page_transition',w);o=true;}if(!n){x();return;}y&&(p[y]=1);q.push(x);if(!z){if(s){j.onLeave(w);s=false;}r.push(q.length-1);}}var n,o,p={},q=[],r=[],s=true,t=500,u=k(function(){n=false;var x=q;q=[];r=[];p={};for(var y=0,z=x.length;y<z;++y)x[y]();},t);function v(){n=true;u();}function w(){var x=r;r=[];s=true;for(var y=0,z=x.length;y<z;++y)q[x[y]]=l;}i.listen(window,'scroll',v);f.exports=m;},null);
__d('LitestandOffscreenController',['Arbiter','CSS','DOMQuery','Event','getFullScreenElement','NavigationMessage','Run','Scroll','Style','SubscriptionsHandler','Vector','cx','csx','getOrCreateDOMID','queryThenMutateDOM','runAfterScrollingStops','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){if(c.__markCompiled)c.__markCompiled();var y=1,z=9,aa=10,ba={},ca=false,da,ea,fa,ga,ha=[];function ia(){da&&da.release();da=null;ca=false;}function ja(){ba={};ha=[];}function ka(){if(i.hasClass(document.body,"_5vb_"))return aa;return z;}function la(){ga=ga||r.getViewportDimensions().y;ea=r.getScrollPosition().y;fa=ea+ga;if(y){ea-=ga*y;fa+=ga*y;}for(var ta in ba){var ua=ba[ta];ua.position=r.getElementPosition(ua.element).y;if(!ua.hidden)ua.height=ua.element.offsetHeight;}}function ma(){var ta=[],ua=l();for(var va in ba){var wa=ba[va],xa=wa.position,ya=xa+wa.height<ea,za=xa>fa;if(!ua&&!wa.hidden&&(ya||za)){na(wa);}else if(!ya&&!za){wa.pendingHide=false;if(wa.hidden){if(wa.dirty&&xa<ea){ta.push(va);i.addClass(oa(wa),"_49nu");}else p.apply(wa.element,{height:'',marginBottom:''});i.show(oa(wa));wa.dirty=false;wa.hidden=false;}}}if(!ta.length)return;var ab=0;v(function(){for(var bb=0,cb=ta.length;bb<cb;bb++){var db=ba[ta[bb]];ab+=db.height-oa(db).offsetHeight+p.getFloat(db.element,'marginBottom');}},function(){for(var bb=0,cb=ta.length;bb<cb;bb++){var db=ba[ta[bb]];i.removeClass(oa(db),"_49nu");p.apply(db.element,{height:'',marginBottom:''});}ab&&o.setTop(document.body,o.getTop(document.body)-ab);});}function na(ta){if(!ta.pendingHide){ha.push(ta);ta.pendingHide=true;}}function oa(ta){if(ta.wrapperElement)return ta.wrapperElement;var ua=ta.element;if(ua.firstElementChild)return ta.wrapperElement=ua.firstElementChild;for(var va=0;va<ua.childNodes.length;va++)if(ua.childNodes[va].tagName)return ta.wrapperElement=ua.childNodes[va];}function pa(){var ta=ka()+'px';for(var ua=0;ua<ha.length;ua++){var va=ha[ua];if(j.scry(va.element,"._52fb").length)va.pendingHide=false;if(va&&va.element&&va.pendingHide&&!va.hidden){p.apply(va.element,{height:va.height+'px',marginBottom:ta});i.hide(oa(va));va.hidden=true;va.pendingHide=false;}}ha=[];}function qa(){w(pa,'LitestandOffscreenController/hide');v(la,ma,'LitestandOffscreenController');}function ra(){n.onLeave(ia);da=new q();da.addSubscriptions(h.subscribe(m.NAVIGATION_BEGIN,ja),k.listen(window,'scroll',x(qa)),k.listen(window,'resize',x(function(){ga=null;qa();})));ca=true;}var sa={attachSubstream:function(ta){ca||ra();ba[u(ta)]={element:ta};}};f.exports=sa;},null);
__d('LitestandNewStoryController',['Animation','Arbiter','AsyncRequest','BlueBar','LitestandColumnManager','LitestandMessages','LitestandStream','Style','$','getScrollPosition','queryThenMutateDOM','requestAnimationFrame','setImmediate'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=50,v=600,w=500,x,y,z;function aa(){z&&clearTimeout(z);z=null;}function ba(){z=setTimeout(function(){z=null;ca();},w);}function ca(){var ia;r(function(){ia=n.canInsertNewerStories();},function(){if(ia){fa();}else ba();},'LitestandNewStoryController/tryShowingStories');}function da(ia){var ja=new h(ia).from('opacity',0).to('opacity',1).duration(v);ja.go();setTimeout(function(){ja.stop();o.set(ia,'opacity',1);},v+200);}function ea(ia){aa();if(!y)return;var ja=y.nextSibling;if(ia&&ja)var ka=ja.offsetTop;o.apply(y,{height:'',left:'',overflow:'',position:'',width:''});if(ia){var la=ja.offsetTop+u,ma=la-ka,na=q(window);l.adjustVerticalWindowPosition(na,ma);s(function(){l.adjustVerticalWindowPosition(na,ma);da(y);if(x){x.setAtTop();x.show(ma);}});}else da(y);i.inform(m.STORIES_INSERTED);i.inform(m.NEWER_STORIES_INSERTED);t(function(){return i.inform('reflow');});new j().setURI('/ajax/litestand/update_filter_viewtime').setData({section_id:n.getSectionID()}).send();}function fa(){ea(k.hasFixedBlueBar());}function ga(){ea(false);}var ha={waitForDisplay:function(ia){if(!y)y=p(ia);if(n.canInsertNewerStories()){fa();}else ba();},showStoriesNow:function(ia){y=ia;ga();},setNewStoryPill:function(ia){x=ia;}};f.exports=ha;},null);
__d('LitestandStreamLoader',['$','Arbiter','Bootloader','CSS','DOM','EntstreamStoryDeduper','Event','JSXDOM','LitestandMessages','LitestandOffscreenController','LitestandStoryInsertionStatus','LitestandStream','NavigationMessage','OnVisible','Run','UserActivity','ge','getElementPosition','getOrCreateDOMID','getUnboundedScrollPosition','getViewportDimensions','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){if(c.__markCompiled)c.__markCompiled();var da=0,ea=false,fa={},ga,ha,ia,ja,ka,la,ma=0,na,oa,pa=[],qa=0,ra,sa;function ta(){v.onLeave(ua);da=0;pa=[i.subscribe(t.NAVIGATION_BEGIN,ua),i.subscribe(p.NEWER_STORIES_INSERTED,function(){sa=null;})];pa.push(i.subscribe('layer_shown',function(kb,lb){if(lb&&lb.type==='DialogX')da++;}),i.subscribe('layer_hidden',function(kb,lb){if(lb&&lb.type==='DialogX')da--;}));r.registerBlocker(function(){return da>0;});ea=true;}function ua(){i.inform(p.LEAVE_HOME);fa={};oa=null;ma=0;pa.forEach(i.unsubscribe);pa=[];ga&&ga.remove();ka&&clearTimeout(ka);ka=null;ja=null;sa=null;na&&na.remove();na=null;ea=false;qa=0;}function va(kb){ka&&clearTimeout(ka);ka=setTimeout(function(){ka=null;bb();},kb);}function wa(){if(oa&&ja&&oa.pollIntervalMS&&oa.pollIntervalMS>1000){w.setIdleTime(oa.newStoryIdleTime);va(oa.pollIntervalMS);}}function xa(){ga=new u(l.find(ha,'a'),ib.bind(null),false,oa.bufferPixels);}function ya(){var kb=aa(window).y;return kb>oa.firstPagerScrollBuffer;}function za(){if(ya()){xa();na&&na.remove();na=null;}}function ab(kb){var lb=l.find(ha,'a');n.listen(lb,'click',function(event){ib();na&&na.remove();na=null;event.preventDefault();});var mb=y(ha),nb=ba();if(kb&&mb.y<nb.height){ib();}else if(kb&&!ya()){na=n.listen(window,'scroll',ca(za));}else xa();}function bb(){if(!ja)return;if(!w.isActive(oa.newStoryIdleTime)){w.subscribeOnce(bb);return;}if(w.hasBeenInactive()){w.resetActiveStatus();var kb=oa.pollIntervalMS,lb=Date.now()-w.getLastInActiveEnds();if(lb<kb){va(kb-lb);return;}}if(!s.canInsertNewerStories()){va(oa.pollIntervalMS);return;}cb();}function cb(){if(!ja)return;ka&&clearTimeout(ka);if(!sa){var kb=s.getStreamRoot();sa=o.div({style:{height:0,width:kb.offsetWidth+'px',left:'-10000px',opacity:0,overflow:'hidden',position:'absolute'}});l.prependContent(kb,sa);i.inform(p.NEW_STORIES_CONTAINER_CREATED,sa);}var lb=o.div(null);l.prependContent(sa,lb);j.loadModules(["UIPagelet"],function(mb){mb.loadFromEndpoint('LitestandNewerStoriesPagelet',lb,Object.assign(ja,{cursor:ra,containerID:z(sa)}),{crossPage:true});});}function db(){var kb=z(ha);k.addClass(ha,'async_saving');var lb=gb(),mb=lb.cursor,nb=lb.storiesCount;if(fa[mb])throw new Error('This cursor has been used before, stories will be '+'repeated. Cursor: '+mb);fa[mb]=mb;var ob={cursor:mb,pager_config:ia,pager_id:kb,scroll_count:++ma,feed_stream_id:s.getFeedStreamID(),client_stories_count:nb};j.loadModules(["UIPagelet"],function(pb){pb.loadFromEndpoint(oa.pagerController,z(la),ob,{append:true,automatic:true,usePipe:true,crossPage:oa.crossPage,errorHandler:eb,transportErrorHandler:eb});i.inform(p.STORIES_REQUESTED);});}function eb(kb){var lb=gb();delete fa[lb.cursor];k.removeClass(ha,'async_saving');}function fb(){var kb=hb();if(kb.length){return kb[0].getAttribute('data-cursor');}else return ha&&ha.getAttribute('data-cursor');}function gb(){var kb=hb(),lb={};if(kb.length){lb.cursor=kb[kb.length-1].getAttribute('data-cursor');lb.storiesCount=kb.length;}else{lb.cursor=ha&&ha.getAttribute('data-cursor');lb.storiesCount=0;}return lb;}function hb(){var kb=l.scry(la,s.getStoriesSelector());return kb.filter(function(lb){return lb.getAttribute('data-cursor');});}function ib(){db();ga&&ga.remove();ga=null;}var jb={register:function(kb,lb,mb,nb){ea||ta();oa=babelHelpers._extends({bufferPixels:1000,firstPagerScrollBuffer:100,pagerController:'LitestandMoreStoriesPagelet',pollIntervalMS:null,newStoryIdleTime:60000},lb);ia=mb;la=h(kb);ra=fb();ha=nb;ab(true);wa();},removeOldPager:function(kb,lb){if(kb)l.remove(h(kb));k.show(h(lb));},removeLoadingIndicator:function(kb,lb){var mb=x(kb);if(mb)l.remove(mb);k.show(lb);},moreStoriesInserted:function(kb){i.inform(p.STORIES_INSERTED,{substream_id:kb});var lb=h(kb);q.attachSubstream(lb);},attachNewPager:function(kb){m.dedupeHide(s.getStreamRoot(),s.getStoriesSelector());ha=kb;ha&&ab(false);},setPollerData:function(kb){if(kb){ja=kb;wa();}},headLoadCompleted:function(kb){ra=kb.newCursor;wa();var lb=kb.stories;if(lb&&lb.length>0){for(var mb=lb.length-1;mb>=0;mb--)lb[mb].setAttribute('data-insertion-position',--qa);m.dedupe(s.getStreamRoot(),s.getStoriesSelector());i.inform('Stream/totalHeadLoadedStories',{count:-qa});}},forceNewFetch:cb};f.exports=jb;},null);
__d('PhotosUploadWaterfallMixin',['PhotosUploadWaterfall','emptyFunction'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=i,k={getUploaderApp:j,getWaterfallID:j,getAdditionalData:function(){return {};},logWaterfallStep:function(l,m,n){h.sendSignal(babelHelpers._extends({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:l,ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),m),n);},logWaterfallStepUsingBanzai:function(l,m,n){h.sendBanzai(babelHelpers._extends({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:l,ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),m),n);}};f.exports=k;},null);
__d('PhotoSourceTypes',['keyMirror'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();f.exports=h({COMPUTER:null,POSTED_PHOTOS:null,SYNCED_PHOTOS:null,SUGGESTIONS:null,PAGES_POSTED_PHOTOS:null});},null);
__d('BaseSelectionContainer',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=0;function i(){'use strict';this.$BaseSelectionContainer1=(h++).toString();}i.prototype.getSelectionContainerID=function(){'use strict';return this.$BaseSelectionContainer1;};i.prototype.getSource=function(){'use strict';throw 'This must be implemented by the child class';};i.prototype.getName=function(){'use strict';return null;};i.prototype.getSize=function(){'use strict';return null;};i.prototype.hasPlaceholderUI=function(){'use strict';throw 'This must be implemented by the child class';};f.exports=i;},null);
__d('SelectionSource',['PhotoSourceTypes'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={FILE:'file',FLASH:'flash',VAULT:'vault',SUGGESTIONS:'suggestions',POSTED_PHOTOS:'posted_photos',PAGES_POSTED_PHOTOS:'pages_posted_photos',toPhotoSourceType:function(j){switch(j){case i.FILE:case i.FLASH:return h.COMPUTER;case i.VAULT:return h.SYNCED_PHOTOS;case i.SUGGESTIONS:return h.SUGGESTIONS;case i.POSTED_PHOTOS:return h.POSTED_PHOTOS;case i.PAGES_POSTED_PHOTOS:return h.PAGES_POSTED_PHOTOS;default:throw 'No mapping for SelectionSource: '+j;}}};f.exports=i;},null);
__d('FileSelectionContainer',['BaseSelectionContainer','SelectionSource'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;j=babelHelpers.inherits(l,h);k=j&&j.prototype;function l(m){'use strict';k.constructor.call(this);this.$FileSelectionContainer1=m;}l.prototype.getFile=function(){'use strict';return this.$FileSelectionContainer1;};l.prototype.getSource=function(){'use strict';return i.FILE;};l.prototype.getName=function(){'use strict';return this.$FileSelectionContainer1.fileName||this.$FileSelectionContainer1.name;};l.prototype.getSize=function(){'use strict';return this.$FileSelectionContainer1.fileSize||this.$FileSelectionContainer1.size;};l.prototype.hasPlaceholderUI=function(){'use strict';return false;};f.exports=l;},null);
__d('FilePickerEvent',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={BEGIN:'FilePickerEvent/BEGIN',SELECT_START:'FilePickerEvent/SELECT_START',SELECTED:'FilePickerEvent/SELECTED_FILES',ALBUM_LIMIT_EXCEEDED:'FilePickerEvent/ALBUM_LIMIT_EXCEEDED',SESSION_LIMIT_EXCEEDED:'FilePickerEvent/SESSION_LIMIT_EXCEEDED',SELECT_CANCELED:'FilePickerEvent/SELECT_CANCELED',FALLBACK:'FilePickerEvent/FALLBACK'};},null);
__d('HTML5FilePicker',['ArbiterMixin','BrowserSupport','CSS','DOM','FilePickerEvent','FileSelectionContainer','Parent','PhotosUploadID','PhotosUploadWaterfall','PhotosUploadWaterfallMixin','PhotosUploadWaterfallXMixin','PUWApplications','PUWSteps','URI','cx','getOrCreateDOMID'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();function x(y,z){this._config=babelHelpers._extends({accept:undefined,multiple:undefined},z);this._button=y;this._beginInformed=false;if(!i.hasFileAPI()){this.logStep(t.CLIENT_PROCESS_UNAVAILABLE,{error:'no_file_api'});if(this._config.hasOwnProperty('fallbackFunction')){this._config.fallbackFunction.call(this);return;}return;}this._subscriptions=[];var aa=this._config.input||k.create('input',{type:'file',className:"_n"});if(this._config.hasOwnProperty('accept'))aa.accept=this._config.accept;if(this._config.hasOwnProperty('multiple'))aa.multiple=this._config.multiple;if(this._config.hasOwnProperty('title'))aa.title=this._config.title;var ba=k.create('label',{className:'accessible_elem','for':w(aa)},aa.title),ca=k.create('div',{className:"_3jk"},[ba,aa]);j.addClass(this._button,"_m");k.appendContent(this._button,ca);this._button.setAttribute('rel','ignore');this._bindInput(aa);var da=n.byClass(this._button,'addPhotosDisabled');if(da){j.removeClass(da,'addPhotosDisabled');j.addClass(da,'addPhotosEnabled');}}Object.assign(x.prototype,h,q,r,{getUploaderApp:function(){return p.APP_HTML5;},getWaterfallID:function(){return this._config.qn;},getWaterfallAppName:function(){return s.WEB_HTML5;},getWaterfallSource:function(){return this._config.ref;},getSwfID:function(){return null;},_constructFileList:function(){var y=Array.from(this._input.files);y.forEach(function(z){z.uploadID=o.getNewID();});return y;},_constructFileSelectionContainerList:function(){var y=Array.from(this._input.files);return y.map(function(z){return new m(z);});},cleanup:function(){if(this._input){this._input.onclick=null;this._input.onchange=null;}},_bindInput:function(y){this.cleanup();y.onclick=(function(){this.logWaterfallStep(p.SELECT_START);if(!this._beginInformed){this._beginInformed=true;this.inform(l.BEGIN||'FilePickerEvent/BEGIN');}this.inform(l.SELECT_START);}).bind(this);y.onchange=(function(){this.inform(l.SELECTED,{sender:this,files:this._constructFileList(),selections:this._constructFileSelectionContainerList()});this._bindInput(this._input.cloneNode(false));}).bind(this);if(this._input)k.replace(this._input,y);this._input=y;}});f.exports=x;},null);
__d('UploadSession',['AsyncRequest','FilePickerEvent','PhotosUploadWaterfall','PUWSteps','URI','arrayContains'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={};function o(q){'use strict';this._sessionID=q;this._asyncBootstrapped=false;this._controller=null;this._overlay=null;this._pickers=[];this._pendingFileLists=[];this._beginLogged=false;this._albumLimitWasExceeded=false;this._sessionLimitWasExceeded=false;}o.prototype.addFilePicker=function(q){'use strict';if(!m(this._pickers,q)){this._pickers.push(q);if(this._controller&&q.getSwfID&&q.getSwfID())this._controller.preregisterSwf&&this._controller.preregisterSwf(q.getSwfID());q.subscribe(i.BEGIN,(function(r,s){if(!this._beginLogged){this._beginLogged=true;q.logWaterfallStep(j.BEGIN);q.logStep(k.CLIENT_FLOW_BEGIN);}}).bind(this));q.subscribe(i.SELECTED,(function(r,s){q.logStep(k.CLIENT_SELECT_SUCCESS,{volume:s.files.length});if(this._controller){this._controller.uploadFiles(s.files);}else this._pendingFileLists.push(s);if(this._asyncBootstrapped)return;var t=q._button,u=new l(t.getAttribute('ajaxify'));u.addQueryData('num_selected',s.files.length);h.bootstrap(u.toString(),t,true);this._asyncBootstrapped=true;}).bind(this));q.subscribe(i.SELECT_START,(function(){q.logStep(k.CLIENT_SELECT_BEGIN);}).bind(this));q.subscribe(i.SELECT_CANCELED,(function(){q.logStep(k.CLIENT_SELECT_CANCEL);if(!this._overlay){q.logStep(k.CLIENT_FLOW_CANCEL);this._beginLogged=false;}}).bind(this));q.subscribe(i.ALBUM_LIMIT_EXCEEDED,(function(){if(this._controller){this._controller.albumLimitExceeded();}else this._albumLimitWasExceeded=true;}).bind(this));q.subscribe(i.SESSION_LIMIT_EXCEEDED,(function(){if(this._controller){this._controller.sessionLimitExceeded();}else this._sessionLimitWasExceeded=true;}).bind(this));}};o.prototype.addController=function(q){'use strict';this._controller=q;this._asyncBootstrapped=true;var r=this._controller.getWaterfallID?this._controller.getWaterfallID():this._controller.getWaterfallConfig().waterfallID,s=this._controller.getUploaderApp?this._controller.getUploaderApp():this._controller.getWaterfallConfig().waterfallApp;if(!this._beginLogged){this._beginLogged=true;j.sendSignal({qn:r,step:j.BEGIN,uploader:s});}if(this._pendingFileLists.length){var t=[];this._pendingFileLists.forEach(function(u){t=t.concat(u.files);});this._controller.uploadFiles(t);}else j.sendSignal({qn:r,step:j.OVERLAY_FIRST,uploader:s});if(this._albumLimitWasExceeded)this._controller.albumLimitExceeded();if(this._sessionLimitWasExceeded)this._controller.sessionLimitExceeded();};o.prototype.addOverlay=function(q){'use strict';this._overlay=q;};o.prototype.addOverlayAndController=function(q,r){'use strict';this.addOverlay(q);this.addController(r);};o.addFilePickerToSession=function(q,r){'use strict';p(q).addFilePicker(r);};o.addControllerToSession=function(q,r){'use strict';p(q).addController(r);};o.addOverlayToSession=function(q,r){'use strict';p(q).addOverlay(r);};o.addOverlayAndControllerToSession=function(q,r,s){'use strict';p(q).addOverlayAndController(r,s);};function p(q){if(!n[q])n[q]=new o(q);return n[q];}f.exports=o;},null);
__d('PrivacyEdDialog.react',['DOMContainer.react','LayerHideOnBlur','React','XUIContextualDialog.react','XUIContextualDialogBody.react'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'PrivacyEdDialog',propTypes:{context:m.object,dialogContent:m.object},render:function(){return (j.createElement(k,{context:this.props.context,shown:true,position:'below',alignment:'center',width:300,behaviors:{LayerHideOnBlur:i}},j.createElement(l,null,j.createElement(h,null,this.props.dialogContent))));}});f.exports=n;},null);
__d('MetaComposerEdDialog',['Arbiter','AsyncRequest','DOM','React','ReactRenderer','PrivacyEdDialog.react','Vector'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=null;function p(q){this._dialog=null;this.config=q;this._text_container=q.text_container;this._container=q.dialog_container;this._init();}p.init=function(q){if(o){o.config.show_audience=q.show_audience;return;}o=new p(q);};Object.assign(p.prototype,{_init:function(){h.subscribe(['ComposerXStatusAttachment/ready','ReactComposerStatusLazyAttachment/mounted','ReactComposerStatusEagerAttachment/mounted','composer/ready'],(function(){if(this.config.show_audience){this._sendEducationRequest({},'/ajax/composer/audience/education',this._handlerCustomDuration.bind(this,6000));this.config.show_audience=false;}}).bind(this));if(this.config.show_sticky)h.subscribe(['composer/mutate','ComposerXBootloadStatusAttachment/mutate','ReactComposerStatusEagerAttachment/mounted'],(function(q,r){this._sendEducationRequest({sticky_num:this.config.n_sticky_shown},'/ajax/composer/audience/sticky_education',this._handler.bind(this));}).bind(this));if(this.config.show_tags)h.subscribe(['SelectedPrivacyOption/changed','PrivacySelectorBase/changed'],(function(q,r){this._sendEducationRequest({ids:r.tags,from:'WithTagger',hasEvent:r.hasEvent,type:r.privacy,tag_num:this.config.n_tag_shown},'/ajax/composer/audience/tag_education',this._handler.bind(this));}).bind(this));},_sendEducationRequest:function(q,r,s){if(!this._getContext())return;this._async&&this._async.abort();this._async=new i(r);this._async.setData(q).setHandler(s).send();},_getContext:function(){var q=j.scry(document.body,'div.composerAudienceWrapper'),r,s;for(var t=0;t<q.length;t++){r=q[t];s=n.getElementPosition(r);if(r&&s.x>0&&s.y>0)return r;}return null;},_handler:function(q){this._handlerCustomDuration(1500,q);},_handlerCustomDuration:function(q,r){var s=r.payload,t=this._getContext();if(!s||!t)return;this._dialog=l.constructAndRenderComponent(m,{context:t,dialogContent:this._text_container},this._container);j.setContent(this._text_container,s);}});f.exports=p;},null);
__d('PrivacySelectorOptionNew',['CSS','DOM','DOMQuery','JSXDOM','MenuSelectableItem','PrivacyConst','csx','cx','fbt','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;r=babelHelpers.inherits(t,l);s=r&&r.prototype;function t(u){'use strict';s.constructor.call(this,u);this.updateAfterTagExpansion(!!u.hasTags);}t.prototype._getData=function(){'use strict';return this._data;};t.prototype.getTooltip=function(){'use strict';return this._getData().tooltip;};t.prototype.getPostParam=function(){'use strict';return this._getData().postParam.toString();};t.prototype.getTriggerIcon=function(){'use strict';return this._getData().triggerIcon;};t.prototype.getTriggerLabel=function(){'use strict';return this._getData().triggerLabel;};t.prototype.isPublic=function(){'use strict';return this.getPostParam()===m.PostParam.EVERYONE;};t.prototype.isFriends=function(){'use strict';return this.getPostParam()===m.PostParam.FRIENDS;};t.prototype.isOnlyMe=function(){'use strict';return this.getPostParam()===m.PostParam.ONLY_ME;};t.prototype.isBasicOption=function(){'use strict';return true;};t.prototype.isCustomOption=function(){'use strict';return false;};t.prototype.getTagExpansionBehavior=function(){'use strict';return this._getData().tagExpansionBehavior;};t.prototype.getBaseValue=function(){'use strict';return this._getData().baseValue;};t.prototype.getIndex=function(){'use strict';return this._getData().value;};t.prototype.getLoggingEventName=function(){'use strict';switch(this.getPostParam()){case m.PostParam.FRIENDS:return 'click_friends';case m.PostParam.EVERYONE:return 'click_everyone';case m.PostParam.ONLY_ME:return 'click_only_me';case m.PostParam.FRIENDS_MINUS_ACQUAINTANCES:return 'click_friends_except_acquaintances';case m.PostParam.FB_ONLY:return 'click_fb_only';default:return 'click_other';}};t.prototype.updateAfterTagExpansion=function(u){'use strict';var v=this._getData().triggerLabel;if(u&&this._getData().showPlusOnTagExpansion)v=p._("{privacyLabel} (+)",[p.param('privacyLabel',this._getData().triggerLabel)]);this._setLabel(v);var w=this._getExpansionType(u),x=this._getData().optionSubtitles||{};this._setSubtitle(x[w]);};t.prototype.isBelowFold=function(){'use strict';var u=h.hasClass(this.getRoot(),"_3ey_");return u;};t.prototype._setLabel=function(u){'use strict';if(!u)return;var v=j.find(this.getRoot(),"._54nh");v&&i.setContent(v,u);this._getData().label=u;};t.prototype._setSubtitle=function(u){'use strict';if(!u)return;var v=j.find(this.getRoot(),"._48u1");v&&i.setContent(v,u);};t.prototype._getExpansionType=function(u){'use strict';return u?m.ExpansionType.TAGS_ONLY:m.ExpansionType.NONE;};t.prototype.render=function(){'use strict';var u=s.render.call(this);if(!this._getData().isPrimaryOption)return u;var v=j.find(u,"._54nc");v&&h.addClass(v,"_48t_");var w=i.find(u,"._54nh");w&&h.addClass(w,"_48u0");var x=k.div({className:"_48u1"},this._getData().optionSubtitle);i.appendContent(v,x);return u;};f.exports=t;},null);
__d("XPrivacySelectorLoggingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/privacy\/selector\/log\/",{event:{type:"Enum",required:true,enumType:1},render_location:{type:"Int",required:true},content_type:{type:"String",required:true}});},null);
__d('PrivacySelectorCustomOption',['AsyncDialog','AsyncRequest','DataStore','PrivacySelectorOptionNew','XPrivacySelectorLoggingController','XPrivacyCustomDialogController'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;n=babelHelpers.inherits(p,k);o=n&&n.prototype;function p(q){'use strict';o.constructor.call(this,q);}p.prototype.isBasicOption=function(){'use strict';return false;};p.prototype.isCustomOption=function(){'use strict';return true;};p.prototype.getSelector=function(){'use strict';return this._selector;};p.prototype.setPostParam=function(q){'use strict';this._data.postParam=q;};p.prototype.getLoggingEventName=function(){'use strict';return 'click_custom';};p.prototype.openDialog=function(q){'use strict';if(typeof this._selector==='undefined')this._selector=q;j.set(this._data.id,'PrivacySelectorCustomOption',this);var r=m.getURIBuilder().setString('option_id',this._data.id).setString('id',this._data.privacyfbid.toString()).setString('post_param',q.getPostParam()).setString('content_type',q.getContentType()).setInt('render_location',q.getRenderLocation()).setIntVector('tags',q.getTags()).setBool('autosave',this._data.autosave).setBool('limit_community',this._data.limitcommunity).setBool('limit_facebook',this._data.limitfacebook).setBool('limit_fof',this._data.limitfof).setBool('limit_tagexpand',this._data.limittagexpand).setBool('is_new_privacy_selector',true).setString('tag_expansion_button',q.getTagExpansionButton()).getURI(),s=new i(r);s.setRelativeTo(q.getTriggerButtonElement());h.send(s,function(t){var u=function(v){var w=l.getURIBuilder().setEnum('event',v).setInt('render_location',document.getElementsByName('render_location')[0].value).setString('content_type',document.getElementsByName('content_type')[0].value).getURI();new i().setURI(w).send();};t.subscribe('hide',function(){q.inform('custom/hide');q.inform('selectorFinished');});t.subscribe('success',function(){q.inform('custom/success');u('custom_save');});t.subscribe('cancel',function(){q.inform('custom/cancel');u('custom_cancel');});});};p.customPrivacySave=function(q,r){'use strict';var s=j.get(q,'PrivacySelectorCustomOption');s.getSelector().selectOption(r);j.remove(q,'PrivacySelectorCustomOption');};f.exports=p;},null);
__d('PrivacySelectableMenu',['Arbiter','AsyncRequest','CSS','Ease','PrivacySelectorCustomOption','PrivacySelectorOptionNew','SelectableMenu','SelectableMenuUtils','XPrivacySelectorLoggingController','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;r=babelHelpers.inherits(t,n);s=r&&r.prototype;function t(u,v){'use strict';s.constructor.call(this,u,v);}t.prototype.getItemForIndex=function(u){'use strict';for(var v=0;v<this._items.length;v++){var w=this._items[v];if(w instanceof m&&w.getIndex()==u)return w;}return null;};t.prototype.selectDefaultOption=function(){'use strict';this._items.some(function(u){if(u instanceof m&&this._isDefaultOption(u)){this.setValue(u.getIndex());return true;}return false;},this);};t.prototype.selectOption=function(u){'use strict';var v=null,w=this._items.some(function(x){if(x instanceof m&&!x.isCustomOption()&&x.getPostParam()==u){this.setValue(x.getIndex());return true;}if(x instanceof l){v=x;return false;}if(this._isMoreOption(x)){this.expandMenu();return false;}},this);if(!w&&v){v.setPostParam(u);this.setValue(v.getIndex());}};t.prototype._isDefaultOption=function(u){'use strict';return j.hasClass(u.getRoot(),"_plx");};t.prototype._isMoreOption=function(u){'use strict';return j.hasClass(u.getRoot(),"_po2");};t.prototype._handleItemClick=function(u,v){'use strict';if(!o.doesItemSupportSelect(u))return s._handleItemClick.call(this,u,v);if(this._isMoreOption(u)){this._logMoreClick();this.expandMenu();return;}this._logOptionClick(u);var w=this.inform('itemclick',{item:u,event:v});if(w)return;if(!o.isSelected(u)&&!u.isCustomOption()&&u.select()!==false){this._items.forEach(function(x){if(o.isSelected(x)&&x!==u)x.deselect();});this.inform('change',this.getSelection());}h.inform('composerprivacy/aborteducation');this.done();return u.handleClick();};t.prototype._logMoreClick=function(){'use strict';var u=p.getURIBuilder().setEnum('event','more_options').setInt('render_location',this._config.renderlocation).setString('content_type',this._config.contenttype).getURI();new i().setURI(u).send();};t.prototype._logOptionClick=function(u){'use strict';var v=p.getURIBuilder().setEnum('event',u.getLoggingEventName()).setInt('render_location',this._config.renderlocation).setString('content_type',this._config.contenttype).getURI();new i().setURI(v).send();};t.prototype.expandMenu=function(){'use strict';j.removeClass(this.getRoot(),"_po3");j.addClass(this.getRoot(),"_po4");this.inform('expandMenu');};t.prototype.collapseMenu=function(){'use strict';j.removeClass(this.getRoot(),"_po4");j.addClass(this.getRoot(),"_po3");};t.prototype.updateOptionsAfterTagExpansion=function(u){'use strict';this.forEachItem(function(v){if(v instanceof m)v.updateAfterTagExpansion(u);});};t.prototype.onPopoverOpen=function(u){'use strict';if(this._config.learnMore)this._config.learnMore.collapse();if(u&&u.isBelowFold()){this.expandMenu();}else this.collapseMenu();if(u&&this._items.indexOf(u)>=15)setTimeout((function(){this._scrollableArea.scrollToBottom(true,{duration:1000,ease:k.sineOut});}).bind(this),250);};f.exports=t;},null);
__d('PopoverButton',['DOM','DOMQuery','csx','isTextNode'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l={setLabel:function(m,n){var o=i.find(m,"._55pe"),p=o.childNodes;for(var q=0;q<p.length;q++)if(k(p[q])){h.replace(p[q],n);return;}h.appendContent(o,n);}};f.exports=l;},null);
__d('PrivacySelectorDataStore',['ArbiterMixin','PrivacySelectorNewDispatcher','KeyedCallbackManager'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=new j(),l=babelHelpers._extends({},h,{get:function(m,n){k.executeOrEnqueue(m,n);},hasValueChanged:function(m){return !!k.getResource(m);}});i.register(function(m){if(m.selector_type){var n={};n[m.selector_type]={post_param:m.post_param,unique_id:m.unique_id,reload:m.reload,is_error:m.is_error};k.addResourcesAndExecute(n);l.inform('change');}});f.exports=l;},null);
__d("XPrivacySelectorUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/privacy\/selector\/update\/",{privacy_fbid:{type:"String",required:true},post_param:{type:"String",required:true},tags:{type:"IntVector"},render_location:{type:"Int",required:true},is_saved_on_select:{type:"Bool",defaultValue:false},should_return_tooltip:{type:"Bool",defaultValue:false},replace_on_select:{type:"Bool",defaultValue:false},prefix_tooltip_with_app_privacy:{type:"Bool",defaultValue:false},ent_id:{type:"String",required:true},tag_expansion_button:{type:"String"},reload_selector:{type:"Bool",defaultValue:false}});},null);
__d('PrivacySelectorBase',['Arbiter','ArbiterMixin','AsyncRequest','Animation','Button','CSS','CurrentUser','Focus','Input','MenuStaticItem','MenuSelectableItem','PopoverButton','PopoverLoadingMenu','PrivacyConst','DataStore','PrivacySelectorNewDispatcher','PrivacySelectorDataStore','PrivacySelectableMenu','Run','SubscriptionsHandler','TagExpansionButtonConfig','TooltipData','XPrivacySelectorLoggingController','XPrivacySelectorUpdateController','XUIError','bind','cx','fbt','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja){if(c.__markCompiled)c.__markCompiled();var ka,la,ma=3;ka=babelHelpers.inherits(na,ja(i));la=ka&&ka.prototype;function na(oa,pa,qa,ra,sa,ta){'use strict';la.constructor.call(this);v.set(oa,'selector',this);this._root=oa;this._button=pa;this._config=ta;this._menu=qa;this._popoverMenu=sa;this._input=ra;this._isSavedOnSelect=ta.is_saved_on_select;this._privacyFBID=ta.privacy_fbid;this._contentType=ta.content_type;this._renderLocation=ta.render_location;this._supportsTagExpansion=ta.supports_tag_expansion;this._prefixTooltipApps=ta.should_prefix_tooltip_apps;this._shouldDisplayLabel=ta.should_display_label;this._tags=ta.tagged_uids;this._hasTags=this._tags.length>0;this._entID=ta.ent_id;this._popover=this._popoverMenu.getPopover();this._receivingUpdate=false;this._initTagExpansionButtonState();this._selectorSyncKey=ta.selector_sync_key;this._previousParam=null;this._confirmOnSave=false;this._confirmOnSaveDialogs={};this._listeners=new aa();if(ta.use_async_menu){this._listeners.addSubscriptions(this._popoverMenu.subscribe('setMenu',(function(){this._menu=this._popoverMenu.getMenu();if(!(this._menu instanceof y))return;this._onMenuLoad();this._onPopoverOpen();this.inform('asyncMenuLoaded');}).bind(this)));}else this._onMenuLoad();if(this._selectorSyncKey)this._initSelectorSync();z.onLeave(this._cleanup.bind(this));}na.prototype._cleanup=function(){'use strict';this._listeners&&this._listeners.release();this._listeners=null;};na.prototype._initSelectorSync=function(){'use strict';this._listeners.addSubscriptions(x.subscribe('change',(function(){x.get(this._selectorSyncKey,(function(oa){if(oa.unique_id!==this._menu._config.id){this._receivingUpdate=true;if(oa.post_param)this.selectOption(oa.post_param);oa.reload&&this.reloadSelector();oa.is_error&&this._displayErrorWithoutFocus();if(!oa.post_param)this._receivingUpdate=false;}}).bind(this));}).bind(this)));if(!this._syncsToDefault())this._listeners.addSubscriptions(this._menu.subscribe('change',(function(){if(!this._shouldDisplaySuccessAndFailure())this._broadcastUpdate();}).bind(this)));};na.prototype._broadcastUpdate=function(){'use strict';this._broadcastUpdateImpl(false);};na.prototype._broadcastError=function(){'use strict';this._broadcastUpdateImpl(true);};na.prototype._broadcastUpdateImpl=function(oa){'use strict';if(!this._receivingUpdate){var pa={selector_type:this._selectorSyncKey,unique_id:this._menu._config.id};if(oa){pa.is_error=oa;}else{var qa=this._getSelectedOption();pa.post_param=qa.getPostParam().toString();}w.handleUpdateFromSelector(pa);}};na.prototype.shouldReplaceOnPost=function(){'use strict';return this._config.replace_on_post||this.isComposerWithDefault();};na.prototype.isComposerWithDefault=function(){'use strict';return this._syncsToDefault()&&!this._config.replace_on_select;};na.prototype._isSelectorForChangingComposerDefault=function(){'use strict';return this._syncsToDefault&&this._config.replace_on_select;};na.prototype._syncsToDefault=function(){'use strict';return this._config.selector_sync_key==u.PrivacyField.DEFAULT_COMPOSER.toString();};na.prototype.getIsPublicSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isPublic();};na.prototype.getIsFriendsSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isFriends();};na.prototype.getIsOnlyMeSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isOnlyMe();};na.prototype.getSelectedBaseValue=function(){'use strict';return this._selectedOption&&this._selectedOption.getBaseValue();};na.prototype.getSelectedPostParam=function(){'use strict';return this._selectedOption&&this._selectedOption.getPostParam().toString();};na.prototype.getIsCustomOptionSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isCustomOption();};na.prototype.setValue=function(oa){'use strict';this._menu.setValue(oa);};na.prototype.openSelectorExpanded=function(oa){'use strict';this.openSelector((function(){this._menu.expandMenu();oa&&oa();}).bind(this));};na.prototype.openSelector=function(oa){'use strict';if(this._menu instanceof t){this.subscribeOnce('asyncMenuLoaded',(function(){oa&&oa();}).bind(this));this._popover.showLayer();}else{this._popover.showLayer();oa&&oa();}};na.prototype.closeSelector=function(){'use strict';this._popover.hideLayer();};na.prototype.getPopover=function(){'use strict';return this._popover;};na.prototype.getTriggerButtonElement=function(){'use strict';return this._button;};na.prototype.getRoot=function(){'use strict';return this._root;};na.prototype.getMenuElement=function(){'use strict';return this._menu.getRoot();};na.prototype.selectDefaultOption=function(){'use strict';this._menu.selectDefaultOption();this._updateMenu();};na.prototype.selectOption=function(oa){'use strict';if(!oa)return;if(this._menu instanceof t){this.subscribeOnce('asyncMenuLoaded',this._selectOptionImpl.bind(this,oa));this._fetchAsyncMenu();}else this._selectOptionImpl(oa);};na.prototype._selectOptionImpl=function(oa){'use strict';this._menu.selectOption(oa);this._updateMenu();};na.prototype._updateMenu=function(){'use strict';this._selectedOption=this._getSelectedOption();this.updateDataForItemIndex(this._selectedOption.getIndex(),this._selectedOption.getPostParam().toString());};na.prototype.setTagExpansionButton=function(oa){'use strict';this._tagExpansionButton=oa;if(this._hasAudienceExpansion()){this._menu.updateOptionsAfterTagExpansion(this._showTagExpansion());this._updateTriggerButtonLabel();this._updateTooltipAfterChange();}};na.prototype.getTagExpansionButton=function(){'use strict';return this._tagExpansionButton;};na.prototype._initTagExpansionButtonState=function(){'use strict';this._tagExpansionButton=ba.FRIENDS_OF_TAGGED;var oa=this._getSelectedOption();if(!oa)return;var pa=JSON.parse(oa.getPostParam());if(pa.settings&&pa.settings.no_tag_expansion===true){this._tagExpansionButton=ba.TAGGED_ONLY;}else this._tagExpansionButton=ba.FRIENDS_OF_TAGGED;};na.prototype._fetchAsyncMenu=function(){'use strict';if(this._config.use_async_menu)this._popoverMenu.fetchMenu();};na.prototype._getSelectedOption=function(){'use strict';if(!(this._menu instanceof y))return;var oa;this._menu.forEachItem((function(pa){if(pa instanceof r&&pa.isSelected())oa=pa;}).bind(this));return oa;};na.prototype._onItemClick=function(oa,pa){'use strict';var qa=pa.item;if(qa instanceof q)return;if(qa.isBasicOption()){this.updateDataForItemIndex(qa.getIndex(),qa.getPostParam().toString());}else if(qa.isCustomOption()){this._closeForCustom=true;qa.openDialog(this);}this.inform('click',{customSelected:qa.isCustomOption()});};na.prototype.getContentType=function(){'use strict';return this._contentType;};na.prototype.getRenderLocation=function(){'use strict';return this._renderLocation;};na.prototype.getPostParam=function(){'use strict';return this._postParam;};na.prototype.getTags=function(){'use strict';return this._tags;};na.prototype.registerConfirmOnSaveDialog=function(oa,pa,qa){'use strict';this._confirmOnSave=true;if(!(oa in this._confirmOnSaveDialogs))this._confirmOnSaveDialogs[oa]={};qa.subscribe('hide',(function(){if(this._previousParam!==this._postParam)this.selectOption(this._previousParam);}).bind(this));qa.subscribe('button',(function(){this._savePrivacy();qa.hide();}).bind(this));this._confirmOnSaveDialogs[oa][pa]=qa;};na.prototype.updateDataForItemIndex=function(oa,pa,qa){'use strict';if(qa){this._tagExpansionButton=qa;this.inform('CustomTagExpansion',this._tagExpansionButton);}var ra=this._menu.getItemForIndex(oa);if(ra.isCustomOption())ra.setPostParam(pa);this._selectedOption=ra;this._previousParam=this._postParam;this._postParam=pa;p.setValue(this._input,pa);this._updateTriggerButtonLabel();if(this._shouldUpdateTooltips()){this._updateTooltipAfterChange();}else{if(this._isSavedOnSelect)if(this._confirmOnSave&&this._previousParam in this._confirmOnSaveDialogs&&this._postParam in this._confirmOnSaveDialogs[this._previousParam]){this._confirmOnSaveDialogs[this._previousParam][this._postParam].show();}else this._savePrivacy();this._setTooltipValue(this._selectedOption.getTooltip());}this.inform('changed',{post_param:this._postParam,base_value:this.getSelectedBaseValue()});};na.prototype._shouldUpdateTooltips=function(){'use strict';return this._prefixTooltipApps||this._supportsTagExpansion||this.getIsCustomOptionSelected();};na.prototype._savePrivacy=function(){'use strict';this._previousParam=this._postParam;this._sendUpdateRequest();};na.prototype.reloadSelector=function(){'use strict';this._cleanup();var oa=ea.getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setInt('render_location',this._renderLocation).setBool('reload_selector',true).setString('ent_id',String(this._entID)).getURI();new j().setRelativeTo(this._root).setHandler(this.inform.bind(this,'reloaded')).setURI(oa).send();};na.prototype._sendUpdateRequest=function(){'use strict';var oa=this._isSavedOnSelect&&!this._receivingUpdate,pa=this._shouldUpdateTooltips();if(!oa&&!pa){this._receivingUpdate=false;return;}if(this._shouldDisplaySuccessAndFailure()){l.setIcon(this._button,this._config.spinner);m.show(this._config.spinner);m.hide(this._config.checkmark);}var qa=ea.getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setIntVector('tags',this._tags).setInt('render_location',this._renderLocation).setBool('is_saved_on_select',oa).setBool('should_return_tooltip',pa).setBool('prefix_tooltip_with_app_privacy',this._prefixTooltipApps).setBool('replace_on_select',this._config.replace_on_select).setString('ent_id',String(this._entID)).setString('tag_expansion_button',this._tagExpansionButton).getURI(),ra=new j().setRelativeTo(this._root).setHandler(ga(this,function(sa){if(this._shouldDisplaySuccessAndFailure()&&!this._receivingUpdate){m.hide(this._config.spinner);this._updateTriggerButtonLabel();if(this._config.checkmark){this._updateTriggerButtonLabel();var ta=l.getIcon(this._button);m.hide(ta);new k(this._config.checkmark).show().from('opacity',0).to('opacity',1).duration(400).checkpoint().duration(200).checkpoint().from('opacity',1).to('opacity',0).duration(400).hide().ondone(function(){new k(ta).show().from('opacity',0).to('opacity',1).duration(300).go();}).go();}this._broadcastUpdate();}if(this._config.replace_on_select)this._cleanup();if(this._isSelectorForChangingComposerDefault())this._broadcastUpdate();var ua=sa&&sa.payload&&sa.payload.tooltip;ua&&this._setTooltipValue(sa.payload.tooltip);this.inform('selector_updated');})).setFinallyHandler(ga(this,function(sa){this._receivingUpdate=false;})).setURI(qa);if(this._shouldDisplaySuccessAndFailure())ra.setErrorHandler(ga(this,function(sa){if(this._receivingUpdate){this._displayErrorWithoutFocus();return;}this._menu.selectOption(this._previousParam);this._postParam=this._previousParam;this._displayError();this._broadcastError();}));ra.send();};na.prototype._displayError=function(){'use strict';this._displayErrorImpl(true);};na.prototype._displayErrorWithoutFocus=function(){'use strict';this._displayErrorImpl(false);};na.prototype._displayErrorImpl=function(oa){'use strict';if(this._shouldDisplaySuccessAndFailure()){s.setLabel(this._button,ia._("Select Audience"));l.setIcon(this._button,this._config.error_icon);m.show(this._config.error_icon);ca.remove(this._button);oa&&o.setWithoutOutline(this._button);fa.set({target:this._button,message:ia._("Your selection might not have been saved. We recommend trying again later.")});}};na.prototype.informTagsChanged=function(oa){'use strict';var pa=this._getTags(oa);this.informTagsChangedWithIDs(pa);};na.prototype.informTagsChangedWithIDs=function(oa){'use strict';var pa=!oa.length;if(this._hasTags===pa){this._hasTags=!!oa.length;this._menu.updateOptionsAfterTagExpansion(this._showTagExpansion());this._updateTriggerButtonLabel();}if(this._tags.length!==oa.length){this._tags=oa;this._updateTooltipAfterChange();h.inform('PrivacySelectorBase/changed',this._getChangedData());}};na.prototype._getChangedData=function(){'use strict';return {tags:this._tags,privacy:this.getSelectedBaseValue()};};na.prototype._showTagExpansion=function(){'use strict';return this._hasTags&&this._tagExpansionButton.valueOf()===ba.FRIENDS_OF_TAGGED.valueOf();};na.prototype._getTags=function(oa){'use strict';var pa=[],qa=n.getID();if(oa.withTags)for(var ra=0;ra<oa.withTags.length;ra++){var sa=oa.withTags[ra].info;if(sa.uid!=qa)pa.push(sa.uid);}if(oa.mention)for(var ta in oa.mention)if(oa.mention[ta].type=='user'&&oa.mention[ta].uid!=qa)pa.push(oa.mention[ta].uid);return pa;};na.prototype._updateTriggerButtonLabel=function(){'use strict';var oa=this._selectedOption.getTriggerIcon();if(this._config.trigger_no_icon)m.hide(oa);l.setIcon(this._button,oa.cloneNode());if(!this._shouldDisplayLabel)return;s.setLabel(this._button,this._selectedOption.getLabel());if(this._config.trigger_style===ma){m.conditionClass(this.getTriggerButtonElement(),"_mw-",this.getIsOnlyMeSelected());m.conditionClass(this.getTriggerButtonElement(),"_mw_",this.getIsPublicSelected());}};na.prototype._updateTooltipAfterChange=function(){'use strict';var oa=ia._("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...");this._setTooltipValue(oa);this._sendUpdateRequest();};na.prototype._setTooltipValue=function(oa){'use strict';oa&&ca.set(this._button,oa);};na.prototype._onPopoverClose=function(){'use strict';if(!this._getSelectedOption())return;if(this._closeForCustom){this._closeForCustom=false;}else this.inform('selectorFinished');this.inform('close');};na.prototype._onPopoverOpen=function(){'use strict';if(!(this._menu instanceof y))return;this._menu.onPopoverOpen(this._getSelectedOption());var oa=da.getURIBuilder().setEnum('event','opened').setInt('render_location',this._renderLocation).setString('content_type',this._contentType).getURI();new j().setURI(oa).send();this.inform('open');};na.prototype._onMenuLoad=function(){'use strict';this._listeners.addSubscriptions(this._menu.subscribe('itemclick',this._onItemClick.bind(this)),this._popover.subscribe('hide',this._onPopoverClose.bind(this)),this._popover.subscribe('show',this._onPopoverOpen.bind(this)));this._listeners.addSubscriptions(this._menu.subscribe('expandMenu',(function(){if(this._popover&&this._popover.getLayer())this._popover.getLayer().updatePosition();}).bind(this)));this._selectedOption=this._getSelectedOption();if(this._selectedOption){this._postParam=this._selectedOption.getPostParam().toString();this._previousParam=this._postParam;this._hasAudienceExpansion()&&this._updateTriggerButtonLabel();}};na.prototype._hasAudienceExpansion=function(){'use strict';return this._hasTags;};na.prototype._shouldDisplaySuccessAndFailure=function(){'use strict';return this._config.spinner&&this._config.checkmark&&this._config.error_icon;};f.exports=na;},null);
__d('PubcontentFeedChainingControllerLoader',['Arbiter','Bootloader','PageLikeConstants','SubscriptionsHandler','UFIUIEvents','AttachmentRelatedShareConstants'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=[j.LIKED,l.ActionLinkLike,l.ReactionButtonClicked,l.Comment,l.ActionAddComment,'composer/publish','LitestandComposer/publish',m.ARTICLE_CLICK,m.VIDEO_CLICK,m.FBVIDEO_CLICK,m.GAME_CLICK,m.PHOTO_CLICK,m.EVENT_JOIN],o=null,p=false,q=null,r={init:function(){if(q){q.init({isLazy:false});}else this._startListening();},_startListening:function(){if(o)return;o=new k();o.addSubscriptions(h.subscribe(n,(function(event,s){h.inform(event+'.lazy',s,h.BEHAVIOR_PERSISTENT);this._bootload();}).bind(this)));},_bootload:function(){if(p)return;p=true;i.loadModules(["PubcontentFeedChainingControllerX"],function(s){o&&o.release();q=s;q.init({isLazy:true});});}};f.exports=r;},null);
__d("XReactFeedComposerXBootloadController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/react_composer\/feedx\/bootload\/",{composer_id:{type:"String",required:true},composer_type:{type:"Enum",required:true,enumType:1},friend_list_id:{type:"String"},target_id:{type:"String",required:true}});},null);
__d('ReactFeedComposerX',['ReactComposerAttachmentType','Arbiter','AsyncRequest','ComposerEntryPointRef','CSS','DOM','Event','Run','SubscriptionsHandler','XReactComposerLoggingODSController','XReactFeedComposerXBootloadController','csx','cx','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){'use strict';if(c.__markCompiled)c.__markCompiled();function v(w){this.$ReactFeedComposerX1=w.root;this.$ReactFeedComposerX2=w.composerID;this.$ReactFeedComposerX3=w.targetID;this.$ReactFeedComposerX4=w.composerType;this.$ReactFeedComposerX5=w.friendListID;this.$ReactFeedComposerX6=false;this.$ReactFeedComposerX7=m.find(this.$ReactFeedComposerX1,'form');this.$ReactFeedComposerX8=m.find(this.$ReactFeedComposerX1,"._3en1");this.$ReactFeedComposerX9=new p();this.$ReactFeedComposerX9.addSubscriptions(n.listen(this.$ReactFeedComposerX1,'click',this.$ReactFeedComposerX10.bind(this)),n.listen(this.$ReactFeedComposerX1,'mouseover',this.$ReactFeedComposerX10.bind(this)),n.listen(this.$ReactFeedComposerX8,'keydown',this.$ReactFeedComposerX10.bind(this)),n.listen(this.$ReactFeedComposerX7,'success',this.$ReactFeedComposerX11.bind(this)),i.subscribeOnce('ReactFeedComposerXBootloader/bootload/'+this.$ReactFeedComposerX2,this.$ReactFeedComposerX12.bind(this)));var x=m.find(this.$ReactFeedComposerX1,"._4d6h"),y=m.scry(x,'input[name="composer_photo[]"]')[0];if(y){this.$ReactFeedComposerX9.addSubscriptions(n.listen(y,'click',this.$ReactFeedComposerX10.bind(this)),n.listen(y,'change',this.$ReactFeedComposerX10.bind(this)));if(y.files&&y.files.length>0)this.$ReactFeedComposerX10();}this.$ReactFeedComposerX13=m.scry(this.$ReactFeedComposerX1,"._5qtm");this.$ReactFeedComposerX13.forEach((function(z){return this.$ReactFeedComposerX9.addSubscriptions(n.listen(z,'click',this.$ReactFeedComposerX14.bind(this)));}).bind(this));o.onLeave(this.$ReactFeedComposerX12.bind(this));}v.prototype.$ReactFeedComposerX14=function(w){var x=w.getTarget(),y=null;while(x){if(x.nodeType===1&&x.nodeName==='A'){y=x;break;}x=x.parentNode;}!(y!==null)?u(0):undefined;var z=l.hasClass(y,"._5qtn");if(z)return;this.$ReactFeedComposerX13.forEach(function(ca){return l.removeClass(ca,"_5qtn");});l.addClass(y,"_5qtn");var aa=m.find(this.$ReactFeedComposerX1,"._559p"),ba=m.find(this.$ReactFeedComposerX1,"._559q");switch(y.getAttribute('data-attachment-type')){case h.STATUS:l.hide(ba);l.show(aa);break;case h.MEDIA:case h.QANDA:l.show(ba);l.hide(aa);break;}};v.prototype.$ReactFeedComposerX10=function(w){if(this.$ReactFeedComposerX6)return;this.$ReactFeedComposerX6=true;var x=r.getURIBuilder().setString('composer_id',this.$ReactFeedComposerX2).setString('target_id',this.$ReactFeedComposerX3).setEnum('composer_type',this.$ReactFeedComposerX4).setString('friend_list_id',this.$ReactFeedComposerX5).getURI();new j(x).send();var y=q.getURIBuilder().setString('event','bootload_start').setEnum('composer_type',k.FEEDX).getURI();new j(y).send();};v.prototype.$ReactFeedComposerX12=function(){this.$ReactFeedComposerX9.release();};v.prototype.$ReactFeedComposerX11=function(){this.$ReactFeedComposerX8.value='';this.$ReactFeedComposerX12();};f.exports=v;},null);
__d('ReactFeedComposerXBody',['DOM','Event','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();function k(l){this.$ReactFeedComposerXBody1=l.root;this.$ReactFeedComposerXBody2=h.find(this.$ReactFeedComposerXBody1,'textarea');this.$ReactFeedComposerXBody3=h.find(this.$ReactFeedComposerXBody1,'input[type="hidden"]');this.$ReactFeedComposerXBody4=new j();this.$ReactFeedComposerXBody4.addSubscriptions(i.listen(this.$ReactFeedComposerXBody2,'change',this.$ReactFeedComposerXBody5.bind(this)));}k.prototype.$ReactFeedComposerXBody5=function(l){this.$ReactFeedComposerXBody3.value=l.target.value;};f.exports=k;},null);
__d('FeedAdsGapRuleViolationDetection',['Banzai','CSS','csx','cx','DOM','ge','isEmpty'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o='ei',p='qid',q='gap rule violation',r='non violating ads gap',s='first position violation',t='feed load',u='first position invalidation',v='spacing invalidation',w=[],x=[],y=[],z={},aa={},ba={registerFeedStories:function(ca,da){if(ca.containerID=='substream_0'){w=[];x=[];}var ea=m(ca.containerID);if(!ea)return;z=babelHelpers._extends({},ca.demoAdChecks,z);var fa=l.scry(ea,"div._5jmm").map(this._convertStoryNodeToObject).filter(function(ha){return ha!==null;});if(ca.isLoggingEnabled&&fa.length!==0)this._logFeedLoad();if(ca.isNewerStories){w=fa.concat(w);}else w=w.concat(fa);for(var ga in ca.minGaps)if(ca.minGaps.hasOwnProperty(ga))aa[ga]=ca.minGaps[ga];if(n(z)){if(ca.isLoggingEnabled||ca.isFirstPosInvalidationEnabled)this._checkFirstPosViolation(ca,ea);if(ca.isLoggingEnabled||ca.isGapRuleInvalidationEnabled)this._checkGapRuleViolation(ca);}},_convertStoryNodeToObject:function(ca){if(i.hasClass(ca,"_170y"))return null;var da=ca.getAttribute('data-dedupekey');if(z[da])return null;var ea=l.scry(ca,"div._hye"),fa=l.scry(ca,"li._170x"),ga=[];if(ea.length!==0){ga=ea.map(function(ja){return ja.getAttribute('data-ft');}).filter(function(ja){return ja!==null;});}else if(fa.length!==0){ga=fa.map(function(ja){return ja.getAttribute('data-ft');}).filter(function(ja){return ja!==null;});}else if(ca.getAttribute('data-ft'))ga=[ca.getAttribute('data-ft')];if(!ga.length)return null;var ha=JSON.parse(ga[0]),ia={dataFTArray:ga,dedupKey:da,isSponsored:!!ha[o],height:ca.offsetHeight,qid:parseInt(ha[p],10),nodeID:ca.id};return ia;},_checkFirstPosViolation:function(ca,da){while(w.length>0&&w[0].isSponsored){var ea={ftArray:w[0].dataFTArray,qid:w[0].qid,nodeid:w[0].nodeID,firstStoryType:ca.firstStoryType},fa=l.scry(da,'.uiBoxRed')[0];if(fa){var ga=fa.textContent||fa.innerText;if(ga)ea.error_msg=ga;}if(ca.isLoggingEnabled&&!(w[0].dedupKey in y)){this._logFirstPosViolation(ea);y[w[0].dedupKey]=ea;}if(ca.isFirstPosInvalidationEnabled){this._invalidateFirstPosAd(ea);w.splice(0,1);}else break;}},_getMinGap:function(ca,da,ea){var fa=Math.min(ca?ca:Number.MAX_VALUE,da?da:Number.MAX_VALUE);return fa!==Number.MAX_VALUE?fa:ea;},_getStoryDedupKeysJSONString:function(ca,da){var ea=[];for(var fa=ca;fa<=da;fa++)ea.push(w[fa].dedupKey);return JSON.stringify(ea);},_getIdxOfStoryToSwap:function(ca,da){if(da>=w.length-ca)return -1;for(var ea=ca+1;ea<w.length&&da>0;ea++){if(!w[ea].isSponsored){da--;}else return -1;if(da===0)return ea;}return -1;},_checkGapRuleViolation:function(ca){var da=null,ea=null,fa=0;for(var ga=0;ga<w.length;ga++){var ha=w[ga];fa+=ha.height;if(ha.isSponsored){fa-=ha.height;var ia=false,ja=false;if(da!==null){var ka=ga-da,la=null,ma=this._getMinGap(aa[ea.dedupKey],aa[ha.dedupKey],ca.defaultMinGap);if(ka<ma){la=q;}else la=r;var na={ftArray_A:ea.dataFTArray,ftArray_B:ha.dataFTArray,dist:ka,pdist:fa,pos:ga+1,qid_A:ea.qid,qid_B:ha.qid,event_type:la,nodeid:ha.nodeID,dedupKeys:this._getStoryDedupKeysJSONString(da,ga)};if(ca.isLoggingEnabled)if(!(ha.dedupKey in x)||x[ha.dedupKey].event_type!==la){this._logAdsGapEvent(na);x[ha.dedupKey]=na;}if(ca.isGapRuleInvalidationEnabled&&la==q){var oa=-1;if(ca.isSwapOnGapRuleViolationEnabled)oa=this._getIdxOfStoryToSwap(ga,ma-ka);if(oa>0){this._shiftAdBelowOrganicStory(ha.nodeID,w[oa].nodeID);var pa=w[ga];w.splice(ga,1);w.splice(oa,0,pa);if(ca.isLoggingEnabled){var qa={ft:w[oa].dataFTArray[0],dist:oa-ga,qid:w[oa].qid,event_type:'ad_swap'};h.post('feed_ads_gap_rule_violation',qa);}ja=true;ha=w[ga];fa+=ha.height;}else if(ca.isGapRuleInvalidationEnabled){this._invalidateGapRuleViolatedAd(na);ia=true;w.splice(ga--,1);}}}if(!ia&&!ja){da=ga;ea=ha;fa=0;}}}},_logFirstPosViolation:function(ca){var da={ft:ca.ftArray[0],event_type:s,intValues:{qid:ca.qid},first_story_type:ca.firstStoryType};if(ca.error_msg)da.error_msg=ca.error_msg;h.post('feed_ads_gap_rule_violation',da);},_logAdsGapEvent:function(ca){var da={ft_A:ca.ftArray_A[0],ft_B:ca.ftArray_B[0],event_type:ca.event_type,intValues:{dist:ca.dist,pdist:ca.pdist,pos:ca.pos,qid_A:ca.qid_A,qid_B:ca.qid_B},dedup_keys:ca.dedupKeys};h.post('feed_ads_gap_rule_violation',da);},_logFeedLoad:function(){var ca={event_type:t};h.post('feed_ads_gap_rule_violation',ca);},_invalidateFirstPosAd:function(ca){i.hide(m(ca.nodeid));var da={ft_array:ca.ftArray,event_type:u};h.post('feed_ads_gap_rule_violation',da);},_invalidateGapRuleViolatedAd:function(ca){var da=m(ca.nodeid);da&&i.hide(da);var ea={ft_array_A:ca.ftArray_A,ft_array_B:ca.ftArray_B,event_type:v};h.post('feed_ads_gap_rule_violation',ea);},_shiftAdBelowOrganicStory:function(ca,da){var ea=m(ca),fa=m(da);ea&&fa&&l.insertAfter(fa,ea);}};f.exports=ba;},null);
__d('StoryPositionTracking',['DOM','LitestandStream','csx','ge'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=0;function m(p,q){var r=JSON.parse(p.getAttribute('data-ft'));if(r){r.insertion_position=q;p.setAttribute('data-ft',JSON.stringify(r));}}function n(p){return h.scry(p,"._5jmm");}var o={registerNewStories:function(p){if(p=='substream_0')l=0;var q=n(k(p)),r=q.length;for(var s=0;s<r;s++)m(q[s],l++);},updateAllStories:function(){var p=n(i.getStreamRoot()),q=p.length;l=0;for(var r=0;r<q;r++)m(p[r],l++);}};f.exports=o;},null);
__d('FbFeedAttachmentRelatedShare',['Arbiter','AttachmentRelatedShareConstants','DOMQuery','Event','tidyEvent','csx'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={loadRelatedAttachment:function(o,p){l(k.listen(o,'click',function(){h.inform(i.ARTICLE_CLICK,{attachment:o,global_share_id:p});}));},loadRelatedGameAttachment:function(o,p){l(k.listen(o,'click',function(){h.inform(i.GAME_CLICK,{attachment:o,global_share_id:p});}));},loadRelatedAttachmentForStream:function(o){var p=function(event,q){var r=event.getTarget();if(r.getAttribute('target')!=='_blank')return;var s="^div._5pbx",t="^div._5pc9",u=j.scry(r,s)[0]||j.scry(r,t)[0];if(!u)return;h.inform(i.ARTICLE_CLICK,{attachment:u,global_share_id:0,link_url:r.getAttribute('href'),is_right_click:q});};l(k.listen(o,'click',function(event){p(event,false);}));l(k.listen(o,'mousedown',function(event){if(event.which==3||event.button==2)p(event,true);}));}};f.exports=n;},null);
__d('FbFeedViewportTracking',['Arbiter','LitestandMessages','LitestandStream','StreamViewportTracking','csx'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,k);n=m&&m.prototype;o.prototype.initSubscriptions=function(){'use strict';this.subscriptions.addSubscriptions(h.subscribe([i.STORIES_INSERTED],this.invalidateAllStoriesCache.bind(this)),h.subscribe(i.LEAVE_HOME,this.updateTimeTrackingData.bind(this,true)));};o.prototype.getStorySelector=function(){'use strict';return "._5jmm";};o.prototype.getStream=function(){'use strict';return j.getStreamRoot();};o.prototype.getSessionID=function(){'use strict';return j.getFeedStreamID();};o.init=function(p){'use strict';o.instance=new o();o.instance.init(p);};o.getInstance=function(){'use strict';return o.instance;};function o(){'use strict';m.apply(this,arguments);}f.exports=o;},null);