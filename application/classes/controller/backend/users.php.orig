<?php

defined( 'SYSPATH' ) or die( 'No direct script access.' );

class Controller_Backend_Users extends Controller_System_Backend {

	public function action_list()
	{
		$users = ORM::factory( 'user' );
		$pagination = Pagination::factory(array(
				'current_page' => array('source' => 'route', 'key' => 'pagenumber'),
				'total_items' => $users->count_all(),
				'items_per_page' => 1,
		));

		$users =$users->with( 'profile' )
				->limit($pagination->items_per_page)
				->offset($pagination->offset)
				->find_all();

		$this->template->content->page_links = $pagination->render();
		$this->template->content->users = $users;
	}

}